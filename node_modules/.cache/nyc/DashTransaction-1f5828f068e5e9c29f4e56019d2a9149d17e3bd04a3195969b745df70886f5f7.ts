"use strict";function cov_1u0739kypp(){var path="/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/dash/DashTransaction.ts";var hash="b5b9ca55c502505153f6e1faa7ade431bbd7c723";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/dash/DashTransaction.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:33}},"2":{start:{line:4,column:22},end:{line:4,column:62}},"3":{start:{line:5,column:24},end:{line:5,column:48}},"4":{start:{line:6,column:26},end:{line:6,column:55}},"5":{start:{line:7,column:19},end:{line:7,column:44}},"6":{start:{line:10,column:8},end:{line:10,column:39}},"7":{start:{line:11,column:8},end:{line:11,column:22}},"8":{start:{line:12,column:8},end:{line:14,column:9}},"9":{start:{line:13,column:12},end:{line:13,column:47}},"10":{start:{line:15,column:8},end:{line:21,column:9}},"11":{start:{line:16,column:12},end:{line:16,column:38}},"12":{start:{line:17,column:12},end:{line:20,column:13}},"13":{start:{line:18,column:16},end:{line:18,column:36}},"14":{start:{line:19,column:16},end:{line:19,column:52}},"15":{start:{line:23,column:8},end:{line:23,column:56}},"16":{start:{line:26,column:8},end:{line:26,column:69}},"17":{start:{line:29,column:19},end:{line:29,column:100}},"18":{start:{line:30,column:8},end:{line:30,column:35}},"19":{start:{line:31,column:8},end:{line:31,column:41}},"20":{start:{line:32,column:8},end:{line:35,column:9}},"21":{start:{line:33,column:33},end:{line:33,column:88}},"22":{start:{line:34,column:12},end:{line:34,column:58}},"23":{start:{line:36,column:8},end:{line:36,column:18}},"24":{start:{line:39,column:8},end:{line:39,column:67}},"25":{start:{line:42,column:8},end:{line:42,column:131}},"26":{start:{line:56,column:8},end:{line:58,column:9}},"27":{start:{line:57,column:12},end:{line:57,column:64}},"28":{start:{line:59,column:8},end:{line:61,column:9}},"29":{start:{line:60,column:12},end:{line:60,column:45}},"30":{start:{line:64,column:27},end:{line:64,column:86}},"31":{start:{line:65,column:8},end:{line:65,column:32}},"32":{start:{line:67,column:29},end:{line:67,column:70}},"33":{start:{line:68,column:8},end:{line:68,column:78}},"34":{start:{line:72,column:8},end:{line:75,column:9}},"35":{start:{line:73,column:12},end:{line:73,column:94}},"36":{start:{line:74,column:12},end:{line:74,column:58}},"37":{start:{line:76,column:8},end:{line:76,column:22}},"38":{start:{line:79,column:8},end:{line:81,column:9}},"39":{start:{line:80,column:12},end:{line:80,column:48}},"40":{start:{line:82,column:8},end:{line:82,column:63}},"41":{start:{line:90,column:8},end:{line:97,column:9}},"42":{start:{line:91,column:33},end:{line:91,column:105}},"43":{start:{line:92,column:12},end:{line:95,column:15}},"44":{start:{line:93,column:16},end:{line:93,column:51}},"45":{start:{line:94,column:16},end:{line:94,column:53}},"46":{start:{line:96,column:12},end:{line:96,column:71}},"47":{start:{line:98,column:8},end:{line:98,column:35}},"48":{start:{line:101,column:0},end:{line:101,column:42}},"49":{start:{line:102,column:0},end:{line:102,column:32}},"50":{start:{line:103,column:0},end:{line:103,column:43}},"51":{start:{line:104,column:0},end:{line:104,column:49}},"52":{start:{line:105,column:0},end:{line:105,column:51}},"53":{start:{line:106,column:0},end:{line:106,column:48}},"54":{start:{line:107,column:0},end:{line:107,column:34}},"55":{start:{line:108,column:0},end:{line:108,column:43}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:9,column:4},end:{line:9,column:5}},loc:{start:{line:9,column:41},end:{line:24,column:5}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:25,column:4},end:{line:25,column:5}},loc:{start:{line:25,column:60},end:{line:27,column:5}},line:25},"2":{name:"(anonymous_2)",decl:{start:{line:28,column:4},end:{line:28,column:5}},loc:{start:{line:28,column:72},end:{line:37,column:5}},line:28},"3":{name:"(anonymous_3)",decl:{start:{line:38,column:4},end:{line:38,column:5}},loc:{start:{line:38,column:22},end:{line:40,column:5}},line:38},"4":{name:"(anonymous_4)",decl:{start:{line:41,column:4},end:{line:41,column:5}},loc:{start:{line:41,column:31},end:{line:43,column:5}},line:41},"5":{name:"(anonymous_5)",decl:{start:{line:54,column:4},end:{line:54,column:5}},loc:{start:{line:54,column:76},end:{line:77,column:5}},line:54},"6":{name:"(anonymous_6)",decl:{start:{line:78,column:4},end:{line:78,column:5}},loc:{start:{line:78,column:24},end:{line:83,column:5}},line:78},"7":{name:"(anonymous_7)",decl:{start:{line:89,column:4},end:{line:89,column:5}},loc:{start:{line:89,column:29},end:{line:99,column:5}},line:89},"8":{name:"(anonymous_8)",decl:{start:{line:92,column:29},end:{line:92,column:30}},loc:{start:{line:92,column:45},end:{line:95,column:13}},line:92}},branchMap:{"0":{loc:{start:{line:12,column:8},end:{line:14,column:9}},type:"if",locations:[{start:{line:12,column:8},end:{line:14,column:9}},{start:{line:12,column:8},end:{line:14,column:9}}],line:12},"1":{loc:{start:{line:15,column:8},end:{line:21,column:9}},type:"if",locations:[{start:{line:15,column:8},end:{line:21,column:9}},{start:{line:15,column:8},end:{line:21,column:9}}],line:15},"2":{loc:{start:{line:17,column:12},end:{line:20,column:13}},type:"if",locations:[{start:{line:17,column:12},end:{line:20,column:13}},{start:{line:17,column:12},end:{line:20,column:13}}],line:17},"3":{loc:{start:{line:28,column:40},end:{line:28,column:61}},type:"default-arg",locations:[{start:{line:28,column:53},end:{line:28,column:61}}],line:28},"4":{loc:{start:{line:32,column:8},end:{line:35,column:9}},type:"if",locations:[{start:{line:32,column:8},end:{line:35,column:9}},{start:{line:32,column:8},end:{line:35,column:9}}],line:32},"5":{loc:{start:{line:42,column:51},end:{line:42,column:129}},type:"cond-expr",locations:[{start:{line:42,column:71},end:{line:42,column:125}},{start:{line:42,column:128},end:{line:42,column:129}}],line:42},"6":{loc:{start:{line:54,column:52},end:{line:54,column:74}},type:"default-arg",locations:[{start:{line:54,column:69},end:{line:54,column:74}}],line:54},"7":{loc:{start:{line:56,column:8},end:{line:58,column:9}},type:"if",locations:[{start:{line:56,column:8},end:{line:58,column:9}},{start:{line:56,column:8},end:{line:58,column:9}}],line:56},"8":{loc:{start:{line:59,column:8},end:{line:61,column:9}},type:"if",locations:[{start:{line:59,column:8},end:{line:61,column:9}},{start:{line:59,column:8},end:{line:61,column:9}}],line:59},"9":{loc:{start:{line:59,column:12},end:{line:59,column:62}},type:"binary-expr",locations:[{start:{line:59,column:12},end:{line:59,column:39}},{start:{line:59,column:43},end:{line:59,column:62}}],line:59},"10":{loc:{start:{line:72,column:8},end:{line:75,column:9}},type:"if",locations:[{start:{line:72,column:8},end:{line:75,column:9}},{start:{line:72,column:8},end:{line:75,column:9}}],line:72},"11":{loc:{start:{line:79,column:8},end:{line:81,column:9}},type:"if",locations:[{start:{line:79,column:8},end:{line:81,column:9}},{start:{line:79,column:8},end:{line:81,column:9}}],line:79},"12":{loc:{start:{line:90,column:8},end:{line:97,column:9}},type:"if",locations:[{start:{line:90,column:8},end:{line:97,column:9}},{start:{line:90,column:8},end:{line:97,column:9}}],line:90}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0],"4":[0,0],"5":[0,0],"6":[0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0]},inputSourceMap:{version:3,file:"/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/dash/DashTransaction.ts",sources:["/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/dash/DashTransaction.ts"],names:[],mappings:"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",sourcesContent:["import { BufferReader, BufferWriter } from 'bitcoinjs-lib/src/bufferutils';\nimport { crypto as bcrypto, Transaction } from 'bitcoinjs-lib';\n\nimport { UtxoTransaction, varSliceSize } from '../UtxoTransaction';\nimport { isDash, Network } from '../../networks';\n\nexport class DashTransaction<TNumber extends number | bigint = number> extends UtxoTransaction<TNumber> {\n  static DASH_NORMAL = 0;\n  static DASH_PROVIDER_REGISTER = 1;\n  static DASH_PROVIDER_UPDATE_SERVICE = 2;\n  static DASH_PROVIDER_UPDATE_REGISTRAR = 3;\n  static DASH_PROVIDER_UPDATE_REVOKE = 4;\n  static DASH_COINBASE = 5;\n  static DASH_QUORUM_COMMITMENT = 6;\n\n  public type = 0;\n  public extraPayload?: Buffer;\n\n  constructor(network: Network, tx?: Transaction<bigint | number>, amountType?: 'bigint' | 'number') {\n    super(network, tx, amountType);\n\n    if (!isDash(network)) {\n      throw new Error(`invalid network`);\n    }\n\n    if (tx) {\n      this.version = tx.version;\n\n      if (tx instanceof DashTransaction) {\n        this.type = tx.type;\n        this.extraPayload = tx.extraPayload;\n      }\n    }\n\n    // since `__toBuffer` is private we have to do a little hack here\n    (this as any).__toBuffer = this.toBufferWithExtraPayload;\n  }\n\n  protected static newTransaction<TNumber extends number | bigint = number>(\n    network: Network,\n    transaction?: DashTransaction<number | bigint>,\n    amountType?: 'number' | 'bigint'\n  ): DashTransaction<TNumber> {\n    return new DashTransaction<TNumber>(network, transaction, amountType);\n  }\n\n  static fromBuffer<TNumber extends number | bigint = number>(\n    buffer: Buffer,\n    noStrict: boolean,\n    amountType: 'number' | 'bigint' = 'number',\n    network: Network\n  ): DashTransaction<TNumber> {\n    const tx = new DashTransaction<TNumber>(network, super.fromBuffer<TNumber>(buffer, true, amountType, network));\n    tx.type = tx.version >> 16;\n    tx.version = tx.version & 0xffff;\n    if (tx.byteLength() !== buffer.length) {\n      const bufferReader = new BufferReader(buffer, tx.byteLength());\n      tx.extraPayload = bufferReader.readVarSlice();\n    }\n    return tx;\n  }\n\n  clone<TN2 extends bigint | number = TNumber>(amountType?: 'number' | 'bigint'): DashTransaction<TN2> {\n    return new DashTransaction<TN2>(this.network, this, amountType);\n  }\n\n  byteLength(_ALLOW_WITNESS?: boolean): number {\n    return super.byteLength(_ALLOW_WITNESS) + (this.extraPayload ? varSliceSize(this.extraPayload) : 0);\n  }\n\n  /**\n   * Helper to override `__toBuffer()` of bitcoinjs.Transaction.\n   * Since the method is private, we use a hack in the constructor to make it work.\n   *\n   * TODO: remove `private` modifier in bitcoinjs `__toBuffer()` or find some other solution\n   *\n   * @param buffer - optional target buffer\n   * @param initialOffset - can only be undefined or 0. Other values are only used for serialization in blocks.\n   * @param _ALLOW_WITNESS - ignored\n   */\n  private toBufferWithExtraPayload(buffer?: Buffer, initialOffset?: number, _ALLOW_WITNESS = false): Buffer {\n    // We can ignore the `_ALLOW_WITNESS` parameter here since it has no effect.\n    if (!buffer) {\n      buffer = Buffer.allocUnsafe(this.byteLength(false));\n    }\n\n    if (initialOffset !== undefined && initialOffset !== 0) {\n      throw new Error(`not supported`);\n    }\n\n    // Start out with regular bitcoin byte sequence.\n    // This buffer will have excess size because it uses `byteLength()` to allocate.\n    const baseBuffer = (Transaction.prototype as any).__toBuffer.call(this);\n    baseBuffer.copy(buffer);\n\n    // overwrite leading version bytes (uint16 version, uint16 type)\n    const bufferWriter = new BufferWriter(buffer, 0);\n    bufferWriter.writeUInt32((this.version & 0xffff) | (this.type << 16));\n\n    // Seek to end of original byte sequence and add extraPayload.\n    // We must use the byteLength as calculated by the bitcoinjs implementation since\n    // `baseBuffer` has an excess size.\n    if (this.extraPayload) {\n      bufferWriter.offset = Transaction.prototype.byteLength.call(this);\n      bufferWriter.writeVarSlice(this.extraPayload);\n    }\n\n    return buffer;\n  }\n\n  getHash(forWitness?: boolean): Buffer {\n    if (forWitness) {\n      throw new Error(`invalid argument`);\n    }\n    return bcrypto.hash256(this.toBuffer());\n  }\n\n  /**\n   * Build a hash for all or none of the transaction inputs depending on the hashtype\n   * @param hashType\n   * @returns Buffer\n   */\n  getPrevoutHash(hashType: number): Buffer {\n    if (!(hashType & UtxoTransaction.SIGHASH_ANYONECANPAY)) {\n      const bufferWriter = new BufferWriter(Buffer.allocUnsafe(36 * this.ins.length));\n\n      this.ins.forEach(function (txIn) {\n        bufferWriter.writeSlice(txIn.hash);\n        bufferWriter.writeUInt32(txIn.index);\n      });\n\n      return bcrypto.hash256(bufferWriter.buffer);\n    }\n\n    return Buffer.alloc(32, 0);\n  }\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"b5b9ca55c502505153f6e1faa7ade431bbd7c723"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1u0739kypp=function(){return actualCoverage;};}return actualCoverage;}cov_1u0739kypp();cov_1u0739kypp().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_1u0739kypp().s[1]++;exports.DashTransaction=void 0;const bufferutils_1=(cov_1u0739kypp().s[2]++,require("bitcoinjs-lib/src/bufferutils"));const bitcoinjs_lib_1=(cov_1u0739kypp().s[3]++,require("bitcoinjs-lib"));const UtxoTransaction_1=(cov_1u0739kypp().s[4]++,require("../UtxoTransaction"));const networks_1=(cov_1u0739kypp().s[5]++,require("../../networks"));class DashTransaction extends(UtxoTransaction_1.UtxoTransaction){constructor(network,tx,amountType){cov_1u0739kypp().f[0]++;cov_1u0739kypp().s[6]++;super(network,tx,amountType);cov_1u0739kypp().s[7]++;this.type=0;cov_1u0739kypp().s[8]++;if(!(0,networks_1.isDash)(network)){cov_1u0739kypp().b[0][0]++;cov_1u0739kypp().s[9]++;throw new Error(`invalid network`);}else{cov_1u0739kypp().b[0][1]++;}cov_1u0739kypp().s[10]++;if(tx){cov_1u0739kypp().b[1][0]++;cov_1u0739kypp().s[11]++;this.version=tx.version;cov_1u0739kypp().s[12]++;if(tx instanceof DashTransaction){cov_1u0739kypp().b[2][0]++;cov_1u0739kypp().s[13]++;this.type=tx.type;cov_1u0739kypp().s[14]++;this.extraPayload=tx.extraPayload;}else{cov_1u0739kypp().b[2][1]++;}}else{cov_1u0739kypp().b[1][1]++;}// since `__toBuffer` is private we have to do a little hack here
cov_1u0739kypp().s[15]++;this.__toBuffer=this.toBufferWithExtraPayload;}static newTransaction(network,transaction,amountType){cov_1u0739kypp().f[1]++;cov_1u0739kypp().s[16]++;return new DashTransaction(network,transaction,amountType);}static fromBuffer(buffer,noStrict,amountType=(cov_1u0739kypp().b[3][0]++,'number'),network){cov_1u0739kypp().f[2]++;const tx=(cov_1u0739kypp().s[17]++,new DashTransaction(network,super.fromBuffer(buffer,true,amountType,network)));cov_1u0739kypp().s[18]++;tx.type=tx.version>>16;cov_1u0739kypp().s[19]++;tx.version=tx.version&0xffff;cov_1u0739kypp().s[20]++;if(tx.byteLength()!==buffer.length){cov_1u0739kypp().b[4][0]++;const bufferReader=(cov_1u0739kypp().s[21]++,new bufferutils_1.BufferReader(buffer,tx.byteLength()));cov_1u0739kypp().s[22]++;tx.extraPayload=bufferReader.readVarSlice();}else{cov_1u0739kypp().b[4][1]++;}cov_1u0739kypp().s[23]++;return tx;}clone(amountType){cov_1u0739kypp().f[3]++;cov_1u0739kypp().s[24]++;return new DashTransaction(this.network,this,amountType);}byteLength(_ALLOW_WITNESS){cov_1u0739kypp().f[4]++;cov_1u0739kypp().s[25]++;return super.byteLength(_ALLOW_WITNESS)+(this.extraPayload?(cov_1u0739kypp().b[5][0]++,(0,UtxoTransaction_1.varSliceSize)(this.extraPayload)):(cov_1u0739kypp().b[5][1]++,0));}/**
     * Helper to override `__toBuffer()` of bitcoinjs.Transaction.
     * Since the method is private, we use a hack in the constructor to make it work.
     *
     * TODO: remove `private` modifier in bitcoinjs `__toBuffer()` or find some other solution
     *
     * @param buffer - optional target buffer
     * @param initialOffset - can only be undefined or 0. Other values are only used for serialization in blocks.
     * @param _ALLOW_WITNESS - ignored
     */toBufferWithExtraPayload(buffer,initialOffset,_ALLOW_WITNESS=(cov_1u0739kypp().b[6][0]++,false)){cov_1u0739kypp().f[5]++;cov_1u0739kypp().s[26]++;// We can ignore the `_ALLOW_WITNESS` parameter here since it has no effect.
if(!buffer){cov_1u0739kypp().b[7][0]++;cov_1u0739kypp().s[27]++;buffer=Buffer.allocUnsafe(this.byteLength(false));}else{cov_1u0739kypp().b[7][1]++;}cov_1u0739kypp().s[28]++;if((cov_1u0739kypp().b[9][0]++,initialOffset!==undefined)&&(cov_1u0739kypp().b[9][1]++,initialOffset!==0)){cov_1u0739kypp().b[8][0]++;cov_1u0739kypp().s[29]++;throw new Error(`not supported`);}else{cov_1u0739kypp().b[8][1]++;}// Start out with regular bitcoin byte sequence.
// This buffer will have excess size because it uses `byteLength()` to allocate.
const baseBuffer=(cov_1u0739kypp().s[30]++,bitcoinjs_lib_1.Transaction.prototype.__toBuffer.call(this));cov_1u0739kypp().s[31]++;baseBuffer.copy(buffer);// overwrite leading version bytes (uint16 version, uint16 type)
const bufferWriter=(cov_1u0739kypp().s[32]++,new bufferutils_1.BufferWriter(buffer,0));cov_1u0739kypp().s[33]++;bufferWriter.writeUInt32(this.version&0xffff|this.type<<16);// Seek to end of original byte sequence and add extraPayload.
// We must use the byteLength as calculated by the bitcoinjs implementation since
// `baseBuffer` has an excess size.
cov_1u0739kypp().s[34]++;if(this.extraPayload){cov_1u0739kypp().b[10][0]++;cov_1u0739kypp().s[35]++;bufferWriter.offset=bitcoinjs_lib_1.Transaction.prototype.byteLength.call(this);cov_1u0739kypp().s[36]++;bufferWriter.writeVarSlice(this.extraPayload);}else{cov_1u0739kypp().b[10][1]++;}cov_1u0739kypp().s[37]++;return buffer;}getHash(forWitness){cov_1u0739kypp().f[6]++;cov_1u0739kypp().s[38]++;if(forWitness){cov_1u0739kypp().b[11][0]++;cov_1u0739kypp().s[39]++;throw new Error(`invalid argument`);}else{cov_1u0739kypp().b[11][1]++;}cov_1u0739kypp().s[40]++;return bitcoinjs_lib_1.crypto.hash256(this.toBuffer());}/**
     * Build a hash for all or none of the transaction inputs depending on the hashtype
     * @param hashType
     * @returns Buffer
     */getPrevoutHash(hashType){cov_1u0739kypp().f[7]++;cov_1u0739kypp().s[41]++;if(!(hashType&UtxoTransaction_1.UtxoTransaction.SIGHASH_ANYONECANPAY)){cov_1u0739kypp().b[12][0]++;const bufferWriter=(cov_1u0739kypp().s[42]++,new bufferutils_1.BufferWriter(Buffer.allocUnsafe(36*this.ins.length)));cov_1u0739kypp().s[43]++;this.ins.forEach(function(txIn){cov_1u0739kypp().f[8]++;cov_1u0739kypp().s[44]++;bufferWriter.writeSlice(txIn.hash);cov_1u0739kypp().s[45]++;bufferWriter.writeUInt32(txIn.index);});cov_1u0739kypp().s[46]++;return bitcoinjs_lib_1.crypto.hash256(bufferWriter.buffer);}else{cov_1u0739kypp().b[12][1]++;}cov_1u0739kypp().s[47]++;return Buffer.alloc(32,0);}}cov_1u0739kypp().s[48]++;exports.DashTransaction=DashTransaction;cov_1u0739kypp().s[49]++;DashTransaction.DASH_NORMAL=0;cov_1u0739kypp().s[50]++;DashTransaction.DASH_PROVIDER_REGISTER=1;cov_1u0739kypp().s[51]++;DashTransaction.DASH_PROVIDER_UPDATE_SERVICE=2;cov_1u0739kypp().s[52]++;DashTransaction.DASH_PROVIDER_UPDATE_REGISTRAR=3;cov_1u0739kypp().s[53]++;DashTransaction.DASH_PROVIDER_UPDATE_REVOKE=4;cov_1u0739kypp().s[54]++;DashTransaction.DASH_COINBASE=5;cov_1u0739kypp().s[55]++;DashTransaction.DASH_QUORUM_COMMITMENT=6;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3Fyb2MvQ29kZS9oYXBpL2NoYWluZGVmdXNlci91dHhvLWxpYi9zcmMvYml0Z28vZGFzaC9EYXNoVHJhbnNhY3Rpb24udHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9xcm9jL0NvZGUvaGFwaS9jaGFpbmRlZnVzZXIvdXR4by1saWIvc3JjL2JpdGdvL2Rhc2gvRGFzaFRyYW5zYWN0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLCtEQUEyRTtBQUMzRSxpREFBK0Q7QUFFL0Qsd0RBQW1FO0FBQ25FLDZDQUFpRDtBQUVqRCxNQUFhLGVBQTBELFNBQVEsaUNBQXdCO0lBWXJHLFlBQVksT0FBZ0IsRUFBRSxFQUFpQyxFQUFFLFVBQWdDO1FBQy9GLEtBQUssQ0FBQyxPQUFPLEVBQUUsRUFBRSxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBSjFCLFNBQUksR0FBRyxDQUFDLENBQUM7UUFNZCxJQUFJLENBQUMsSUFBQSxpQkFBTSxFQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7WUFDckIsTUFBTSxJQUFJLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1FBQ3JDLENBQUM7UUFFRCxJQUFJLEVBQUUsRUFBRSxDQUFDO1lBQ1AsSUFBSSxDQUFDLE9BQU8sR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDO1lBRTFCLElBQUksRUFBRSxZQUFZLGVBQWUsRUFBRSxDQUFDO2dCQUNsQyxJQUFJLENBQUMsSUFBSSxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUM7Z0JBQ3BCLElBQUksQ0FBQyxZQUFZLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQztZQUN0QyxDQUFDO1FBQ0gsQ0FBQztRQUVELGlFQUFpRTtRQUNoRSxJQUFZLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyx3QkFBd0IsQ0FBQztJQUMzRCxDQUFDO0lBRVMsTUFBTSxDQUFDLGNBQWMsQ0FDN0IsT0FBZ0IsRUFDaEIsV0FBOEMsRUFDOUMsVUFBZ0M7UUFFaEMsT0FBTyxJQUFJLGVBQWUsQ0FBVSxPQUFPLEVB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ZGVyLCBCdWZmZXJXcml0ZXIgfSBmcm9tICdiaXRjb2luanMtbGliL3NyYy9idWZmZXJ1dGlscyc7XG5pbXBvcnQgeyBjcnlwdG8gYXMgYmNyeXB0bywgVHJhbnNhY3Rpb24gfSBmcm9tICdiaXRjb2luanMtbGliJztcblxuaW1wb3J0IHsgVXR4b1RyYW5zYWN0aW9uLCB2YXJTbGljZVNpemUgfSBmcm9tICcuLi9VdHhvVHJhbnNhY3Rpb24nO1xuaW1wb3J0IHsgaXNEYXNoLCBOZXR3b3JrIH0gZnJvbSAnLi4vLi4vbmV0d29ya3MnO1xuXG5leHBvcnQgY2xhc3MgRGFzaFRyYW5zYWN0aW9uPFROdW1iZXIgZXh0ZW5kcyBudW1iZXIgfCBiaWdpbnQgPSBudW1iZXI+IGV4dGVuZHMgVXR4b1RyYW5zYWN0aW9uPFROdW1iZXI+IHtcbiAgc3RhdGljIERBU0hfTk9STUFMID0gMDtcbiAgc3RhdGljIERBU0hfUFJPVklERVJfUkVHSVNURVIgPSAxO1xuICBzdGF0aWMgREFTSF9QUk9WSURFUl9VUERBVEVfU0VSVklDRSA9IDI7XG4gIHN0YXRpYyBEQVNIX1BST1ZJREVSX1VQREFURV9SRUdJU1RSQVIgPSAzO1xuICBzdGF0aWMgREFTSF9QUk9WSURFUl9VUERBVEVfUkVWT0tFID0gNDtcbiAgc3RhdGljIERBU0hfQ09JTkJBU0UgPSA1O1xuICBzdGF0aWMgREFTSF9RVU9SVU1fQ09NTUlUTUVOVCA9IDY7XG5cbiAgcHVibGljIHR5cGUgPSAwO1xuICBwdWJsaWMgZXh0cmFQYXlsb2FkPzogQnVmZmVyO1xuXG4gIGNvbnN0cnVjdG9yKG5ldHdvcms6IE5ldHdvcmssIHR4PzogVHJhbnNhY3Rpb248YmlnaW50IHwgbnVtYmVyPiwgYW1vdW50VHlwZT86ICdiaWdpbnQnIHwgJ251bWJlcicpIHtcbiAgICBzdXBlcihuZXR3b3JrLCB0eCwgYW1vdW50VHlwZSk7XG5cbiAgICBpZiAoIWlzRGFzaChuZXR3b3JrKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIG5ldHdvcmtgKTtcbiAgICB9XG5cbiAgICBpZiAodHgpIHtcbiAgICAgIHRoaXMudmVyc2lvbiA9IHR4LnZlcnNpb247XG5cbiAgICAgIGlmICh0eCBpbnN0YW5jZW9mIERhc2hUcmFuc2FjdGlvbikge1xuICAgICAgICB0aGlzLnR5cGUgPSB0eC50eXBlO1xuICAgICAgICB0aGlzLmV4dHJhUGF5bG9hZCA9IHR4LmV4dHJhUGF5bG9hZDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBzaW5jZSBgX190b0J1ZmZlcmAgaXMgcHJpdmF0ZSB3ZSBoYXZlIHRvIGRvIGEgbGl0dGxlIGhhY2sgaGVyZVxuICAgICh0aGlzIGFzIGFueSkuX190b0J1ZmZlciA9IHRoaXMudG9CdWZmZXJXaXRoRXh0cmFQYXlsb2FkO1xuICB9XG5cbiAgcHJvdGVjdGVkIHN0YXRpYyBuZXdUcmFuc2FjdGlvbjxUTnVtYmVyIGV4dGVuZHMgbnVtYmVyIHwgYmlnaW50ID0gbnVtYmVyPihcbiAgICBuZXR3b3JrOiBOZXR3b3JrLFxuICAgIHRyYW5zYWN0aW9uPzogRGFzaFRyYW5zYWN0aW9uPG51bWJlciB8IGJpZ2ludD4sXG4gICAgYW1vdW50VHlwZT86ICdudW1iZXInIHwgJ2JpZ2ludCdcbiAgKTogRGFzaFRyYW5zYWN0aW9uPFROdW1iZXI+IHtcbiAgICByZXR1cm4gbmV3IERhc2hUcmFuc2FjdGlvbjxUTnVtYmVyPihuZXR3b3JrLCB0cmFuc2FjdGlvbiwgYW1vdW50VHlwZSk7XG4gIH1cblxuICBzdGF0aWMgZnJvbUJ1ZmZlcjxUTnVtYmVyIGV4dGVuZHMgbnVtYmVyIHwgYmlnaW50ID0gbnVtYmVyPihcbiAgICBidWZmZXI6IEJ1ZmZlcixcbiAgICBub1N0cmljdDogYm9vbGVhbixcbiAgICBhbW91bnRUeXBlOiAnbnVtYmVyJyB8ICdiaWdpbnQnID0gJ251bWJlcicsXG4gICAgbmV0d29yazogTmV0d29ya1xuICApOiBEYXNoVHJhbnNhY3Rpb248VE51bWJlcj4ge1xuICAgIGNvbnN0IHR4ID0gbmV3IERhc2hUcmFuc2FjdGlvbjxUTnVtYmVyPihuZXR3b3JrLCBzdXBlci5mcm9tQnVmZmVyPFROdW1iZXI+KGJ1ZmZlciwgdHJ1ZSwgYW1vdW50VHlwZSwgbmV0d29yaykpO1xuICAgIHR4LnR5cGUgPSB0eC52ZXJzaW9uID4+IDE2O1xuICAgIHR4LnZlcnNpb24gPSB0eC52ZXJzaW9uICYgMHhmZmZmO1xuICAgIGlmICh0eC5ieXRlTGVuZ3RoKCkgIT09IGJ1ZmZlci5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IGJ1ZmZlclJlYWRlciA9IG5ldyBCdWZmZXJSZWFkZXIoYnVmZmVyLCB0eC5ieXRlTGVuZ3RoKCkpO1xuICAgICAgdHguZXh0cmFQYXlsb2FkID0gYnVmZmVyUmVhZGVyLnJlYWRWYXJTbGljZSgpO1xuICAgIH1cbiAgICByZXR1cm4gdHg7XG4gIH1cblxuICBjbG9uZTxUTjIgZXh0ZW5kcyBiaWdpbnQgfCBudW1iZXIgPSBUTnVtYmVyPihhbW91bnRUeXBlPzogJ251bWJlcicgfCAnYmlnaW50Jyk6IERhc2hUcmFuc2FjdGlvbjxUTjI+IHtcbiAgICByZXR1cm4gbmV3IERhc2hUcmFuc2FjdGlvbjxUTjI+KHRoaXMubmV0d29yaywgdGhpcywgYW1vdW50VHlwZSk7XG4gIH1cblxuICBieXRlTGVuZ3RoKF9BTExPV19XSVRORVNTPzogYm9vbGVhbik6IG51bWJlciB7XG4gICAgcmV0dXJuIHN1cGVyLmJ5dGVMZW5ndGgoX0FMTE9XX1dJVE5FU1MpICsgKHRoaXMuZXh0cmFQYXlsb2FkID8gdmFyU2xpY2VTaXplKHRoaXMuZXh0cmFQYXlsb2FkKSA6IDApO1xuICB9XG5cbiAgLyoqXG4gICAqIEhlbHBlciB0byBvdmVycmlkZSBgX190b0J1ZmZlcigpYCBvZiBiaXRjb2luanMuVHJhbnNhY3Rpb24uXG4gICAqIFNpbmNlIHRoZSBtZXRob2QgaXMgcHJpdmF0ZSwgd2UgdXNlIGEgaGFjayBpbiB0aGUgY29uc3RydWN0b3IgdG8gbWFrZSBpdCB3b3JrLlxuICAgKlxuICAgKiBUT0RPOiByZW1vdmUgYHByaXZhdGVgIG1vZGlmaWVyIGluIGJpdGNvaW5qcyBgX190b0J1ZmZlcigpYCBvciBmaW5kIHNvbWUgb3RoZXIgc29sdXRpb25cbiAgICpcbiAgICogQHBhcmFtIGJ1ZmZlciAtIG9wdGlvbmFsIHRhcmdldCBidWZmZXJcbiAgICogQHBhcmFtIGluaXRpYWxPZmZzZXQgLSBjYW4gb25seSBiZSB1bmRlZmluZWQgb3IgMC4gT3RoZXIgdmFsdWVzIGFyZSBvbmx5IHVzZWQgZm9yIHNlcmlhbGl6YXRpb24gaW4gYmxvY2tzLlxuICAgKiBAcGFyYW0gX0FMTE9XX1dJVE5FU1MgLSBpZ25vcmVkXG4gICAqL1xuICBwcml2YXRlIHRvQnVmZmVyV2l0aEV4dHJhUGF5bG9hZChidWZmZXI/OiBCdWZmZXIsIGluaXRpYWxPZmZzZXQ/OiBudW1iZXIsIF9BTExPV19XSVRORVNTID0gZmFsc2UpOiBCdWZmZXIge1xuICAgIC8vIFdlIGNhbiBpZ25vcmUgdGhlIGBfQUxMT1dfV0lUTkVTU2AgcGFyYW1ldGVyIGhlcmUgc2luY2UgaXQgaGFzIG5vIGVmZmVjdC5cbiAgICBpZiAoIWJ1ZmZlcikge1xuICAgICAgYnVmZmVyID0gQnVmZmVyLmFsbG9jVW5zYWZlKHRoaXMuYnl0ZUxlbmd0aChmYWxzZSkpO1xuICAgIH1cblxuICAgIGlmIChpbml0aWFsT2Zmc2V0ICE9PSB1bmRlZmluZWQgJiYgaW5pdGlhbE9mZnNldCAhPT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBub3Qgc3VwcG9ydGVkYCk7XG4gICAgfVxuXG4gICAgLy8gU3RhcnQgb3V0IHdpdGggcmVndWxhciBiaXRjb2luIGJ5dGUgc2VxdWVuY2UuXG4gICAgLy8gVGhpcyBidWZmZXIgd2lsbCBoYXZlIGV4Y2VzcyBzaXplIGJlY2F1c2UgaXQgdXNlcyBgYnl0ZUxlbmd0aCgpYCB0byBhbGxvY2F0ZS5cbiAgICBjb25zdCBiYXNlQnVmZmVyID0gKFRyYW5zYWN0aW9uLnByb3RvdHlwZSBhcyBhbnkpLl9fdG9CdWZmZXIuY2FsbCh0aGlzKTtcbiAgICBiYXNlQnVmZmVyLmNvcHkoYnVmZmVyKTtcblxuICAgIC8vIG92ZXJ3cml0ZSBsZWFkaW5nIHZlcnNpb24gYnl0ZXMgKHVpbnQxNiB2ZXJzaW9uLCB1aW50MTYgdHlwZSlcbiAgICBjb25zdCBidWZmZXJXcml0ZXIgPSBuZXcgQnVmZmVyV3JpdGVyKGJ1ZmZlciwgMCk7XG4gICAgYnVmZmVyV3JpdGVyLndyaXRlVUludDMyKCh0aGlzLnZlcnNpb24gJiAweGZmZmYpIHwgKHRoaXMudHlwZSA8PCAxNikpO1xuXG4gICAgLy8gU2VlayB0byBlbmQgb2Ygb3JpZ2luYWwgYnl0ZSBzZXF1ZW5jZSBhbmQgYWRkIGV4dHJhUGF5bG9hZC5cbiAgICAvLyBXZSBtdXN0IHVzZSB0aGUgYnl0ZUxlbmd0aCBhcyBjYWxjdWxhdGVkIGJ5IHRoZSBiaXRjb2luanMgaW1wbGVtZW50YXRpb24gc2luY2VcbiAgICAvLyBgYmFzZUJ1ZmZlcmAgaGFzIGFuIGV4Y2VzcyBzaXplLlxuICAgIGlmICh0aGlzLmV4dHJhUGF5bG9hZCkge1xuICAgICAgYnVmZmVyV3JpdGVyLm9mZnNldCA9IFRyYW5zYWN0aW9uLnByb3RvdHlwZS5ieXRlTGVuZ3RoLmNhbGwodGhpcyk7XG4gICAgICBidWZmZXJXcml0ZXIud3JpdGVWYXJTbGljZSh0aGlzLmV4dHJhUGF5bG9hZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJ1ZmZlcjtcbiAgfVxuXG4gIGdldEhhc2goZm9yV2l0bmVzcz86IGJvb2xlYW4pOiBCdWZmZXIge1xuICAgIGlmIChmb3JXaXRuZXNzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgYXJndW1lbnRgKTtcbiAgICB9XG4gICAgcmV0dXJuIGJjcnlwdG8uaGFzaDI1Nih0aGlzLnRvQnVmZmVyKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEJ1aWxkIGEgaGFzaCBmb3IgYWxsIG9yIG5vbmUgb2YgdGhlIHRyYW5zYWN0aW9uIGlucHV0cyBkZXBlbmRpbmcgb24gdGhlIGhhc2h0eXBlXG4gICAqIEBwYXJhbSBoYXNoVHlwZVxuICAgKiBAcmV0dXJucyBCdWZmZXJcbiAgICovXG4gIGdldFByZXZvdXRIYXNoKGhhc2hUeXBlOiBudW1iZXIpOiBCdWZmZXIge1xuICAgIGlmICghKGhhc2hUeXBlICYgVXR4b1RyYW5zYWN0aW9uLlNJR0hBU0hfQU5ZT05FQ0FOUEFZKSkge1xuICAgICAgY29uc3QgYnVmZmVyV3JpdGVyID0gbmV3IEJ1ZmZlcldyaXRlcihCdWZmZXIuYWxsb2NVbnNhZmUoMzYgKiB0aGlzLmlucy5sZW5ndGgpKTtcblxuICAgICAgdGhpcy5pbnMuZm9yRWFjaChmdW5jdGlvbiAodHhJbikge1xuICAgICAgICBidWZmZXJXcml0ZXIud3JpdGVTbGljZSh0eEluLmhhc2gpO1xuICAgICAgICBidWZmZXJXcml0ZXIud3JpdGVVSW50MzIodHhJbi5pbmRleCk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGJjcnlwdG8uaGFzaDI1NihidWZmZXJXcml0ZXIuYnVmZmVyKTtcbiAgICB9XG5cbiAgICByZXR1cm4gQnVmZmVyLmFsbG9jKDMyLCAwKTtcbiAgfVxufVxuIl19
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMXUwNzM5a3lwcCIsImFjdHVhbENvdmVyYWdlIiwicyIsImJ1ZmZlcnV0aWxzXzEiLCJyZXF1aXJlIiwiYml0Y29pbmpzX2xpYl8xIiwiVXR4b1RyYW5zYWN0aW9uXzEiLCJuZXR3b3Jrc18xIiwiRGFzaFRyYW5zYWN0aW9uIiwiVXR4b1RyYW5zYWN0aW9uIiwiY29uc3RydWN0b3IiLCJuZXR3b3JrIiwidHgiLCJhbW91bnRUeXBlIiwiZiIsInR5cGUiLCJpc0Rhc2giLCJiIiwiRXJyb3IiLCJ2ZXJzaW9uIiwiZXh0cmFQYXlsb2FkIiwiX190b0J1ZmZlciIsInRvQnVmZmVyV2l0aEV4dHJhUGF5bG9hZCIsIm5ld1RyYW5zYWN0aW9uIiwidHJhbnNhY3Rpb24iLCJmcm9tQnVmZmVyIiwiYnVmZmVyIiwibm9TdHJpY3QiLCJieXRlTGVuZ3RoIiwibGVuZ3RoIiwiYnVmZmVyUmVhZGVyIiwiQnVmZmVyUmVhZGVyIiwicmVhZFZhclNsaWNlIiwiY2xvbmUiLCJfQUxMT1dfV0lUTkVTUyIsInZhclNsaWNlU2l6ZSIsImluaXRpYWxPZmZzZXQiLCJCdWZmZXIiLCJhbGxvY1Vuc2FmZSIsInVuZGVmaW5lZCIsImJhc2VCdWZmZXIiLCJUcmFuc2FjdGlvbiIsInByb3RvdHlwZSIsImNhbGwiLCJjb3B5IiwiYnVmZmVyV3JpdGVyIiwiQnVmZmVyV3JpdGVyIiwid3JpdGVVSW50MzIiLCJvZmZzZXQiLCJ3cml0ZVZhclNsaWNlIiwiZ2V0SGFzaCIsImZvcldpdG5lc3MiLCJjcnlwdG8iLCJoYXNoMjU2IiwidG9CdWZmZXIiLCJnZXRQcmV2b3V0SGFzaCIsImhhc2hUeXBlIiwiU0lHSEFTSF9BTllPTkVDQU5QQVkiLCJpbnMiLCJmb3JFYWNoIiwidHhJbiIsIndyaXRlU2xpY2UiLCJoYXNoIiwiaW5kZXgiLCJhbGxvYyIsImV4cG9ydHMiLCJEQVNIX05PUk1BTCIsIkRBU0hfUFJPVklERVJfUkVHSVNURVIiLCJEQVNIX1BST1ZJREVSX1VQREFURV9TRVJWSUNFIiwiREFTSF9QUk9WSURFUl9VUERBVEVfUkVHSVNUUkFSIiwiREFTSF9QUk9WSURFUl9VUERBVEVfUkVWT0tFIiwiREFTSF9DT0lOQkFTRSIsIkRBU0hfUVVPUlVNX0NPTU1JVE1FTlQiXSwic291cmNlcyI6WyIvVXNlcnMvcXJvYy9Db2RlL2hhcGkvY2hhaW5kZWZ1c2VyL3V0eG8tbGliL3NyYy9iaXRnby9kYXNoL0Rhc2hUcmFuc2FjdGlvbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCdWZmZXJSZWFkZXIsIEJ1ZmZlcldyaXRlciB9IGZyb20gJ2JpdGNvaW5qcy1saWIvc3JjL2J1ZmZlcnV0aWxzJztcbmltcG9ydCB7IGNyeXB0byBhcyBiY3J5cHRvLCBUcmFuc2FjdGlvbiB9IGZyb20gJ2JpdGNvaW5qcy1saWInO1xuXG5pbXBvcnQgeyBVdHhvVHJhbnNhY3Rpb24sIHZhclNsaWNlU2l6ZSB9IGZyb20gJy4uL1V0eG9UcmFuc2FjdGlvbic7XG5pbXBvcnQgeyBpc0Rhc2gsIE5ldHdvcmsgfSBmcm9tICcuLi8uLi9uZXR3b3Jrcyc7XG5cbmV4cG9ydCBjbGFzcyBEYXNoVHJhbnNhY3Rpb248VE51bWJlciBleHRlbmRzIG51bWJlciB8IGJpZ2ludCA9IG51bWJlcj4gZXh0ZW5kcyBVdHhvVHJhbnNhY3Rpb248VE51bWJlcj4ge1xuICBzdGF0aWMgREFTSF9OT1JNQUwgPSAwO1xuICBzdGF0aWMgREFTSF9QUk9WSURFUl9SRUdJU1RFUiA9IDE7XG4gIHN0YXRpYyBEQVNIX1BST1ZJREVSX1VQREFURV9TRVJWSUNFID0gMjtcbiAgc3RhdGljIERBU0hfUFJPVklERVJfVVBEQVRFX1JFR0lTVFJBUiA9IDM7XG4gIHN0YXRpYyBEQVNIX1BST1ZJREVSX1VQREFURV9SRVZPS0UgPSA0O1xuICBzdGF0aWMgREFTSF9DT0lOQkFTRSA9IDU7XG4gIHN0YXRpYyBEQVNIX1FVT1JVTV9DT01NSVRNRU5UID0gNjtcblxuICBwdWJsaWMgdHlwZSA9IDA7XG4gIHB1YmxpYyBleHRyYVBheWxvYWQ/OiBCdWZmZXI7XG5cbiAgY29uc3RydWN0b3IobmV0d29yazogTmV0d29yaywgdHg/OiBUcmFuc2FjdGlvbjxiaWdpbnQgfCBudW1iZXI+LCBhbW91bnRUeXBlPzogJ2JpZ2ludCcgfCAnbnVtYmVyJykge1xuICAgIHN1cGVyKG5ldHdvcmssIHR4LCBhbW91bnRUeXBlKTtcblxuICAgIGlmICghaXNEYXNoKG5ldHdvcmspKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgbmV0d29ya2ApO1xuICAgIH1cblxuICAgIGlmICh0eCkge1xuICAgICAgdGhpcy52ZXJzaW9uID0gdHgudmVyc2lvbjtcblxuICAgICAgaWYgKHR4IGluc3RhbmNlb2YgRGFzaFRyYW5zYWN0aW9uKSB7XG4gICAgICAgIHRoaXMudHlwZSA9IHR4LnR5cGU7XG4gICAgICAgIHRoaXMuZXh0cmFQYXlsb2FkID0gdHguZXh0cmFQYXlsb2FkO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIHNpbmNlIGBfX3RvQnVmZmVyYCBpcyBwcml2YXRlIHdlIGhhdmUgdG8gZG8gYSBsaXR0bGUgaGFjayBoZXJlXG4gICAgKHRoaXMgYXMgYW55KS5fX3RvQnVmZmVyID0gdGhpcy50b0J1ZmZlcldpdGhFeHRyYVBheWxvYWQ7XG4gIH1cblxuICBwcm90ZWN0ZWQgc3RhdGljIG5ld1RyYW5zYWN0aW9uPFROdW1iZXIgZXh0ZW5kcyBudW1iZXIgfCBiaWdpbnQgPSBudW1iZXI+KFxuICAgIG5ldHdvcms6IE5ldHdvcmssXG4gICAgdHJhbnNhY3Rpb24/OiBEYXNoVHJhbnNhY3Rpb248bnVtYmVyIHwgYmlnaW50PixcbiAgICBhbW91bnRUeXBlPzogJ251bWJlcicgfCAnYmlnaW50J1xuICApOiBEYXNoVHJhbnNhY3Rpb248VE51bWJlcj4ge1xuICAgIHJldHVybiBuZXcgRGFzaFRyYW5zYWN0aW9uPFROdW1iZXI+KG5ldHdvcmssIHRyYW5zYWN0aW9uLCBhbW91bnRUeXBlKTtcbiAgfVxuXG4gIHN0YXRpYyBmcm9tQnVmZmVyPFROdW1iZXIgZXh0ZW5kcyBudW1iZXIgfCBiaWdpbnQgPSBudW1iZXI+KFxuICAgIGJ1ZmZlcjogQnVmZmVyLFxuICAgIG5vU3RyaWN0OiBib29sZWFuLFxuICAgIGFtb3VudFR5cGU6ICdudW1iZXInIHwgJ2JpZ2ludCcgPSAnbnVtYmVyJyxcbiAgICBuZXR3b3JrOiBOZXR3b3JrXG4gICk6IERhc2hUcmFuc2FjdGlvbjxUTnVtYmVyPiB7XG4gICAgY29uc3QgdHggPSBuZXcgRGFzaFRyYW5zYWN0aW9uPFROdW1iZXI+KG5ldHdvcmssIHN1cGVyLmZyb21CdWZmZXI8VE51bWJlcj4oYnVmZmVyLCB0cnVlLCBhbW91bnRUeXBlLCBuZXR3b3JrKSk7XG4gICAgdHgudHlwZSA9IHR4LnZlcnNpb24gPj4gMTY7XG4gICAgdHgudmVyc2lvbiA9IHR4LnZlcnNpb24gJiAweGZmZmY7XG4gICAgaWYgKHR4LmJ5dGVMZW5ndGgoKSAhPT0gYnVmZmVyLmxlbmd0aCkge1xuICAgICAgY29uc3QgYnVmZmVyUmVhZGVyID0gbmV3IEJ1ZmZlclJlYWRlcihidWZmZXIsIHR4LmJ5dGVMZW5ndGgoKSk7XG4gICAgICB0eC5leHRyYVBheWxvYWQgPSBidWZmZXJSZWFkZXIucmVhZFZhclNsaWNlKCk7XG4gICAgfVxuICAgIHJldHVybiB0eDtcbiAgfVxuXG4gIGNsb25lPFROMiBleHRlbmRzIGJpZ2ludCB8IG51bWJlciA9IFROdW1iZXI+KGFtb3VudFR5cGU/OiAnbnVtYmVyJyB8ICdiaWdpbnQnKTogRGFzaFRyYW5zYWN0aW9uPFROMj4ge1xuICAgIHJldHVybiBuZXcgRGFzaFRyYW5zYWN0aW9uPFROMj4odGhpcy5uZXR3b3JrLCB0aGlzLCBhbW91bnRUeXBlKTtcbiAgfVxuXG4gIGJ5dGVMZW5ndGgoX0FMTE9XX1dJVE5FU1M/OiBib29sZWFuKTogbnVtYmVyIHtcbiAgICByZXR1cm4gc3VwZXIuYnl0ZUxlbmd0aChfQUxMT1dfV0lUTkVTUykgKyAodGhpcy5leHRyYVBheWxvYWQgPyB2YXJTbGljZVNpemUodGhpcy5leHRyYVBheWxvYWQpIDogMCk7XG4gIH1cblxuICAvKipcbiAgICogSGVscGVyIHRvIG92ZXJyaWRlIGBfX3RvQnVmZmVyKClgIG9mIGJpdGNvaW5qcy5UcmFuc2FjdGlvbi5cbiAgICogU2luY2UgdGhlIG1ldGhvZCBpcyBwcml2YXRlLCB3ZSB1c2UgYSBoYWNrIGluIHRoZSBjb25zdHJ1Y3RvciB0byBtYWtlIGl0IHdvcmsuXG4gICAqXG4gICAqIFRPRE86IHJlbW92ZSBgcHJpdmF0ZWAgbW9kaWZpZXIgaW4gYml0Y29pbmpzIGBfX3RvQnVmZmVyKClgIG9yIGZpbmQgc29tZSBvdGhlciBzb2x1dGlvblxuICAgKlxuICAgKiBAcGFyYW0gYnVmZmVyIC0gb3B0aW9uYWwgdGFyZ2V0IGJ1ZmZlclxuICAgKiBAcGFyYW0gaW5pdGlhbE9mZnNldCAtIGNhbiBvbmx5IGJlIHVuZGVmaW5lZCBvciAwLiBPdGhlciB2YWx1ZXMgYXJlIG9ubHkgdXNlZCBmb3Igc2VyaWFsaXphdGlvbiBpbiBibG9ja3MuXG4gICAqIEBwYXJhbSBfQUxMT1dfV0lUTkVTUyAtIGlnbm9yZWRcbiAgICovXG4gIHByaXZhdGUgdG9CdWZmZXJXaXRoRXh0cmFQYXlsb2FkKGJ1ZmZlcj86IEJ1ZmZlciwgaW5pdGlhbE9mZnNldD86IG51bWJlciwgX0FMTE9XX1dJVE5FU1MgPSBmYWxzZSk6IEJ1ZmZlciB7XG4gICAgLy8gV2UgY2FuIGlnbm9yZSB0aGUgYF9BTExPV19XSVRORVNTYCBwYXJhbWV0ZXIgaGVyZSBzaW5jZSBpdCBoYXMgbm8gZWZmZWN0LlxuICAgIGlmICghYnVmZmVyKSB7XG4gICAgICBidWZmZXIgPSBCdWZmZXIuYWxsb2NVbnNhZmUodGhpcy5ieXRlTGVuZ3RoKGZhbHNlKSk7XG4gICAgfVxuXG4gICAgaWYgKGluaXRpYWxPZmZzZXQgIT09IHVuZGVmaW5lZCAmJiBpbml0aWFsT2Zmc2V0ICE9PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYG5vdCBzdXBwb3J0ZWRgKTtcbiAgICB9XG5cbiAgICAvLyBTdGFydCBvdXQgd2l0aCByZWd1bGFyIGJpdGNvaW4gYnl0ZSBzZXF1ZW5jZS5cbiAgICAvLyBUaGlzIGJ1ZmZlciB3aWxsIGhhdmUgZXhjZXNzIHNpemUgYmVjYXVzZSBpdCB1c2VzIGBieXRlTGVuZ3RoKClgIHRvIGFsbG9jYXRlLlxuICAgIGNvbnN0IGJhc2VCdWZmZXIgPSAoVHJhbnNhY3Rpb24ucHJvdG90eXBlIGFzIGFueSkuX190b0J1ZmZlci5jYWxsKHRoaXMpO1xuICAgIGJhc2VCdWZmZXIuY29weShidWZmZXIpO1xuXG4gICAgLy8gb3ZlcndyaXRlIGxlYWRpbmcgdmVyc2lvbiBieXRlcyAodWludDE2IHZlcnNpb24sIHVpbnQxNiB0eXBlKVxuICAgIGNvbnN0IGJ1ZmZlcldyaXRlciA9IG5ldyBCdWZmZXJXcml0ZXIoYnVmZmVyLCAwKTtcbiAgICBidWZmZXJXcml0ZXIud3JpdGVVSW50MzIoKHRoaXMudmVyc2lvbiAmIDB4ZmZmZikgfCAodGhpcy50eXBlIDw8IDE2KSk7XG5cbiAgICAvLyBTZWVrIHRvIGVuZCBvZiBvcmlnaW5hbCBieXRlIHNlcXVlbmNlIGFuZCBhZGQgZXh0cmFQYXlsb2FkLlxuICAgIC8vIFdlIG11c3QgdXNlIHRoZSBieXRlTGVuZ3RoIGFzIGNhbGN1bGF0ZWQgYnkgdGhlIGJpdGNvaW5qcyBpbXBsZW1lbnRhdGlvbiBzaW5jZVxuICAgIC8vIGBiYXNlQnVmZmVyYCBoYXMgYW4gZXhjZXNzIHNpemUuXG4gICAgaWYgKHRoaXMuZXh0cmFQYXlsb2FkKSB7XG4gICAgICBidWZmZXJXcml0ZXIub2Zmc2V0ID0gVHJhbnNhY3Rpb24ucHJvdG90eXBlLmJ5dGVMZW5ndGguY2FsbCh0aGlzKTtcbiAgICAgIGJ1ZmZlcldyaXRlci53cml0ZVZhclNsaWNlKHRoaXMuZXh0cmFQYXlsb2FkKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYnVmZmVyO1xuICB9XG5cbiAgZ2V0SGFzaChmb3JXaXRuZXNzPzogYm9vbGVhbik6IEJ1ZmZlciB7XG4gICAgaWYgKGZvcldpdG5lc3MpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgaW52YWxpZCBhcmd1bWVudGApO1xuICAgIH1cbiAgICByZXR1cm4gYmNyeXB0by5oYXNoMjU2KHRoaXMudG9CdWZmZXIoKSk7XG4gIH1cblxuICAvKipcbiAgICogQnVpbGQgYSBoYXNoIGZvciBhbGwgb3Igbm9uZSBvZiB0aGUgdHJhbnNhY3Rpb24gaW5wdXRzIGRlcGVuZGluZyBvbiB0aGUgaGFzaHR5cGVcbiAgICogQHBhcmFtIGhhc2hUeXBlXG4gICAqIEByZXR1cm5zIEJ1ZmZlclxuICAgKi9cbiAgZ2V0UHJldm91dEhhc2goaGFzaFR5cGU6IG51bWJlcik6IEJ1ZmZlciB7XG4gICAgaWYgKCEoaGFzaFR5cGUgJiBVdHhvVHJhbnNhY3Rpb24uU0lHSEFTSF9BTllPTkVDQU5QQVkpKSB7XG4gICAgICBjb25zdCBidWZmZXJXcml0ZXIgPSBuZXcgQnVmZmVyV3JpdGVyKEJ1ZmZlci5hbGxvY1Vuc2FmZSgzNiAqIHRoaXMuaW5zLmxlbmd0aCkpO1xuXG4gICAgICB0aGlzLmlucy5mb3JFYWNoKGZ1bmN0aW9uICh0eEluKSB7XG4gICAgICAgIGJ1ZmZlcldyaXRlci53cml0ZVNsaWNlKHR4SW4uaGFzaCk7XG4gICAgICAgIGJ1ZmZlcldyaXRlci53cml0ZVVJbnQzMih0eEluLmluZGV4KTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gYmNyeXB0by5oYXNoMjU2KGJ1ZmZlcldyaXRlci5idWZmZXIpO1xuICAgIH1cblxuICAgIHJldHVybiBCdWZmZXIuYWxsb2MoMzIsIDApO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiJteWdCQTBCTTtBQUFBQSxjQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGNBQUEsR0FBQUEsY0FBQSxHQUFBRSxDQUFBLE0sZ0hBMUJOLE1BQUFDLGFBQUEsRUFBQUgsY0FBQSxHQUFBRSxDQUFBLE1BQUFFLE9BQUEsbUNBQ0EsTUFBQUMsZUFBQSxFQUFBTCxjQUFBLEdBQUFFLENBQUEsTUFBQUUsT0FBQSxtQkFFQSxN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