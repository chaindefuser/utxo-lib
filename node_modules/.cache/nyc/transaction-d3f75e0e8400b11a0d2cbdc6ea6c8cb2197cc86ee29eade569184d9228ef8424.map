{"version":3,"file":"/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/transaction.ts","sources":["/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/transaction.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint no-redeclare: 0 */\nimport { TxOutput } from 'bitcoinjs-lib';\n\nimport { networks, Network, getMainnet } from '../networks';\n\nimport { UtxoPsbt, PsbtOpts } from './UtxoPsbt';\nimport { UtxoTransaction } from './UtxoTransaction';\nimport { UtxoTransactionBuilder } from './UtxoTransactionBuilder';\nimport { DashPsbt } from './dash/DashPsbt';\nimport { DashTransaction } from './dash/DashTransaction';\nimport { DashTransactionBuilder } from './dash/DashTransactionBuilder';\nimport { ZcashPsbt } from './zcash/ZcashPsbt';\nimport { ZcashTransactionBuilder } from './zcash/ZcashTransactionBuilder';\nimport { ZcashNetwork, ZcashTransaction } from './zcash/ZcashTransaction';\nimport { LitecoinPsbt, LitecoinTransaction, LitecoinTransactionBuilder } from './litecoin';\nimport { isPsbt, toPsbtBuffer } from './PsbtUtil';\n\nexport function createTransactionFromBuffer(\n  buf: Buffer,\n  network: Network,\n  params: { version?: number; amountType: 'bigint' }\n): UtxoTransaction<bigint>;\nexport function createTransactionFromBuffer<TNumber extends number | bigint>(\n  buf: Buffer,\n  network: Network,\n  params?: { version?: number; amountType?: 'number' | 'bigint' }\n): UtxoTransaction<TNumber>;\nexport function createTransactionFromBuffer<TNumber extends number | bigint = number>(\n  buf: Buffer,\n  network: Network,\n  { version, amountType }: { version?: number; amountType?: 'number' | 'bigint' } = {},\n  deprecatedAmountType?: 'number' | 'bigint'\n): UtxoTransaction<TNumber> {\n  if (amountType) {\n    if (deprecatedAmountType && amountType !== deprecatedAmountType) {\n      throw new Error(`invalid arguments`);\n    }\n  } else {\n    if (deprecatedAmountType) {\n      amountType = deprecatedAmountType;\n    } else {\n      amountType = 'number';\n    }\n  }\n  switch (getMainnet(network)) {\n    case networks.bitcoin:\n    case networks.bitcoincash:\n    case networks.bitcoinsv:\n    case networks.bitcoingold:\n    case networks.dogecoin:\n    case networks.ecash:\n      return UtxoTransaction.fromBuffer<TNumber>(buf, false, amountType, network);\n    case networks.litecoin:\n      return LitecoinTransaction.fromBuffer<TNumber>(buf, false, amountType, network);\n    case networks.dash:\n      return DashTransaction.fromBuffer<TNumber>(buf, false, amountType, network);\n    case networks.zcash:\n      return ZcashTransaction.fromBufferWithVersion<TNumber>(buf, network as ZcashNetwork, version, amountType);\n  }\n\n  /* istanbul ignore next */\n  throw new Error(`invalid network`);\n}\n\n/* istanbul ignore next */\n/** @deprecated - use createTransactionFromBuffer instead */\nexport function createTransactionFromHex(\n  hex: string,\n  network: Network,\n  p: { amountType: 'bigint' }\n): UtxoTransaction<bigint>;\n/** @deprecated - use createTransactionFromBuffer instead */\nexport function createTransactionFromHex(hex: string, network: Network, p: { amountType: 'number' }): UtxoTransaction;\n/** @deprecated - use createTransactionFromBuffer instead */\nexport function createTransactionFromHex<TNumber extends number | bigint = number>(\n  hex: string,\n  network: Network,\n  p?: { amountType?: 'number' | 'bigint' } | 'number' | 'bigint'\n): UtxoTransaction<TNumber>;\nexport function createTransactionFromHex<TNumber extends number | bigint = number>(\n  hex: string,\n  network: Network,\n  p?: { amountType?: 'number' | 'bigint' } | 'number' | 'bigint'\n): UtxoTransaction<TNumber> {\n  if (typeof p === 'string') {\n    p = { amountType: p };\n  }\n  return createTransactionFromBuffer<TNumber>(Buffer.from(hex, 'hex'), network, p);\n}\n\n/**\n * @param buf - must start with the PSBT magic bytes\n * @param network\n * @param bip32PathsAbsolute\n */\nexport function createPsbtFromBuffer(buf: Buffer, network: Network, bip32PathsAbsolute = false): UtxoPsbt {\n  if (!isPsbt(buf)) {\n    throw new Error(`invalid psbt (does not start with 'psbt' magic bytes)`);\n  }\n  switch (getMainnet(network)) {\n    case networks.bitcoin:\n    case networks.bitcoincash:\n    case networks.bitcoinsv:\n    case networks.bitcoingold:\n    case networks.dogecoin:\n    case networks.ecash:\n      return UtxoPsbt.fromBuffer(buf, { network, bip32PathsAbsolute });\n    case networks.litecoin:\n      return LitecoinPsbt.fromBuffer(buf, { network, bip32PathsAbsolute });\n    case networks.dash:\n      return DashPsbt.fromBuffer(buf, { network, bip32PathsAbsolute });\n    case networks.zcash:\n      return ZcashPsbt.fromBuffer(buf, { network, bip32PathsAbsolute });\n  }\n\n  /* istanbul ignore next */\n  throw new Error(`invalid network`);\n}\n\n/**\n * Like createPsbtFromBuffer, but attempts hex and base64 decoding as well.\n *\n * @param buf\n * @param network\n * @param bip32PathsAbsolute\n */\nexport function createPsbtDecode(buf: Buffer | string, network: Network, bip32PathsAbsolute = false): UtxoPsbt {\n  return createPsbtFromBuffer(toPsbtBuffer(buf), network, bip32PathsAbsolute);\n}\n\nexport function createPsbtFromHex(hex: string, network: Network, bip32PathsAbsolute = false): UtxoPsbt {\n  return createPsbtFromBuffer(Buffer.from(hex, 'hex'), network, bip32PathsAbsolute);\n}\n\nexport function createPsbtFromTransaction(tx: UtxoTransaction<bigint>, prevOuts: TxOutput<bigint>[]): UtxoPsbt {\n  switch (getMainnet(tx.network)) {\n    case networks.bitcoin:\n    case networks.bitcoincash:\n    case networks.bitcoinsv:\n    case networks.bitcoingold:\n    case networks.dogecoin:\n    case networks.ecash:\n      return UtxoPsbt.fromTransaction(tx, prevOuts);\n    case networks.litecoin:\n      return LitecoinPsbt.fromTransaction(tx, prevOuts);\n    case networks.dash:\n      return DashPsbt.fromTransaction(tx, prevOuts);\n    case networks.zcash:\n      return ZcashPsbt.fromTransaction(tx, prevOuts);\n  }\n\n  /* istanbul ignore next */\n  throw new Error(`invalid network`);\n}\n\nexport function getDefaultTransactionVersion(network: Network): number {\n  // Use NU6 version for testnet, activated on mainnet in block 2726400\n  // https://zips.z.cash/zip-0253\n  if (network === networks.zcashTest) {\n    return ZcashTransaction.VERSION4_BRANCH_NU6;\n  }\n\n  switch (getMainnet(network)) {\n    case networks.bitcoincash:\n    case networks.bitcoinsv:\n    case networks.bitcoingold:\n    case networks.ecash:\n      return 2;\n    case networks.zcash:\n      return ZcashTransaction.VERSION4_BRANCH_NU6;\n    default:\n      return 1;\n  }\n}\n\nexport function setTransactionBuilderDefaults<TNumber extends number | bigint>(\n  txb: UtxoTransactionBuilder<TNumber>,\n  network: Network,\n  { version = getDefaultTransactionVersion(network) }: { version?: number } = {}\n): void {\n  switch (getMainnet(network)) {\n    case networks.bitcoincash:\n    case networks.bitcoinsv:\n    case networks.bitcoingold:\n    case networks.ecash:\n      if (version !== 2) {\n        throw new Error(`invalid version`);\n      }\n      txb.setVersion(version);\n      break;\n    case networks.zcash:\n      (txb as ZcashTransactionBuilder<TNumber>).setDefaultsForVersion(network, version);\n      break;\n    default:\n      if (version !== 1) {\n        throw new Error(`invalid version`);\n      }\n  }\n}\n\nexport function setPsbtDefaults(\n  psbt: UtxoPsbt,\n  network: Network,\n  { version = getDefaultTransactionVersion(network) }: { version?: number } = {}\n): void {\n  switch (getMainnet(network)) {\n    case networks.bitcoincash:\n    case networks.bitcoinsv:\n    case networks.bitcoingold:\n    case networks.ecash:\n      if (version !== 2) {\n        throw new Error(`invalid version`);\n      }\n      break;\n    case networks.zcash:\n      if (\n        ![\n          ZcashTransaction.VERSION4_BRANCH_CANOPY,\n          ZcashTransaction.VERSION4_BRANCH_NU5,\n          ZcashTransaction.VERSION4_BRANCH_NU6,\n          ZcashTransaction.VERSION5_BRANCH_NU5,\n          ZcashTransaction.VERSION5_BRANCH_NU6,\n        ].includes(version)\n      ) {\n        throw new Error(`invalid version`);\n      }\n      (psbt as ZcashPsbt).setDefaultsForVersion(network, version);\n      break;\n    default:\n      if (version !== 1) {\n        throw new Error(`invalid version`);\n      }\n      // FIXME: set version here, because there's a bug in the upstream PSBT\n      // that defaults transactions to v2.\n      psbt.setVersion(version);\n  }\n}\n\nexport function createPsbtForNetwork(psbtOpts: PsbtOpts, { version }: { version?: number } = {}): UtxoPsbt {\n  let psbt;\n\n  switch (getMainnet(psbtOpts.network)) {\n    case networks.bitcoin:\n    case networks.bitcoincash:\n    case networks.bitcoinsv:\n    case networks.bitcoingold:\n    case networks.dogecoin:\n    case networks.ecash: {\n      psbt = UtxoPsbt.createPsbt(psbtOpts);\n      break;\n    }\n    case networks.litecoin: {\n      psbt = LitecoinPsbt.createPsbt(psbtOpts);\n      break;\n    }\n    case networks.dash: {\n      psbt = DashPsbt.createPsbt(psbtOpts);\n      break;\n    }\n    case networks.zcash: {\n      psbt = ZcashPsbt.createPsbt(psbtOpts);\n      break;\n    }\n    default:\n      throw new Error(`unsupported network`);\n  }\n\n  setPsbtDefaults(psbt, psbtOpts.network, { version });\n\n  return psbt;\n}\n\nexport function createTransactionBuilderForNetwork<TNumber extends number | bigint = number>(\n  network: Network,\n  { version }: { version?: number } = {}\n): UtxoTransactionBuilder<TNumber> {\n  let txb;\n  switch (getMainnet(network)) {\n    case networks.bitcoin:\n    case networks.bitcoincash:\n    case networks.bitcoinsv:\n    case networks.bitcoingold:\n    case networks.dogecoin:\n    case networks.ecash: {\n      txb = new UtxoTransactionBuilder<TNumber>(network);\n      break;\n    }\n    case networks.litecoin: {\n      txb = new LitecoinTransactionBuilder<TNumber>(network);\n      break;\n    }\n    case networks.dash:\n      txb = new DashTransactionBuilder<TNumber>(network);\n      break;\n    case networks.zcash: {\n      txb = new ZcashTransactionBuilder<TNumber>(network as ZcashNetwork);\n      break;\n    }\n    default:\n      throw new Error(`unsupported network`);\n  }\n\n  setTransactionBuilderDefaults<TNumber>(txb, network, { version });\n\n  return txb;\n}\n\nexport function createTransactionBuilderFromTransaction<TNumber extends number | bigint>(\n  tx: UtxoTransaction<TNumber>,\n  prevOutputs?: TxOutput<TNumber>[]\n): UtxoTransactionBuilder<TNumber> {\n  switch (getMainnet(tx.network)) {\n    case networks.bitcoin:\n    case networks.bitcoincash:\n    case networks.bitcoinsv:\n    case networks.bitcoingold:\n    case networks.dogecoin:\n    case networks.ecash:\n      return UtxoTransactionBuilder.fromTransaction<TNumber>(tx, undefined, prevOutputs);\n    case networks.litecoin:\n      return LitecoinTransactionBuilder.fromTransaction<TNumber>(\n        tx as LitecoinTransaction<TNumber>,\n        undefined,\n        prevOutputs as TxOutput<TNumber>[]\n      );\n    case networks.dash:\n      return DashTransactionBuilder.fromTransaction<TNumber>(\n        tx as DashTransaction<TNumber>,\n        undefined,\n        prevOutputs as TxOutput<TNumber>[]\n      );\n    case networks.zcash:\n      return ZcashTransactionBuilder.fromTransaction<TNumber>(\n        tx as ZcashTransaction<TNumber>,\n        undefined,\n        prevOutputs as TxOutput<TNumber>[]\n      );\n  }\n\n  throw new Error(`invalid network`);\n}\n"]}