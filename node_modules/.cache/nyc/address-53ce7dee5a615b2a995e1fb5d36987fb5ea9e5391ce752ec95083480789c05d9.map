{"version":3,"file":"/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/zcash/address.ts","sources":["/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/zcash/address.ts"],"names":[],"mappings":";;AAQA,0CAKC;AAED,sCAOC;AAED,4CAgBC;AAED,wCAUC;AApDD,iCAAiC;AACjC,iDAAyC;AACzC,iDAAiD;AAEjD,6CAAkD;AAClD,MAAM,SAAS,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AACvC,MAAM,SAAS,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AAEvC,SAAgB,eAAe,CAAC,OAAe;IAC7C,MAAM,OAAO,GAAG,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;IAC1C,MAAM,OAAO,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;IACxC,MAAM,IAAI,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IAC9B,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;AAC3B,CAAC;AAED,SAAgB,aAAa,CAAC,IAAY,EAAE,OAAe;IACzD,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,UAAU,EAAE,KAAK,CAAC,MAAM,CAAC,EAAE,SAAS,CAAC,CAAC;IAElE,MAAM,OAAO,GAAG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;IACvC,OAAO,CAAC,aAAa,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;IAClC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;IACtB,OAAO,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;AACnC,CAAC;AAED,SAAgB,gBAAgB,CAAC,YAAoB,EAAE,OAAgB;IACrE,MAAM,CAAC,IAAA,kBAAO,EAAC,OAAO,CAAC,CAAC,CAAC;IACzB,IAAI,CAAC,CAAC;IACN,IAAI,MAAM,CAAC;IACX,IAAI,CAAC;QACH,CAAC,GAAG,wBAAQ,CAAC,KAAK,CAAC,EAAE,MAAM,EAAE,YAAY,EAAE,CAAC,CAAC;QAC7C,MAAM,GAAG,OAAO,CAAC,UAAU,CAAC;IAC9B,CAAC;IAAC,OAAO,CAAC,EAAE,CAAC,CAAA,CAAC;IACd,IAAI,CAAC;QACH,CAAC,GAAG,wBAAQ,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,YAAY,EAAE,CAAC,CAAC;QAC5C,MAAM,GAAG,OAAO,CAAC,UAAU,CAAC;IAC9B,CAAC;IAAC,OAAO,CAAC,EAAE,CAAC,CAAA,CAAC;IACd,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,IAAI,MAAM,KAAK,SAAS,EAAE,CAAC;QAC1C,MAAM,IAAI,KAAK,CAAC,0BAA0B,CAAC,CAAC;IAC9C,CAAC;IACD,OAAO,aAAa,CAAC,CAAC,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;AACvC,CAAC;AAED,SAAgB,cAAc,CAAC,OAAe,EAAE,OAAgB;IAC9D,MAAM,CAAC,IAAA,kBAAO,EAAC,OAAO,CAAC,CAAC,CAAC;IACzB,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,eAAe,CAAC,OAAO,CAAC,CAAC;IACnD,IAAI,OAAO,KAAK,OAAO,CAAC,UAAU,EAAE,CAAC;QACnC,OAAO,wBAAQ,CAAC,KAAK,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,MAAgB,CAAC;IACnD,CAAC;IACD,IAAI,OAAO,KAAK,OAAO,CAAC,UAAU,EAAE,CAAC;QACnC,OAAO,wBAAQ,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,MAAgB,CAAC;IAClD,CAAC;IACD,MAAM,IAAI,KAAK,CAAC,OAAO,GAAG,yBAAyB,CAAC,CAAC;AACvD,CAAC","sourcesContent":["import * as assert from 'assert';\nimport { payments } from 'bitcoinjs-lib';\nimport * as types from 'bitcoinjs-lib/src/types';\nimport { Base58CheckResult } from 'bitcoinjs-lib/src/address';\nimport { isZcash, Network } from '../../networks';\nconst bs58check = require('bs58check');\nconst typeforce = require('typeforce');\n\nexport function fromBase58Check(address: string): Base58CheckResult {\n  const payload = bs58check.decode(address);\n  const version = payload.readUInt16BE(0);\n  const hash = payload.slice(2);\n  return { version, hash };\n}\n\nexport function toBase58Check(hash: Buffer, version: number): string {\n  typeforce(types.tuple(types.Hash160bit, types.Number), arguments);\n\n  const payload = Buffer.allocUnsafe(22);\n  payload.writeUInt16BE(version, 0);\n  hash.copy(payload, 2);\n  return bs58check.encode(payload);\n}\n\nexport function fromOutputScript(outputScript: Buffer, network: Network): string {\n  assert(isZcash(network));\n  let o;\n  let prefix;\n  try {\n    o = payments.p2pkh({ output: outputScript });\n    prefix = network.pubKeyHash;\n  } catch (e) {}\n  try {\n    o = payments.p2sh({ output: outputScript });\n    prefix = network.scriptHash;\n  } catch (e) {}\n  if (!o || !o.hash || prefix === undefined) {\n    throw new Error(`unsupported outputScript`);\n  }\n  return toBase58Check(o.hash, prefix);\n}\n\nexport function toOutputScript(address: string, network: Network): Buffer {\n  assert(isZcash(network));\n  const { version, hash } = fromBase58Check(address);\n  if (version === network.pubKeyHash) {\n    return payments.p2pkh({ hash }).output as Buffer;\n  }\n  if (version === network.scriptHash) {\n    return payments.p2sh({ hash }).output as Buffer;\n  }\n  throw new Error(address + ' has no matching Script');\n}\n"]}