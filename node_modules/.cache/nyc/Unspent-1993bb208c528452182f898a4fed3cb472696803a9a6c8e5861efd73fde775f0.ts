"use strict";function cov_1wndu64ixp(){var path="/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/Unspent.ts";var hash="c84673331ea51aeb16c1334c11672f775e8d747f";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/Unspent.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:50}},"2":{start:{line:4,column:0},end:{line:4,column:28}},"3":{start:{line:5,column:0},end:{line:5,column:32}},"4":{start:{line:6,column:0},end:{line:6,column:52}},"5":{start:{line:7,column:0},end:{line:7,column:38}},"6":{start:{line:8,column:0},end:{line:8,column:40}},"7":{start:{line:9,column:0},end:{line:9,column:50}},"8":{start:{line:10,column:0},end:{line:10,column:36}},"9":{start:{line:11,column:0},end:{line:11,column:56}},"10":{start:{line:12,column:0},end:{line:12,column:58}},"11":{start:{line:13,column:0},end:{line:13,column:32}},"12":{start:{line:14,column:18},end:{line:14,column:39}},"13":{start:{line:16,column:4},end:{line:16,column:37}},"14":{start:{line:22,column:4},end:{line:25,column:6}},"15":{start:{line:31,column:14},end:{line:31,column:27}},"16":{start:{line:32,column:4},end:{line:34,column:5}},"17":{start:{line:33,column:8},end:{line:33,column:40}},"18":{start:{line:35,column:4},end:{line:39,column:6}},"19":{start:{line:42,column:4},end:{line:45,column:6}},"20":{start:{line:52,column:18},end:{line:52,column:37}},"21":{start:{line:53,column:4},end:{line:55,column:5}},"22":{start:{line:54,column:8},end:{line:54,column:72}},"23":{start:{line:56,column:28},end:{line:56,column:33}},"24":{start:{line:57,column:17},end:{line:57,column:32}},"25":{start:{line:58,column:4},end:{line:60,column:5}},"26":{start:{line:59,column:8},end:{line:59,column:63}},"27":{start:{line:61,column:4},end:{line:63,column:5}},"28":{start:{line:62,column:8},end:{line:62,column:62}},"29":{start:{line:64,column:4},end:{line:64,column:26}},"30":{start:{line:72,column:4},end:{line:72,column:29}},"31":{start:{line:75,column:4},end:{line:78,column:6}},"32":{start:{line:84,column:4},end:{line:87,column:6}},"33":{start:{line:94,column:4},end:{line:102,column:5}},"34":{start:{line:95,column:8},end:{line:95,column:46}},"35":{start:{line:97,column:9},end:{line:102,column:5}},"36":{start:{line:98,column:8},end:{line:98,column:26}},"37":{start:{line:100,column:9},end:{line:102,column:5}},"38":{start:{line:101,column:8},end:{line:101,column:71}},"39":{start:{line:103,column:4},end:{line:107,column:6}},"40":{start:{line:115,column:42},end:{line:115,column:70}},"41":{start:{line:116,column:4},end:{line:116,column:54}},"42":{start:{line:126,column:4},end:{line:135,column:5}},"43":{start:{line:127,column:8},end:{line:127,column:69}},"44":{start:{line:127,column:43},end:{line:127,column:56}},"45":{start:{line:130,column:20},end:{line:130,column:73}},"46":{start:{line:130,column:48},end:{line:130,column:61}},"47":{start:{line:131,column:8},end:{line:133,column:9}},"48":{start:{line:132,column:12},end:{line:132,column:95}},"49":{start:{line:134,column:8},end:{line:134,column:19}}},fnMap:{"0":{name:"isUnspentWithPrevTx",decl:{start:{line:15,column:9},end:{line:15,column:28}},loc:{start:{line:15,column:32},end:{line:17,column:1}},line:15},"1":{name:"toOutput",decl:{start:{line:21,column:9},end:{line:21,column:17}},loc:{start:{line:21,column:30},end:{line:26,column:1}},line:21},"2":{name:"fromOutput",decl:{start:{line:30,column:9},end:{line:30,column:19}},loc:{start:{line:30,column:30},end:{line:40,column:1}},line:30},"3":{name:"fromOutputWithPrevTx",decl:{start:{line:41,column:9},end:{line:41,column:29}},loc:{start:{line:41,column:40},end:{line:46,column:1}},line:41},"4":{name:"parseOutputId",decl:{start:{line:51,column:9},end:{line:51,column:22}},loc:{start:{line:51,column:33},end:{line:65,column:1}},line:51},"5":{name:"formatOutputId",decl:{start:{line:71,column:9},end:{line:71,column:23}},loc:{start:{line:71,column:40},end:{line:73,column:1}},line:71},"6":{name:"getOutputIdForInput",decl:{start:{line:74,column:9},end:{line:74,column:28}},loc:{start:{line:74,column:32},end:{line:79,column:1}},line:74},"7":{name:"toPrevOutput",decl:{start:{line:83,column:9},end:{line:83,column:21}},loc:{start:{line:83,column:34},end:{line:88,column:1}},line:83},"8":{name:"toPrevOutputWithPrevTx",decl:{start:{line:92,column:9},end:{line:92,column:31}},loc:{start:{line:92,column:44},end:{line:108,column:1}},line:92},"9":{name:"addToTransactionBuilder",decl:{start:{line:114,column:9},end:{line:114,column:32}},loc:{start:{line:114,column:51},end:{line:117,column:1}},line:114},"10":{name:"unspentSum",decl:{start:{line:125,column:9},end:{line:125,column:19}},loc:{start:{line:125,column:53},end:{line:136,column:1}},line:125},"11":{name:"(anonymous_11)",decl:{start:{line:127,column:31},end:{line:127,column:32}},loc:{start:{line:127,column:43},end:{line:127,column:56}},line:127},"12":{name:"(anonymous_12)",decl:{start:{line:130,column:36},end:{line:130,column:37}},loc:{start:{line:130,column:48},end:{line:130,column:61}},line:130}},branchMap:{"0":{loc:{start:{line:32,column:4},end:{line:34,column:5}},type:"if",locations:[{start:{line:32,column:4},end:{line:34,column:5}},{start:{line:32,column:4},end:{line:34,column:5}}],line:32},"1":{loc:{start:{line:53,column:4},end:{line:55,column:5}},type:"if",locations:[{start:{line:53,column:4},end:{line:55,column:5}},{start:{line:53,column:4},end:{line:55,column:5}}],line:53},"2":{loc:{start:{line:58,column:4},end:{line:60,column:5}},type:"if",locations:[{start:{line:58,column:4},end:{line:60,column:5}},{start:{line:58,column:4},end:{line:60,column:5}}],line:58},"3":{loc:{start:{line:61,column:4},end:{line:63,column:5}},type:"if",locations:[{start:{line:61,column:4},end:{line:63,column:5}},{start:{line:61,column:4},end:{line:63,column:5}}],line:61},"4":{loc:{start:{line:61,column:8},end:{line:61,column:69}},type:"binary-expr",locations:[{start:{line:61,column:8},end:{line:61,column:26}},{start:{line:61,column:30},end:{line:61,column:38}},{start:{line:61,column:42},end:{line:61,column:69}}],line:61},"5":{loc:{start:{line:94,column:4},end:{line:102,column:5}},type:"if",locations:[{start:{line:94,column:4},end:{line:102,column:5}},{start:{line:94,column:4},end:{line:102,column:5}}],line:94},"6":{loc:{start:{line:97,column:9},end:{line:102,column:5}},type:"if",locations:[{start:{line:97,column:9},end:{line:102,column:5}},{start:{line:97,column:9},end:{line:102,column:5}}],line:97},"7":{loc:{start:{line:100,column:9},end:{line:102,column:5}},type:"if",locations:[{start:{line:100,column:9},end:{line:102,column:5}},{start:{line:100,column:9},end:{line:102,column:5}}],line:100},"8":{loc:{start:{line:125,column:30},end:{line:125,column:51}},type:"default-arg",locations:[{start:{line:125,column:43},end:{line:125,column:51}}],line:125},"9":{loc:{start:{line:126,column:4},end:{line:135,column:5}},type:"if",locations:[{start:{line:126,column:4},end:{line:135,column:5}},{start:{line:126,column:4},end:{line:135,column:5}}],line:126},"10":{loc:{start:{line:131,column:8},end:{line:133,column:9}},type:"if",locations:[{start:{line:131,column:8},end:{line:133,column:9}},{start:{line:131,column:8},end:{line:133,column:9}}],line:131}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0],"9":[0,0],"10":[0,0]},inputSourceMap:{version:3,file:"/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/Unspent.ts",sources:["/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/Unspent.ts"],names:[],mappings:"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",sourcesContent:["import { TxOutput } from 'bitcoinjs-lib';\nimport { Network } from '..';\nimport { fromOutputScript, toOutputScript } from '../address';\nimport { UtxoTransactionBuilder } from './UtxoTransactionBuilder';\nimport { UtxoTransaction } from './UtxoTransaction';\n\n/**\n * Public unspent data in BitGo-specific representation.\n */\nexport interface Unspent<TNumber extends number | bigint = number> {\n  /**\n   * Format: ${txid}:${vout}.\n   * Use `parseOutputId(id)` to parse.\n   */\n  id: string;\n  /**\n   * The network-specific encoded address.\n   * Use `toOutputScript(address, network)` to obtain scriptPubKey.\n   */\n  address: string;\n  /**\n   * The amount in satoshi.\n   */\n  value: TNumber;\n}\n\nexport interface UnspentWithPrevTx<TNumber extends number | bigint = number> extends Unspent<TNumber> {\n  prevTx: Buffer;\n}\n\nexport function isUnspentWithPrevTx<TNumber extends number | bigint, TUnspent extends Unspent<TNumber>>(\n  u: Unspent<TNumber>\n): u is TUnspent & { prevTx: Buffer } {\n  return Buffer.isBuffer((u as UnspentWithPrevTx<TNumber>).prevTx);\n}\n\n/**\n * @return TxOutput from Unspent\n */\nexport function toOutput<TNumber extends number | bigint>(u: Unspent<TNumber>, network: Network): TxOutput<TNumber> {\n  return {\n    script: toOutputScript(u.address, network),\n    value: u.value,\n  };\n}\n\n/**\n * @return Unspent from TxOutput\n */\nexport function fromOutput<TNumber extends number | bigint>(\n  tx: UtxoTransaction<TNumber>,\n  vout: number\n): Unspent<TNumber> {\n  const o = tx.outs[vout];\n  if (!o) {\n    throw new Error(`invalid vout`);\n  }\n  return {\n    id: formatOutputId({ txid: tx.getId(), vout }),\n    address: fromOutputScript(o.script, tx.network),\n    value: o.value,\n  };\n}\n\nexport function fromOutputWithPrevTx<TNumber extends number | bigint>(\n  tx: UtxoTransaction<TNumber>,\n  vout: number\n): UnspentWithPrevTx<TNumber> {\n  return {\n    ...fromOutput(tx, vout),\n    prevTx: tx.toBuffer(),\n  };\n}\n\n/**\n * @param outputId\n * @return TxOutPoint\n */\nexport function parseOutputId(outputId: string): TxOutPoint {\n  const parts = outputId.split(':');\n  if (parts.length !== 2) {\n    throw new Error(`invalid outputId, must have format txid:vout`);\n  }\n  const [txid, voutStr] = parts;\n  const vout = Number(voutStr);\n  if (txid.length !== 64) {\n    throw new Error(`invalid txid ${txid} ${txid.length}`);\n  }\n  if (Number.isNaN(vout) || vout < 0 || !Number.isSafeInteger(vout)) {\n    throw new Error(`invalid vout: must be integer >= 0`);\n  }\n  return { txid, vout };\n}\n\n/**\n * @param txid\n * @param vout\n * @return outputId\n */\nexport function formatOutputId({ txid, vout }: TxOutPoint): string {\n  return `${txid}:${vout}`;\n}\n\nexport function getOutputIdForInput(i: { hash: Buffer; index: number }): TxOutPoint {\n  return {\n    txid: Buffer.from(i.hash).reverse().toString('hex'),\n    vout: i.index,\n  };\n}\n\n/**\n * Reference to output of an existing transaction\n */\nexport type TxOutPoint = {\n  txid: string;\n  vout: number;\n};\n\n/**\n * Output reference and script data.\n * Suitable for use for `txb.addInput()`\n */\nexport type PrevOutput<TNumber extends number | bigint = number> = TxOutPoint &\n  TxOutput<TNumber> & {\n    prevTx?: Buffer;\n  };\n\n/**\n * @return PrevOutput from Unspent\n */\nexport function toPrevOutput<TNumber extends number | bigint>(\n  u: Unspent<TNumber>,\n  network: Network\n): PrevOutput<TNumber> {\n  return {\n    ...parseOutputId(u.id),\n    ...toOutput(u, network),\n  };\n}\n\n/**\n * @return PrevOutput with prevTx from Unspent\n */\nexport function toPrevOutputWithPrevTx<TNumber extends number | bigint>(\n  u: Unspent<TNumber> & { prevTx?: unknown },\n  network: Network\n): PrevOutput<TNumber> {\n  let prevTx;\n  if (typeof u.prevTx === 'string') {\n    prevTx = Buffer.from(u.prevTx, 'hex');\n  } else if (Buffer.isBuffer(u.prevTx)) {\n    prevTx = u.prevTx;\n  } else if (u.prevTx !== undefined) {\n    throw new Error(`Invalid prevTx type for unspent ${u.prevTx}`);\n  }\n  return {\n    ...parseOutputId(u.id),\n    ...toOutput(u, network),\n    prevTx,\n  };\n}\n\n/**\n * @param txb\n * @param u\n * @param sequence - sequenceId\n */\nexport function addToTransactionBuilder<TNumber extends number | bigint>(\n  txb: UtxoTransactionBuilder<TNumber>,\n  u: Unspent<TNumber>,\n  sequence?: number\n): void {\n  const { txid, vout, script, value } = toPrevOutput(u, txb.network as Network);\n  txb.addInput(txid, vout, sequence, script, value);\n}\n\n/**\n * Sum the values of the unspents.\n * Throws error if sum is not a safe integer value, or if unspent amount types do not match `amountType`\n * @param unspents - array of unspents to sum\n * @param amountType - expected value type of unspents\n * @return unspentSum - type matches amountType\n */\nexport function unspentSum<TNumber extends number | bigint>(\n  unspents: { value: TNumber }[],\n  amountType: 'number' | 'bigint' = 'number'\n): TNumber {\n  if (amountType === 'bigint') {\n    return unspents.reduce((sum, u) => sum + (u.value as bigint), BigInt(0)) as TNumber;\n  } else {\n    const sum = unspents.reduce((sum, u) => sum + (u.value as number), Number(0));\n    if (!Number.isSafeInteger(sum)) {\n      throw new Error('unspent sum is not a safe integer number, consider using bigint');\n    }\n    return sum as TNumber;\n  }\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c84673331ea51aeb16c1334c11672f775e8d747f"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1wndu64ixp=function(){return actualCoverage;};}return actualCoverage;}cov_1wndu64ixp();cov_1wndu64ixp().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_1wndu64ixp().s[1]++;exports.isUnspentWithPrevTx=isUnspentWithPrevTx;cov_1wndu64ixp().s[2]++;exports.toOutput=toOutput;cov_1wndu64ixp().s[3]++;exports.fromOutput=fromOutput;cov_1wndu64ixp().s[4]++;exports.fromOutputWithPrevTx=fromOutputWithPrevTx;cov_1wndu64ixp().s[5]++;exports.parseOutputId=parseOutputId;cov_1wndu64ixp().s[6]++;exports.formatOutputId=formatOutputId;cov_1wndu64ixp().s[7]++;exports.getOutputIdForInput=getOutputIdForInput;cov_1wndu64ixp().s[8]++;exports.toPrevOutput=toPrevOutput;cov_1wndu64ixp().s[9]++;exports.toPrevOutputWithPrevTx=toPrevOutputWithPrevTx;cov_1wndu64ixp().s[10]++;exports.addToTransactionBuilder=addToTransactionBuilder;cov_1wndu64ixp().s[11]++;exports.unspentSum=unspentSum;const address_1=(cov_1wndu64ixp().s[12]++,require("../address"));function isUnspentWithPrevTx(u){cov_1wndu64ixp().f[0]++;cov_1wndu64ixp().s[13]++;return Buffer.isBuffer(u.prevTx);}/**
 * @return TxOutput from Unspent
 */function toOutput(u,network){cov_1wndu64ixp().f[1]++;cov_1wndu64ixp().s[14]++;return{script:(0,address_1.toOutputScript)(u.address,network),value:u.value};}/**
 * @return Unspent from TxOutput
 */function fromOutput(tx,vout){cov_1wndu64ixp().f[2]++;const o=(cov_1wndu64ixp().s[15]++,tx.outs[vout]);cov_1wndu64ixp().s[16]++;if(!o){cov_1wndu64ixp().b[0][0]++;cov_1wndu64ixp().s[17]++;throw new Error(`invalid vout`);}else{cov_1wndu64ixp().b[0][1]++;}cov_1wndu64ixp().s[18]++;return{id:formatOutputId({txid:tx.getId(),vout}),address:(0,address_1.fromOutputScript)(o.script,tx.network),value:o.value};}function fromOutputWithPrevTx(tx,vout){cov_1wndu64ixp().f[3]++;cov_1wndu64ixp().s[19]++;return{...fromOutput(tx,vout),prevTx:tx.toBuffer()};}/**
 * @param outputId
 * @return TxOutPoint
 */function parseOutputId(outputId){cov_1wndu64ixp().f[4]++;const parts=(cov_1wndu64ixp().s[20]++,outputId.split(':'));cov_1wndu64ixp().s[21]++;if(parts.length!==2){cov_1wndu64ixp().b[1][0]++;cov_1wndu64ixp().s[22]++;throw new Error(`invalid outputId, must have format txid:vout`);}else{cov_1wndu64ixp().b[1][1]++;}const[txid,voutStr]=(cov_1wndu64ixp().s[23]++,parts);const vout=(cov_1wndu64ixp().s[24]++,Number(voutStr));cov_1wndu64ixp().s[25]++;if(txid.length!==64){cov_1wndu64ixp().b[2][0]++;cov_1wndu64ixp().s[26]++;throw new Error(`invalid txid ${txid} ${txid.length}`);}else{cov_1wndu64ixp().b[2][1]++;}cov_1wndu64ixp().s[27]++;if((cov_1wndu64ixp().b[4][0]++,Number.isNaN(vout))||(cov_1wndu64ixp().b[4][1]++,vout<0)||(cov_1wndu64ixp().b[4][2]++,!Number.isSafeInteger(vout))){cov_1wndu64ixp().b[3][0]++;cov_1wndu64ixp().s[28]++;throw new Error(`invalid vout: must be integer >= 0`);}else{cov_1wndu64ixp().b[3][1]++;}cov_1wndu64ixp().s[29]++;return{txid,vout};}/**
 * @param txid
 * @param vout
 * @return outputId
 */function formatOutputId({txid,vout}){cov_1wndu64ixp().f[5]++;cov_1wndu64ixp().s[30]++;return`${txid}:${vout}`;}function getOutputIdForInput(i){cov_1wndu64ixp().f[6]++;cov_1wndu64ixp().s[31]++;return{txid:Buffer.from(i.hash).reverse().toString('hex'),vout:i.index};}/**
 * @return PrevOutput from Unspent
 */function toPrevOutput(u,network){cov_1wndu64ixp().f[7]++;cov_1wndu64ixp().s[32]++;return{...parseOutputId(u.id),...toOutput(u,network)};}/**
 * @return PrevOutput with prevTx from Unspent
 */function toPrevOutputWithPrevTx(u,network){cov_1wndu64ixp().f[8]++;let prevTx;cov_1wndu64ixp().s[33]++;if(typeof u.prevTx==='string'){cov_1wndu64ixp().b[5][0]++;cov_1wndu64ixp().s[34]++;prevTx=Buffer.from(u.prevTx,'hex');}else{cov_1wndu64ixp().b[5][1]++;cov_1wndu64ixp().s[35]++;if(Buffer.isBuffer(u.prevTx)){cov_1wndu64ixp().b[6][0]++;cov_1wndu64ixp().s[36]++;prevTx=u.prevTx;}else{cov_1wndu64ixp().b[6][1]++;cov_1wndu64ixp().s[37]++;if(u.prevTx!==undefined){cov_1wndu64ixp().b[7][0]++;cov_1wndu64ixp().s[38]++;throw new Error(`Invalid prevTx type for unspent ${u.prevTx}`);}else{cov_1wndu64ixp().b[7][1]++;}}}cov_1wndu64ixp().s[39]++;return{...parseOutputId(u.id),...toOutput(u,network),prevTx};}/**
 * @param txb
 * @param u
 * @param sequence - sequenceId
 */function addToTransactionBuilder(txb,u,sequence){cov_1wndu64ixp().f[9]++;const{txid,vout,script,value}=(cov_1wndu64ixp().s[40]++,toPrevOutput(u,txb.network));cov_1wndu64ixp().s[41]++;txb.addInput(txid,vout,sequence,script,value);}/**
 * Sum the values of the unspents.
 * Throws error if sum is not a safe integer value, or if unspent amount types do not match `amountType`
 * @param unspents - array of unspents to sum
 * @param amountType - expected value type of unspents
 * @return unspentSum - type matches amountType
 */function unspentSum(unspents,amountType=(cov_1wndu64ixp().b[8][0]++,'number')){cov_1wndu64ixp().f[10]++;cov_1wndu64ixp().s[42]++;if(amountType==='bigint'){cov_1wndu64ixp().b[9][0]++;cov_1wndu64ixp().s[43]++;return unspents.reduce((sum,u)=>{cov_1wndu64ixp().f[11]++;cov_1wndu64ixp().s[44]++;return sum+u.value;},BigInt(0));}else{cov_1wndu64ixp().b[9][1]++;const sum=(cov_1wndu64ixp().s[45]++,unspents.reduce((sum,u)=>{cov_1wndu64ixp().f[12]++;cov_1wndu64ixp().s[46]++;return sum+u.value;},Number(0)));cov_1wndu64ixp().s[47]++;if(!Number.isSafeInteger(sum)){cov_1wndu64ixp().b[10][0]++;cov_1wndu64ixp().s[48]++;throw new Error('unspent sum is not a safe integer number, consider using bigint');}else{cov_1wndu64ixp().b[10][1]++;}cov_1wndu64ixp().s[49]++;return sum;}}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3Fyb2MvQ29kZS9oYXBpL2NoYWluZGVmdXNlci91dHhvLWxpYi9zcmMvYml0Z28vVW5zcGVudC50cyIsInNvdXJjZXMiOlsiL1VzZXJzL3Fyb2MvQ29kZS9oYXBpL2NoYWluZGVmdXNlci91dHhvLWxpYi9zcmMvYml0Z28vVW5zcGVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQThCQSxrREFJQztBQUtELDRCQUtDO0FBS0QsZ0NBYUM7QUFFRCxvREFRQztBQU1ELHNDQWNDO0FBT0Qsd0NBRUM7QUFFRCxrREFLQztBQXNCRCxvQ0FRQztBQUtELHdEQWlCQztBQU9ELDBEQU9DO0FBU0QsZ0NBYUM7QUFsTUQsd0NBQThEO0FBNEI5RCxTQUFnQixtQkFBbUIsQ0FDakMsQ0FBbUI7SUFFbkIsT0FBTyxNQUFNLENBQUMsUUFBUSxDQUFFLENBQWdDLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDbkUsQ0FBQztBQUVEOztHQUVHO0FBQ0gsU0FBZ0IsUUFBUSxDQUFrQyxDQUFtQixFQUFFLE9BQWdCO0lBQzdGLE9BQU87UUFDTCxNQUFNLEVBQUUsSUFBQSx3QkFBYyxFQUFDLENBQUMsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDO1FBQzFDLEtBQUssRUFBRSxDQUFDLENBQUMsS0FBSztLQUNmLENBQUM7QUFDSixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFnQixVQUFVLENBQ3hCLEVBQTRCLEVBQzVCLElBQVk7SUFFWixNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3hCLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUNQLE1BQU0sSUFBSSxLQUFLLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDbEMsQ0FBQztJQUNELE9BQU87UUFDTCxFQUFFLEVBQUUsY0FBYyxDQUFDLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsQ0FBQztRQUM5QyxPQUFPLEVBQUUsSUFBQSww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InNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFR4T3V0cHV0IH0gZnJvbSAnYml0Y29pbmpzLWxpYic7XG5pbXBvcnQgeyBOZXR3b3JrIH0gZnJvbSAnLi4nO1xuaW1wb3J0IHsgZnJvbU91dHB1dFNjcmlwdCwgdG9PdXRwdXRTY3JpcHQgfSBmcm9tICcuLi9hZGRyZXNzJztcbmltcG9ydCB7IFV0eG9UcmFuc2FjdGlvbkJ1aWxkZXIgfSBmcm9tICcuL1V0eG9UcmFuc2FjdGlvbkJ1aWxkZXInO1xuaW1wb3J0IHsgVXR4b1RyYW5zYWN0aW9uIH0gZnJvbSAnLi9VdHhvVHJhbnNhY3Rpb24nO1xuXG4vKipcbiAqIFB1YmxpYyB1bnNwZW50IGRhdGEgaW4gQml0R28tc3BlY2lmaWMgcmVwcmVzZW50YXRpb24uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVW5zcGVudDxUTnVtYmVyIGV4dGVuZHMgbnVtYmVyIHwgYmlnaW50ID0gbnVtYmVyPiB7XG4gIC8qKlxuICAgKiBGb3JtYXQ6ICR7dHhpZH06JHt2b3V0fS5cbiAgICogVXNlIGBwYXJzZU91dHB1dElkKGlkKWAgdG8gcGFyc2UuXG4gICAqL1xuICBpZDogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIG5ldHdvcmstc3BlY2lmaWMgZW5jb2RlZCBhZGRyZXNzLlxuICAgKiBVc2UgYHRvT3V0cHV0U2NyaXB0KGFkZHJlc3MsIG5ldHdvcmspYCB0byBvYnRhaW4gc2NyaXB0UHViS2V5LlxuICAgKi9cbiAgYWRkcmVzczogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIGFtb3VudCBpbiBzYXRvc2hpLlxuICAgKi9cbiAgdmFsdWU6IFROdW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVW5zcGVudFdpdGhQcmV2VHg8VE51bWJlciBleHRlbmRzIG51bWJlciB8IGJpZ2ludCA9IG51bWJlcj4gZXh0ZW5kcyBVbnNwZW50PFROdW1iZXI+IHtcbiAgcHJldlR4OiBCdWZmZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1Vuc3BlbnRXaXRoUHJldlR4PFROdW1iZXIgZXh0ZW5kcyBudW1iZXIgfCBiaWdpbnQsIFRVbnNwZW50IGV4dGVuZHMgVW5zcGVudDxUTnVtYmVyPj4oXG4gIHU6IFVuc3BlbnQ8VE51bWJlcj5cbik6IHUgaXMgVFVuc3BlbnQgJiB7IHByZXZUeDogQnVmZmVyIH0ge1xuICByZXR1cm4gQnVmZmVyLmlzQnVmZmVyKCh1IGFzIFVuc3BlbnRXaXRoUHJldlR4PFROdW1iZXI+KS5wcmV2VHgpO1xufVxuXG4vKipcbiAqIEByZXR1cm4gVHhPdXRwdXQgZnJvbSBVbnNwZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b091dHB1dDxUTnVtYmVyIGV4dGVuZHMgbnVtYmVyIHwgYmlnaW50Pih1OiBVbnNwZW50PFROdW1iZXI+LCBuZXR3b3JrOiBOZXR3b3JrKTogVHhPdXRwdXQ8VE51bWJlcj4ge1xuICByZXR1cm4ge1xuICAgIHNjcmlwdDogdG9PdXRwdXRTY3JpcHQodS5hZGRyZXNzLCBuZXR3b3JrKSxcbiAgICB2YWx1ZTogdS52YWx1ZSxcbiAgfTtcbn1cblxuLyoqXG4gKiBAcmV0dXJuIFVuc3BlbnQgZnJvbSBUeE91dHB1dFxuICovXG5leHBvcnQgZnVuY3Rpb24gZnJvbU91dHB1dDxUTnVtYmVyIGV4dGVuZHMgbnVtYmVyIHwgYmlnaW50PihcbiAgdHg6IFV0eG9UcmFuc2FjdGlvbjxUTnVtYmVyPixcbiAgdm91dDogbnVtYmVyXG4pOiBVbnNwZW50PFROdW1iZXI+IHtcbiAgY29uc3QgbyA9IHR4Lm91dHNbdm91dF07XG4gIGlmICghbykge1xuICAgIHRocm93IG5ldyBFcnJvcihgaW52YWxpZCB2b3V0YCk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBpZDogZm9ybWF0T3V0cHV0SWQoeyB0eGlkOiB0eC5nZXRJZCgpLCB2b3V0IH0pLFxuICAgIGFkZHJlc3M6IGZyb21PdXRwdXRTY3JpcHQoby5zY3JpcHQsIHR4Lm5ldHdvcmspLFxuICAgIHZhbHVlOiBvLnZhbHVlLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZnJvbU91dHB1dFdpdGhQcmV2VHg8VE51bWJlciBleHRlbmRzIG51bWJlciB8IGJpZ2ludD4oXG4gIHR4OiBVdHhvVHJhbnNhY3Rpb248VE51bWJlcj4sXG4gIHZvdXQ6IG51bWJlclxuKTogVW5zcGVudFdpdGhQcmV2VHg8VE51bWJlcj4ge1xuICByZXR1cm4ge1xuICAgIC4uLmZyb21PdXRwdXQodHgsIHZvdXQpLFxuICAgIHByZXZUeDogdHgudG9CdWZmZXIoKSxcbiAgfTtcbn1cblxuLyoqXG4gKiBAcGFyYW0gb3V0cHV0SWRcbiAqIEByZXR1cm4gVHhPdXRQb2ludFxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VPdXRwdXRJZChvdXRwdXRJZDogc3RyaW5nKTogVHhPdXRQb2ludCB7XG4gIGNvbnN0IHBhcnRzID0gb3V0cHV0SWQuc3BsaXQoJzonKTtcbiAgaWYgKHBhcnRzLmxlbmd0aCAhPT0gMikge1xuICAgIHRocm93IG5ldyBFcnJvcihgaW52YWxpZCBvdXRwdXRJZCwgbXVzdCBoYXZlIGZvcm1hdCB0eGlkOnZvdXRgKTtcbiAgfVxuICBjb25zdCBbdHhpZCwgdm91dFN0cl0gPSBwYXJ0cztcbiAgY29uc3Qgdm91dCA9IE51bWJlcih2b3V0U3RyKTtcbiAgaWYgKHR4aWQubGVuZ3RoICE9PSA2NCkge1xuICAgIHRocm93IG5ldyBFcnJvcihgaW52YWxpZCB0eGlkICR7dHhpZH0gJHt0eGlkLmxlbmd0aH1gKTtcbiAgfVxuICBpZiAoTnVtYmVyLmlzTmFOKHZvdXQpIHx8IHZvdXQgPCAwIHx8ICFOdW1iZXIuaXNTYWZlSW50ZWdlcih2b3V0KSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgaW52YWxpZCB2b3V0OiBtdXN0IGJlIGludGVnZXIgPj0gMGApO1xuICB9XG4gIHJldHVybiB7IHR4aWQsIHZvdXQgfTtcbn1cblxuLyoqXG4gKiBAcGFyYW0gdHhpZFxuICogQHBhcmFtIHZvdXRcbiAqIEByZXR1cm4gb3V0cHV0SWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdE91dHB1dElkKHsgdHhpZCwgdm91dCB9OiBUeE91dFBvaW50KTogc3RyaW5nIHtcbiAgcmV0dXJuIGAke3R4aWR9OiR7dm91dH1gO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0T3V0cHV0SWRGb3JJbnB1dChpOiB7IGhhc2g6IEJ1ZmZlcjsgaW5kZXg6IG51bWJlciB9KTogVHhPdXRQb2ludCB7XG4gIHJldHVybiB7XG4gICAgdHhpZDogQnVmZmVyLmZyb20oaS5oYXNoKS5yZXZlcnNlKCkudG9TdHJpbmcoJ2hleCcpLFxuICAgIHZvdXQ6IGkuaW5kZXgsXG4gIH07XG59XG5cbi8qKlxuICogUmVmZXJlbmNlIHRvIG91dHB1dCBvZiBhbiBleGlzdGluZyB0cmFuc2FjdGlvblxuICovXG5leHBvcnQgdHlwZSBUeE91dFBvaW50ID0ge1xuICB0eGlkOiBzdHJpbmc7XG4gIHZvdXQ6IG51bWJlcjtcbn07XG5cbi8qKlxuICogT3V0cHV0IHJlZmVyZW5jZSBhbmQgc2NyaXB0IGRhdGEuXG4gKiBTdWl0YWJsZSBmb3IgdXNlIGZvciBgdHhiLmFkZElucHV0KClgXG4gKi9cbmV4cG9ydCB0eXBlIFByZXZPdXRwdXQ8VE51bWJlciBleHRlbmRzIG51bWJlciB8IGJpZ2ludCA9IG51bWJlcj4gPSBUeE91dFBvaW50ICZcbiAgVHhPdXRwdXQ8VE51bWJlcj4gJiB7XG4gICAgcHJldlR4PzogQnVmZmVyO1xuICB9O1xuXG4vKipcbiAqIEByZXR1cm4gUHJldk91dHB1dCBmcm9tIFVuc3BlbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvUHJldk91dHB1dDxUTnVtYmVyIGV4dGVuZHMgbnVtYmVyIHwgYmlnaW50PihcbiAgdTogVW5zcGVudDxUTnVtYmVyPixcbiAgbmV0d29yazogTmV0d29ya1xuKTogUHJldk91dHB1dDxUTnVtYmVyPiB7XG4gIHJldHVybiB7XG4gICAgLi4ucGFyc2VPdXRwdXRJZCh1LmlkKSxcbiAgICAuLi50b091dHB1dCh1LCBuZXR3b3JrKSxcbiAgfTtcbn1cblxuLyoqXG4gKiBAcmV0dXJuIFByZXZPdXRwdXQgd2l0aCBwcmV2VHggZnJvbSBVbnNwZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b1ByZXZPdXRwdXRXaXRoUHJldlR4PFROdW1iZXIgZXh0ZW5kcyBudW1iZXIgfCBiaWdpbnQ+KFxuICB1OiBVbnNwZW50PFROdW1iZXI+ICYgeyBwcmV2VHg/OiB1bmtub3duIH0sXG4gIG5ldHdvcms6IE5ldHdvcmtcbik6IFByZXZPdXRwdXQ8VE51bWJlcj4ge1xuICBsZXQgcHJldlR4O1xuICBpZiAodHlwZW9mIHUucHJldlR4ID09PSAnc3RyaW5nJykge1xuICAgIHByZXZUeCA9IEJ1ZmZlci5mcm9tKHUucHJldlR4LCAnaGV4Jyk7XG4gIH0gZWxzZSBpZiAoQnVmZmVyLmlzQnVmZmVyKHUucHJldlR4KSkge1xuICAgIHByZXZUeCA9IHUucHJldlR4O1xuICB9IGVsc2UgaWYgKHUucHJldlR4ICE9PSB1bmRlZmluZWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgcHJldlR4IHR5cGUgZm9yIHVuc3BlbnQgJHt1LnByZXZUeH1gKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIC4uLnBhcnNlT3V0cHV0SWQodS5pZCksXG4gICAgLi4udG9PdXRwdXQodSwgbmV0d29yayksXG4gICAgcHJldlR4LFxuICB9O1xufVxuXG4vKipcbiAqIEBwYXJhbSB0eGJcbiAqIEBwYXJhbSB1XG4gKiBAcGFyYW0gc2VxdWVuY2UgLSBzZXF1ZW5jZUlkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGRUb1RyYW5zYWN0aW9uQnVpbGRlcjxUTnVtYmVyIGV4dGVuZHMgbnVtYmVyIHwgYmlnaW50PihcbiAgdHhiOiBVdHhvVHJhbnNhY3Rpb25CdWlsZGVyPFROdW1iZXI+LFxuICB1OiBVbnNwZW50PFROdW1iZXI+LFxuICBzZXF1ZW5jZT86IG51bWJlclxuKTogdm9pZCB7XG4gIGNvbnN0IHsgdHhpZCwgdm91dCwgc2NyaXB0LCB2YWx1ZSB9ID0gdG9QcmV2T3V0cHV0KHUsIHR4Yi5uZXR3b3JrIGFzIE5ldHdvcmspO1xuICB0eGIuYWRkSW5wdXQodHhpZCwgdm91dCwgc2VxdWVuY2UsIHNjcmlwdCwgdmFsdWUpO1xufVxuXG4vKipcbiAqIFN1bSB0aGUgdmFsdWVzIG9mIHRoZSB1bnNwZW50cy5cbiAqIFRocm93cyBlcnJvciBpZiBzdW0gaXMgbm90IGEgc2FmZSBpbnRlZ2VyIHZhbHVlLCBvciBpZiB1bnNwZW50IGFtb3VudCB0eXBlcyBkbyBub3QgbWF0Y2ggYGFtb3VudFR5cGVgXG4gKiBAcGFyYW0gdW5zcGVudHMgLSBhcnJheSBvZiB1bnNwZW50cyB0byBzdW1cbiAqIEBwYXJhbSBhbW91bnRUeXBlIC0gZXhwZWN0ZWQgdmFsdWUgdHlwZSBvZiB1bnNwZW50c1xuICogQHJldHVybiB1bnNwZW50U3VtIC0gdHlwZSBtYXRjaGVzIGFtb3VudFR5cGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVuc3BlbnRTdW08VE51bWJlciBleHRlbmRzIG51bWJlciB8IGJpZ2ludD4oXG4gIHVuc3BlbnRzOiB7IHZhbHVlOiBUTnVtYmVyIH1bXSxcbiAgYW1vdW50VHlwZTogJ251bWJlcicgfCAnYmlnaW50JyA9ICdudW1iZXInXG4pOiBUTnVtYmVyIHtcbiAgaWYgKGFtb3VudFR5cGUgPT09ICdiaWdpbnQnKSB7XG4gICAgcmV0dXJuIHVuc3BlbnRzLnJlZHVjZSgoc3VtLCB1KSA9PiBzdW0gKyAodS52YWx1ZSBhcyBiaWdpbnQpLCBCaWdJbnQoMCkpIGFzIFROdW1iZXI7XG4gIH0gZWxzZSB7XG4gICAgY29uc3Qgc3VtID0gdW5zcGVudHMucmVkdWNlKChzdW0sIHUpID0+IHN1bSArICh1LnZhbHVlIGFzIG51bWJlciksIE51bWJlcigwKSk7XG4gICAgaWYgKCFOdW1iZXIuaXNTYWZlSW50ZWdlcihzdW0pKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3Vuc3BlbnQgc3VtIGlzIG5vdCBhIHNhZmUgaW50ZWdlciBudW1iZXIsIGNvbnNpZGVyIHVzaW5nIGJpZ2ludCcpO1xuICAgIH1cbiAgICByZXR1cm4gc3VtIGFzIFROdW1iZXI7XG4gIH1cbn1cbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMXduZHU2NGl4cCIsImFjdHVhbENvdmVyYWdlIiwicyIsImV4cG9ydHMiLCJpc1Vuc3BlbnRXaXRoUHJldlR4IiwidG9PdXRwdXQiLCJmcm9tT3V0cHV0IiwiZnJvbU91dHB1dFdpdGhQcmV2VHgiLCJwYXJzZU91dHB1dElkIiwiZm9ybWF0T3V0cHV0SWQiLCJnZXRPdXRwdXRJZEZvcklucHV0IiwidG9QcmV2T3V0cHV0IiwidG9QcmV2T3V0cHV0V2l0aFByZXZUeCIsImFkZFRvVHJhbnNhY3Rpb25CdWlsZGVyIiwidW5zcGVudFN1bSIsImFkZHJlc3NfMSIsInJlcXVpcmUiLCJ1IiwiZiIsIkJ1ZmZlciIsImlzQnVmZmVyIiwicHJldlR4IiwibmV0d29yayIsInNjcmlwdCIsInRvT3V0cHV0U2NyaXB0IiwiYWRkcmVzcyIsInZhbHVlIiwidHgiLCJ2b3V0IiwibyIsIm91dHMiLCJiIiwiRXJyb3IiLCJpZCIsInR4aWQiLCJnZXRJZCIsImZyb21PdXRwdXRTY3JpcHQiLCJ0b0J1ZmZlciIsIm91dHB1dElkIiwicGFydHMiLCJzcGxpdCIsImxlbmd0aCIsInZvdXRTdHIiLCJOdW1iZXIiLCJpc05hTiIsImlzU2FmZUludGVnZXIiLCJpIiwiZnJvbSIsImhhc2giLCJyZXZlcnNlIiwidG9TdHJpbmciLCJpbmRleCIsInVuZGVmaW5lZCIsInR4YiIsInNlcXVlbmNlIiwiYWRkSW5wdXQiLCJ1bnNwZW50cyIsImFtb3VudFR5cGUiLCJyZWR1Y2UiLCJzdW0iLCJCaWdJbnQiXSwic291cmNlcyI6WyIvVXNlcnMvcXJvYy9Db2RlL2hhcGkvY2hhaW5kZWZ1c2VyL3V0eG8tbGliL3NyYy9iaXRnby9VbnNwZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFR4T3V0cHV0IH0gZnJvbSAnYml0Y29pbmpzLWxpYic7XG5pbXBvcnQgeyBOZXR3b3JrIH0gZnJvbSAnLi4nO1xuaW1wb3J0IHsgZnJvbU91dHB1dFNjcmlwdCwgdG9PdXRwdXRTY3JpcHQgfSBmcm9tICcuLi9hZGRyZXNzJztcbmltcG9ydCB7IFV0eG9UcmFuc2FjdGlvbkJ1aWxkZXIgfSBmcm9tICcuL1V0eG9UcmFuc2FjdGlvbkJ1aWxkZXInO1xuaW1wb3J0IHsgVXR4b1RyYW5zYWN0aW9uIH0gZnJvbSAnLi9VdHhvVHJhbnNhY3Rpb24nO1xuXG4vKipcbiAqIFB1YmxpYyB1bnNwZW50IGRhdGEgaW4gQml0R28tc3BlY2lmaWMgcmVwcmVzZW50YXRpb24uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVW5zcGVudDxUTnVtYmVyIGV4dGVuZHMgbnVtYmVyIHwgYmlnaW50ID0gbnVtYmVyPiB7XG4gIC8qKlxuICAgKiBGb3JtYXQ6ICR7dHhpZH06JHt2b3V0fS5cbiAgICogVXNlIGBwYXJzZU91dHB1dElkKGlkKWAgdG8gcGFyc2UuXG4gICAqL1xuICBpZDogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIG5ldHdvcmstc3BlY2lmaWMgZW5jb2RlZCBhZGRyZXNzLlxuICAgKiBVc2UgYHRvT3V0cHV0U2NyaXB0KGFkZHJlc3MsIG5ldHdvcmspYCB0byBvYnRhaW4gc2NyaXB0UHViS2V5LlxuICAgKi9cbiAgYWRkcmVzczogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIGFtb3VudCBpbiBzYXRvc2hpLlxuICAgKi9cbiAgdmFsdWU6IFROdW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVW5zcGVudFdpdGhQcmV2VHg8VE51bWJlciBleHRlbmRzIG51bWJlciB8IGJpZ2ludCA9IG51bWJlcj4gZXh0ZW5kcyBVbnNwZW50PFROdW1iZXI+IHtcbiAgcHJldlR4OiBCdWZmZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1Vuc3BlbnRXaXRoUHJldlR4PFROdW1iZXIgZXh0ZW5kcyBudW1iZXIgfCBiaWdpbnQsIFRVbnNwZW50IGV4dGVuZHMgVW5zcGVudDxUTnVtYmVyPj4oXG4gIHU6IFVuc3BlbnQ8VE51bWJlcj5cbik6IHUgaXMgVFVuc3BlbnQgJiB7IHByZXZUeDogQnVmZmVyIH0ge1xuICByZXR1cm4gQnVmZmVyLmlzQnVmZmVyKCh1IGFzIFVuc3BlbnRXaXRoUHJldlR4PFROdW1iZXI+KS5wcmV2VHgpO1xufVxuXG4vKipcbiAqIEByZXR1cm4gVHhPdXRwdXQgZnJvbSBVbnNwZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b091dHB1dDxUTnVtYmVyIGV4dGVuZHMgbnVtYmVyIHwgYmlnaW50Pih1OiBVbnNwZW50PFROdW1iZXI+LCBuZXR3b3JrOiBOZXR3b3JrKTogVHhPdXRwdXQ8VE51bWJlcj4ge1xuICByZXR1cm4ge1xuICAgIHNjcmlwdDogdG9PdXRwdXRTY3JpcHQodS5hZGRyZXNzLCBuZXR3b3JrKSxcbiAgICB2YWx1ZTogdS52YWx1ZSxcbiAgfTtcbn1cblxuLyoqXG4gKiBAcmV0dXJuIFVuc3BlbnQgZnJvbSBUeE91dHB1dFxuICovXG5leHBvcnQgZnVuY3Rpb24gZnJvbU91dHB1dDxUTnVtYmVyIGV4dGVuZHMgbnVtYmVyIHwgYmlnaW50PihcbiAgdHg6IFV0eG9UcmFuc2FjdGlvbjxUTnVtYmVyPixcbiAgdm91dDogbnVtYmVyXG4pOiBVbnNwZW50PFROdW1iZXI+IHtcbiAgY29uc3QgbyA9IHR4Lm91dHNbdm91dF07XG4gIGlmICghbykge1xuICAgIHRocm93IG5ldyBFcnJvcihgaW52YWxpZCB2b3V0YCk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBpZDogZm9ybWF0T3V0cHV0SWQoeyB0eGlkOiB0eC5nZXRJZCgpLCB2b3V0IH0pLFxuICAgIGFkZHJlc3M6IGZyb21PdXRwdXRTY3JpcHQoby5zY3JpcHQsIHR4Lm5ldHdvcmspLFxuICAgIHZhbHVlOiBvLnZhbHVlLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZnJvbU91dHB1dFdpdGhQcmV2VHg8VE51bWJlciBleHRlbmRzIG51bWJlciB8IGJpZ2ludD4oXG4gIHR4OiBVdHhvVHJhbnNhY3Rpb248VE51bWJlcj4sXG4gIHZvdXQ6IG51bWJlclxuKTogVW5zcGVudFdpdGhQcmV2VHg8VE51bWJlcj4ge1xuICByZXR1cm4ge1xuICAgIC4uLmZyb21PdXRwdXQodHgsIHZvdXQpLFxuICAgIHByZXZUeDogdHgudG9CdWZmZXIoKSxcbiAgfTtcbn1cblxuLyoqXG4gKiBAcGFyYW0gb3V0cHV0SWRcbiAqIEByZXR1cm4gVHhPdXRQb2ludFxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VPdXRwdXRJZChvdXRwdXRJZDogc3RyaW5nKTogVHhPdXRQb2ludCB7XG4gIGNvbnN0IHBhcnRzID0gb3V0cHV0SWQuc3BsaXQoJzonKTtcbiAgaWYgKHBhcnRzLmxlbmd0aCAhPT0gMikge1xuICAgIHRocm93IG5ldyBFcnJvcihgaW52YWxpZCBvdXRwdXRJZCwgbXVzdCBoYXZlIGZvcm1hdCB0eGlkOnZvdXRgKTtcbiAgfVxuICBjb25zdCBbdHhpZCwgdm91dFN0cl0gPSBwYXJ0cztcbiAgY29uc3Qgdm91dCA9IE51bWJlcih2b3V0U3RyKTtcbiAgaWYgKHR4aWQubGVuZ3RoICE9PSA2NCkge1xuICAgIHRocm93IG5ldyBFcnJvcihgaW52YWxpZCB0eGlkICR7dHhpZH0gJHt0eGlkLmxlbmd0aH1gKTtcbiAgfVxuICBpZiAoTnVtYmVyLmlzTmFOKHZvdXQpIHx8IHZvdXQgPCAwIHx8ICFOdW1iZXIuaXNTYWZlSW50ZWdlcih2b3V0KSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgaW52YWxpZCB2b3V0OiBtdXN0IGJlIGludGVnZXIgPj0gMGApO1xuICB9XG4gIHJldHVybiB7IHR4aWQsIHZvdXQgfTtcbn1cblxuLyoqXG4gKiBAcGFyYW0gdHhpZFxuICogQHBhcmFtIHZvdXRcbiAqIEByZXR1cm4gb3V0cHV0SWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdE91dHB1dElkKHsgdHhpZCwgdm91dCB9OiBUeE91dFBvaW50KTogc3RyaW5nIHtcbiAgcmV0dXJuIGAke3R4aWR9OiR7dm91dH1gO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0T3V0cHV0SWRGb3JJbnB1dChpOiB7IGhhc2g6IEJ1ZmZlcjsgaW5kZXg6IG51bWJlciB9KTogVHhPdXRQb2ludCB7XG4gIHJldHVybiB7XG4gICAgdHhpZDogQnVmZmVyLmZyb20oaS5oYXNoKS5yZXZlcnNlKCkudG9TdHJpbmcoJ2hleCcpLFxuICAgIHZvdXQ6IGkuaW5kZXgsXG4gIH07XG59XG5cbi8qKlxuICogUmVmZXJlbmNlIHRvIG91dHB1dCBvZiBhbiBleGlzdGluZyB0cmFuc2FjdGlvblxuICovXG5leHBvcnQgdHlwZSBUeE91dFBvaW50ID0ge1xuICB0eGlkOiBzdHJpbmc7XG4gIHZvdXQ6IG51bWJlcjtcbn07XG5cbi8qKlxuICogT3V0cHV0IHJlZmVyZW5jZSBhbmQgc2NyaXB0IGRhdGEuXG4gKiBTdWl0YWJsZSBmb3IgdXNlIGZvciBgdHhiLmFkZElucHV0KClgXG4gKi9cbmV4cG9ydCB0eXBlIFByZXZPdXRwdXQ8VE51bWJlciBleHRlbmRzIG51bWJlciB8IGJpZ2ludCA9IG51bWJlcj4gPSBUeE91dFBvaW50ICZcbiAgVHhPdXRwdXQ8VE51bWJlcj4gJiB7XG4gICAgcHJldlR4PzogQnVmZmVyO1xuICB9O1xuXG4vKipcbiAqIEByZXR1cm4gUHJldk91dHB1dCBmcm9tIFVuc3BlbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvUHJldk91dHB1dDxUTnVtYmVyIGV4dGVuZHMgbnVtYmVyIHwgYmlnaW50PihcbiAgdTogVW5zcGVudDxUTnVtYmVyPixcbiAgbmV0d29yazogTmV0d29ya1xuKTogUHJldk91dHB1dDxUTnVtYmVyPiB7XG4gIHJldHVybiB7XG4gICAgLi4ucGFyc2VPdXRwdXRJZCh1LmlkKSxcbiAgICAuLi50b091dHB1dCh1LCBuZXR3b3JrKSxcbiAgfTtcbn1cblxuLyoqXG4gKiBAcmV0dXJuIFByZXZPdXRwdXQgd2l0aCBwcmV2VHggZnJvbSBVbnNwZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b1ByZXZPdXRwdXRXaXRoUHJldlR4PFROdW1iZXIgZXh0ZW5kcyBudW1iZXIgfCBiaWdpbnQ+KFxuICB1OiBVbnNwZW50PFROdW1iZXI+ICYgeyBwcmV2VHg/OiB1bmtub3duIH0sXG4gIG5ldHdvcms6IE5ldHdvcmtcbik6IFByZXZPdXRwdXQ8VE51bWJlcj4ge1xuICBsZXQgcHJldlR4O1xuICBpZiAodHlwZW9mIHUucHJldlR4ID09PSAnc3RyaW5nJykge1xuICAgIHByZXZUeCA9IEJ1ZmZlci5mcm9tKHUucHJldlR4LCAnaGV4Jyk7XG4gIH0gZWxzZSBpZiAoQnVmZmVyLmlzQnVmZmVyKHUucHJldlR4KSkge1xuICAgIHByZXZUeCA9IHUucHJldlR4O1xuICB9IGVsc2UgaWYgKHUucHJldlR4ICE9PSB1bmRlZmluZWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgcHJldlR4IHR5cGUgZm9yIHVuc3BlbnQgJHt1LnByZXZUeH1gKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIC4uLnBhcnNlT3V0cHV0SWQodS5pZCksXG4gICAgLi4udG9PdXRwdXQodSwgbmV0d29yayksXG4gICAgcHJldlR4LFxuICB9O1xufVxuXG4vKipcbiAqIEBwYXJhbSB0eGJcbiAqIEBwYXJhbSB1XG4gKiBAcGFyYW0gc2VxdWVuY2UgLSBzZXF1ZW5jZUlkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGRUb1RyYW5zYWN0aW9uQnVpbGRlcjxUTnVtYmVyIGV4dGVuZHMgbnVtYmVyIHwgYmlnaW50PihcbiAgdHhiOiBVdHhvVHJhbnNhY3Rpb25CdWlsZGVyPFROdW1iZXI+LFxuICB1OiBVbnNwZW50PFROdW1iZXI+LFxuICBzZXF1ZW5jZT86IG51bWJlclxuKTogdm9pZCB7XG4gIGNvbnN0IHsgdHhpZCwgdm91dCwgc2NyaXB0LCB2YWx1ZSB9ID0gdG9QcmV2T3V0cHV0KHUsIHR4Yi5uZXR3b3JrIGFzIE5ldHdvcmspO1xuICB0eGIuYWRkSW5wdXQodHhpZCwgdm91dCwgc2VxdWVuY2UsIHNjcmlwdCwgdmFsdWUpO1xufVxuXG4vKipcbiAqIFN1bSB0aGUgdmFsdWVzIG9mIHRoZSB1bnNwZW50cy5cbiAqIFRocm93cyBlcnJvciBpZiBzdW0gaXMgbm90IGEgc2FmZSBpbnRlZ2VyIHZhbHVlLCBvciBpZiB1bnNwZW50IGFtb3VudCB0eXBlcyBkbyBub3QgbWF0Y2ggYGFtb3VudFR5cGVgXG4gKiBAcGFyYW0gdW5zcGVudHMgLSBhcnJheSBvZiB1bnNwZW50cyB0byBzdW1cbiAqIEBwYXJhbSBhbW91bnRUeXBlIC0gZXhwZWN0ZWQgdmFsdWUgdHlwZSBvZiB1bnNwZW50c1xuICogQHJldHVybiB1bnNwZW50U3VtIC0gdHlwZSBtYXRjaGVzIGFtb3VudFR5cGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVuc3BlbnRTdW08VE51bWJlciBleHRlbmRzIG51bWJlciB8IGJpZ2ludD4oXG4gIHVuc3BlbnRzOiB7IHZhbHVlOiBUTnVtYmVyIH1bXSxcbiAgYW1vdW50VHlwZTogJ251bWJlcicgfCAnYmlnaW50JyA9ICdudW1iZXInXG4pOiBUTnVtYmVyIHtcbiAgaWYgKGFtb3VudFR5cGUgPT09ICdiaWdpbnQnKSB7XG4gICAgcmV0dXJuIHVuc3BlbnRzLnJlZHVjZSgoc3VtLCB1KSA9PiBzdW0gKyAodS52YWx1ZSBhcyBiaWdpbnQpLCBCaWdJbnQoMCkpIGFzIFROdW1iZXI7XG4gIH0gZWxzZSB7XG4gICAgY29uc3Qgc3VtID0gdW5zcGVudHMucmVkdWNlKChzdW0sIHUpID0+IHN1bSArICh1LnZhbHVlIGFzIG51bWJlciksIE51bWJlcigwKSk7XG4gICAgaWYgKCFOdW1iZXIuaXNTYWZlSW50ZWdlcihzdW0pKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3Vuc3BlbnQgc3VtIGlzIG5vdCBhIHNhZmUgaW50ZWdlciBudW1iZXIsIGNvbnNpZGVyIHVzaW5nIGJpZ2ludCcpO1xuICAgIH1cbiAgICByZXR1cm4gc3VtIGFzIFROdW1iZXI7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6IndyaEJBaUNTO0FBQUFBLGNBQUEsU0FBQUEsQ0FBQSxTQUFBQyxjQUFBLFdBQUFBLGNBQUEsRUFBQUQsY0FBQSxHQUFBQSxjQUFBLEdBQUFFLENBQUEsTSxpRkFIVEMsT0FBQSxDQUFBQyxtQkFBQSxD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