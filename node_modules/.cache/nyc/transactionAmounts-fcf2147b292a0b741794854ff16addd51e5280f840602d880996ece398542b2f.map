{"version":3,"file":"/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/transactionAmounts.ts","sources":["/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/transactionAmounts.ts"],"names":[],"mappings":";;AAGA,sEAiCC;AAnCD,+CAA4D;AAE5D,SAAgB,6BAA6B,CAAC,IAAc;IAO1D,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;IAC3C,MAAM,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;IAC7C,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;IAC/B,MAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;IACjC,MAAM,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,KAAK,EAAE,UAAU,EAAE,EAAE;QACrE,IAAI,KAAK,CAAC,WAAW,EAAE,CAAC;YACtB,OAAO,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QAC/C,CAAC;aAAM,IAAI,KAAK,CAAC,cAAc,EAAE,CAAC;YAChC,MAAM,EAAE,GAAG,IAAA,yCAA2B,EAAC,KAAK,CAAC,cAAc,EAAE,IAAI,CAAC,OAAO,EAAE,EAAE,UAAU,EAAE,QAAQ,EAAE,CAAC,CAAC;YACrG,OAAO,GAAG,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC;QACzD,CAAC;aAAM,CAAC;YACN,MAAM,IAAI,KAAK,CAAC,wCAAwC,CAAC,CAAC;QAC5D,CAAC;IACH,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;IACd,MAAM,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAC3C,CAAC,GAAG,EAAE,MAAM,EAAE,WAAW,EAAE,EAAE,CAAC,GAAG,GAAG,SAAS,CAAC,WAAW,CAAC,CAAC,KAAK,EAChE,MAAM,CAAC,CAAC,CAAC,CACV,CAAC;IACF,MAAM,GAAG,GAAG,WAAW,GAAG,YAAY,CAAC;IACvC,OAAO;QACL,UAAU;QACV,WAAW;QACX,WAAW;QACX,YAAY;QACZ,GAAG;KACJ,CAAC;AACJ,CAAC","sourcesContent":["import { UtxoPsbt } from './UtxoPsbt';\nimport { createTransactionFromBuffer } from './transaction';\n\nexport function getTransactionAmountsFromPsbt(psbt: UtxoPsbt): {\n  inputCount: number;\n  outputCount: number;\n  inputAmount: bigint;\n  outputAmount: bigint;\n  fee: bigint;\n} {\n  const inputCount = psbt.data.inputs.length;\n  const outputCount = psbt.data.outputs.length;\n  const txInputs = psbt.txInputs;\n  const txOutputs = psbt.txOutputs;\n  const inputAmount = psbt.data.inputs.reduce((acc, input, inputIndex) => {\n    if (input.witnessUtxo) {\n      return acc + BigInt(input.witnessUtxo.value);\n    } else if (input.nonWitnessUtxo) {\n      const tx = createTransactionFromBuffer(input.nonWitnessUtxo, psbt.network, { amountType: 'bigint' });\n      return acc + tx.outs[txInputs[inputIndex].index].value;\n    } else {\n      throw new Error('missing witnessUtxo and nonWitnessUtxo');\n    }\n  }, BigInt(0));\n  const outputAmount = psbt.data.outputs.reduce(\n    (acc, output, outputIndex) => acc + txOutputs[outputIndex].value,\n    BigInt(0)\n  );\n  const fee = inputAmount - outputAmount;\n  return {\n    inputCount,\n    outputCount,\n    inputAmount,\n    outputAmount,\n    fee,\n  };\n}\n"]}