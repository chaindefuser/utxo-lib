"use strict";function cov_1vnhnwb5q7(){var path="/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/wallet/WalletUnspentSigner.ts";var hash="e45659a66d6b2acb8b84dc108fb71801bfd1fd31";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/wallet/WalletUnspentSigner.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:37}},"2":{start:{line:4,column:21},end:{line:4,column:44}},"3":{start:{line:7,column:8},end:{line:7,column:69}},"4":{start:{line:10,column:8},end:{line:10,column:29}},"5":{start:{line:11,column:8},end:{line:11,column:33}},"6":{start:{line:12,column:8},end:{line:14,column:9}},"7":{start:{line:13,column:12},end:{line:13,column:69}},"8":{start:{line:15,column:8},end:{line:15,column:104}},"9":{start:{line:15,column:62},end:{line:15,column:102}},"10":{start:{line:16,column:8},end:{line:18,column:9}},"11":{start:{line:17,column:12},end:{line:17,column:61}},"12":{start:{line:19,column:8},end:{line:19,column:108}},"13":{start:{line:19,column:64},end:{line:19,column:106}},"14":{start:{line:20,column:8},end:{line:22,column:9}},"15":{start:{line:21,column:12},end:{line:21,column:63}},"16":{start:{line:23,column:8},end:{line:23,column:37}},"17":{start:{line:24,column:8},end:{line:26,column:9}},"18":{start:{line:25,column:12},end:{line:25,column:62}},"19":{start:{line:27,column:8},end:{line:29,column:9}},"20":{start:{line:28,column:12},end:{line:28,column:60}},"21":{start:{line:37,column:8},end:{line:39,column:9}},"22":{start:{line:38,column:12},end:{line:38,column:74}},"23":{start:{line:40,column:8},end:{line:42,column:9}},"24":{start:{line:41,column:12},end:{line:41,column:273}},"25":{start:{line:43,column:8},end:{line:43,column:41}},"26":{start:{line:46,column:0},end:{line:46,column:50}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:4},end:{line:6,column:5}},loc:{start:{line:6,column:46},end:{line:8,column:5}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:9,column:4},end:{line:9,column:5}},loc:{start:{line:9,column:46},end:{line:30,column:5}},line:9},"2":{name:"(anonymous_2)",decl:{start:{line:15,column:55},end:{line:15,column:56}},loc:{start:{line:15,column:62},end:{line:15,column:102}},line:15},"3":{name:"(anonymous_3)",decl:{start:{line:19,column:57},end:{line:19,column:58}},loc:{start:{line:19,column:64},end:{line:19,column:106}},line:19},"4":{name:"(anonymous_4)",decl:{start:{line:36,column:4},end:{line:36,column:5}},loc:{start:{line:36,column:41},end:{line:44,column:5}},line:36}},branchMap:{"0":{loc:{start:{line:12,column:8},end:{line:14,column:9}},type:"if",locations:[{start:{line:12,column:8},end:{line:14,column:9}},{start:{line:12,column:8},end:{line:14,column:9}}],line:12},"1":{loc:{start:{line:16,column:8},end:{line:18,column:9}},type:"if",locations:[{start:{line:16,column:8},end:{line:18,column:9}},{start:{line:16,column:8},end:{line:18,column:9}}],line:16},"2":{loc:{start:{line:20,column:8},end:{line:22,column:9}},type:"if",locations:[{start:{line:20,column:8},end:{line:22,column:9}},{start:{line:20,column:8},end:{line:22,column:9}}],line:20},"3":{loc:{start:{line:24,column:8},end:{line:26,column:9}},type:"if",locations:[{start:{line:24,column:8},end:{line:26,column:9}},{start:{line:24,column:8},end:{line:26,column:9}}],line:24},"4":{loc:{start:{line:27,column:8},end:{line:29,column:9}},type:"if",locations:[{start:{line:27,column:8},end:{line:29,column:9}},{start:{line:27,column:8},end:{line:29,column:9}}],line:27},"5":{loc:{start:{line:37,column:8},end:{line:39,column:9}},type:"if",locations:[{start:{line:37,column:8},end:{line:39,column:9}},{start:{line:37,column:8},end:{line:39,column:9}}],line:37},"6":{loc:{start:{line:40,column:8},end:{line:42,column:9}},type:"if",locations:[{start:{line:40,column:8},end:{line:42,column:9}},{start:{line:40,column:8},end:{line:42,column:9}}],line:40}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},inputSourceMap:{version:3,file:"/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/wallet/WalletUnspentSigner.ts",sources:["/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/wallet/WalletUnspentSigner.ts"],names:[],mappings:";;;AAEA,6CAA0F;AAG1F,MAAa,mBAAmB;IAG9B,MAAM,CAAC,IAAI,CACT,UAA0B,EAC1B,MAAsB,EACtB,QAAwB;QAExB,OAAO,IAAI,mBAAmB,CAAiB,UAAU,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC;IAC/E,CAAC;IAKD,YACE,UAA+C,EACxC,MAAsB,EACtB,QAAwB;QADxB,WAAM,GAAN,MAAM,CAAgB;QACtB,aAAQ,GAAR,QAAQ,CAAgB;QAE/B,IAAI,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC;YAC9B,UAAU,GAAG,IAAI,2BAAc,CAAC,UAAU,CAAC,CAAC;QAC9C,CAAC;QACD,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,IAAA,wBAAW,EAAC,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC;QAC9E,IAAI,IAAI,CAAC,WAAW,KAAK,SAAS,EAAE,CAAC;YACnC,MAAM,IAAI,KAAK,CAAC,+BAA+B,CAAC,CAAC;QACnD,CAAC;QACD,IAAI,CAAC,aAAa,GAAG,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,IAAA,wBAAW,EAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,CAAC;QAClF,IAAI,IAAI,CAAC,aAAa,KAAK,SAAS,EAAE,CAAC;YACrC,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;QACrD,CAAC;QAED,IAAI,CAAC,UAAU,GAAG,UAAe,CAAC;QAElC,IAAI,IAAA,wBAAW,EAAC,MAAM,EAAE,QAAQ,CAAC,EAAE,CAAC;YAClC,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC;QACpD,CAAC;QACD,IAAI,MAAM,CAAC,UAAU,EAAE,EAAE,CAAC;YACxB,MAAM,IAAI,KAAK,CAAC,8BAA8B,CAAC,CAAC;QAClD,CAAC;IACH,CAAC;IAED;;;;OAIG;IACH,sBAAsB,CAAC,KAAa,EAAE,KAAa;QACjD,IAAI,IAAI,CAAC,UAAU,YAAY,8BAAiB,EAAE,CAAC;YACjD,MAAM,IAAI,KAAK,CAAC,4CAA4C,CAAC,CAAC;QAChE,CAAC;QAED,IAAI,IAAI,CAAC,UAAU,YAAY,2BAAc,EAAE,CAAC;YAC9C,OAAO,IAAI,mBAAmB,CAC5B,IAAI,CAAC,UAAU,CAAC,sBAAsB,CAAC,KAAK,EAAE,KAAK,CAAC,EACpD,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC,EACpF,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC,CACzF,CAAC;QACJ,CAAC;QAED,MAAM,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC;IACnC,CAAC;CACF;AA7DD,kDA6DC",sourcesContent:["import { BIP32Interface } from 'bip32';\n\nimport { DerivedWalletKeys, eqPublicKey, RootWalletKeys, WalletKeys } from './WalletKeys';\nimport { Triple } from '../types';\n\nexport class WalletUnspentSigner<T extends WalletKeys> {\n  public readonly walletKeys: T;\n\n  static from(\n    walletKeys: RootWalletKeys,\n    signer: BIP32Interface,\n    cosigner: BIP32Interface\n  ): WalletUnspentSigner<RootWalletKeys> {\n    return new WalletUnspentSigner<RootWalletKeys>(walletKeys, signer, cosigner);\n  }\n\n  readonly signerIndex;\n  readonly cosignerIndex;\n\n  constructor(\n    walletKeys: WalletKeys | Triple<BIP32Interface>,\n    public signer: BIP32Interface,\n    public cosigner: BIP32Interface\n  ) {\n    if (Array.isArray(walletKeys)) {\n      walletKeys = new RootWalletKeys(walletKeys);\n    }\n    this.signerIndex = walletKeys.triple.findIndex((k) => eqPublicKey(k, signer));\n    if (this.signerIndex === undefined) {\n      throw new Error(`signer not part of walletKeys`);\n    }\n    this.cosignerIndex = walletKeys.triple.findIndex((k) => eqPublicKey(k, cosigner));\n    if (this.cosignerIndex === undefined) {\n      throw new Error(`cosigner not part of walletKeys`);\n    }\n\n    this.walletKeys = walletKeys as T;\n\n    if (eqPublicKey(signer, cosigner)) {\n      throw new Error(`signer must not equal cosigner`);\n    }\n    if (signer.isNeutered()) {\n      throw new Error(`signer must have private key`);\n    }\n  }\n\n  /**\n   * @param chain\n   * @param index\n   * @return WalletUnspentSigner that contains keys for generating output scripts and signatures.\n   */\n  deriveForChainAndIndex(chain: number, index: number): WalletUnspentSigner<DerivedWalletKeys> {\n    if (this.walletKeys instanceof DerivedWalletKeys) {\n      throw new Error(`cannot derive again from DerivedWalletKeys`);\n    }\n\n    if (this.walletKeys instanceof RootWalletKeys) {\n      return new WalletUnspentSigner(\n        this.walletKeys.deriveForChainAndIndex(chain, index),\n        this.signer.derivePath(this.walletKeys.getDerivationPath(this.signer, chain, index)),\n        this.cosigner.derivePath(this.walletKeys.getDerivationPath(this.cosigner, chain, index))\n      );\n    }\n\n    throw new Error(`invalid state`);\n  }\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"e45659a66d6b2acb8b84dc108fb71801bfd1fd31"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1vnhnwb5q7=function(){return actualCoverage;};}return actualCoverage;}cov_1vnhnwb5q7();cov_1vnhnwb5q7().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_1vnhnwb5q7().s[1]++;exports.WalletUnspentSigner=void 0;const WalletKeys_1=(cov_1vnhnwb5q7().s[2]++,require("./WalletKeys"));class WalletUnspentSigner{static from(walletKeys,signer,cosigner){cov_1vnhnwb5q7().f[0]++;cov_1vnhnwb5q7().s[3]++;return new WalletUnspentSigner(walletKeys,signer,cosigner);}constructor(walletKeys,signer,cosigner){cov_1vnhnwb5q7().f[1]++;cov_1vnhnwb5q7().s[4]++;this.signer=signer;cov_1vnhnwb5q7().s[5]++;this.cosigner=cosigner;cov_1vnhnwb5q7().s[6]++;if(Array.isArray(walletKeys)){cov_1vnhnwb5q7().b[0][0]++;cov_1vnhnwb5q7().s[7]++;walletKeys=new WalletKeys_1.RootWalletKeys(walletKeys);}else{cov_1vnhnwb5q7().b[0][1]++;}cov_1vnhnwb5q7().s[8]++;this.signerIndex=walletKeys.triple.findIndex(k=>{cov_1vnhnwb5q7().f[2]++;cov_1vnhnwb5q7().s[9]++;return(0,WalletKeys_1.eqPublicKey)(k,signer);});cov_1vnhnwb5q7().s[10]++;if(this.signerIndex===undefined){cov_1vnhnwb5q7().b[1][0]++;cov_1vnhnwb5q7().s[11]++;throw new Error(`signer not part of walletKeys`);}else{cov_1vnhnwb5q7().b[1][1]++;}cov_1vnhnwb5q7().s[12]++;this.cosignerIndex=walletKeys.triple.findIndex(k=>{cov_1vnhnwb5q7().f[3]++;cov_1vnhnwb5q7().s[13]++;return(0,WalletKeys_1.eqPublicKey)(k,cosigner);});cov_1vnhnwb5q7().s[14]++;if(this.cosignerIndex===undefined){cov_1vnhnwb5q7().b[2][0]++;cov_1vnhnwb5q7().s[15]++;throw new Error(`cosigner not part of walletKeys`);}else{cov_1vnhnwb5q7().b[2][1]++;}cov_1vnhnwb5q7().s[16]++;this.walletKeys=walletKeys;cov_1vnhnwb5q7().s[17]++;if((0,WalletKeys_1.eqPublicKey)(signer,cosigner)){cov_1vnhnwb5q7().b[3][0]++;cov_1vnhnwb5q7().s[18]++;throw new Error(`signer must not equal cosigner`);}else{cov_1vnhnwb5q7().b[3][1]++;}cov_1vnhnwb5q7().s[19]++;if(signer.isNeutered()){cov_1vnhnwb5q7().b[4][0]++;cov_1vnhnwb5q7().s[20]++;throw new Error(`signer must have private key`);}else{cov_1vnhnwb5q7().b[4][1]++;}}/**
     * @param chain
     * @param index
     * @return WalletUnspentSigner that contains keys for generating output scripts and signatures.
     */deriveForChainAndIndex(chain,index){cov_1vnhnwb5q7().f[4]++;cov_1vnhnwb5q7().s[21]++;if(this.walletKeys instanceof WalletKeys_1.DerivedWalletKeys){cov_1vnhnwb5q7().b[5][0]++;cov_1vnhnwb5q7().s[22]++;throw new Error(`cannot derive again from DerivedWalletKeys`);}else{cov_1vnhnwb5q7().b[5][1]++;}cov_1vnhnwb5q7().s[23]++;if(this.walletKeys instanceof WalletKeys_1.RootWalletKeys){cov_1vnhnwb5q7().b[6][0]++;cov_1vnhnwb5q7().s[24]++;return new WalletUnspentSigner(this.walletKeys.deriveForChainAndIndex(chain,index),this.signer.derivePath(this.walletKeys.getDerivationPath(this.signer,chain,index)),this.cosigner.derivePath(this.walletKeys.getDerivationPath(this.cosigner,chain,index)));}else{cov_1vnhnwb5q7().b[6][1]++;}cov_1vnhnwb5q7().s[25]++;throw new Error(`invalid state`);}}cov_1vnhnwb5q7().s[26]++;exports.WalletUnspentSigner=WalletUnspentSigner;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3Fyb2MvQ29kZS9oYXBpL2NoYWluZGVmdXNlci91dHhvLWxpYi9zcmMvYml0Z28vd2FsbGV0L1dhbGxldFVuc3BlbnRTaWduZXIudHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9xcm9jL0NvZGUvaGFwaS9jaGFpbmRlZnVzZXIvdXR4by1saWIvc3JjL2JpdGdvL3dhbGxldC9XYWxsZXRVbnNwZW50U2lnbmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUVBLDZDQUEwRjtBQUcxRixNQUFhLG1CQUFtQjtJQUc5QixNQUFNLENBQUMsSUFBSSxDQUNULFVBQTBCLEVBQzFCLE1BQXNCLEVBQ3RCLFFBQXdCO1FBRXhCLE9BQU8sSUFBSSxtQkFBbUIsQ0FBaUIsVUFBVSxFQUFFLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQztJQUMvRSxDQUFDO0lBS0QsWUFDRSxVQUErQyxFQUN4QyxNQUFzQixFQUN0QixRQUF3QjtRQUR4QixXQUFNLEdBQU4sTUFBTSxDQUFnQjtRQUN0QixhQUFRLEdBQVIsUUFBUSxDQUFnQjtRQUUvQixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQztZQUM5QixVQUFVLEdBQUcsSUFBSSwyQkFBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzlDLENBQUM7UUFDRCxJQUFJLENBQUMsV0FBVyxHQUFHLFVBQVUsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxJQUFBLHdCQUFXLEVBQUMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDOUUsSUFBSSxJQUFJLENBQUMsV0FBVyxLQUFLLFNBQVMsRUFBRSxDQUFDO1lBQ25DLE1BQU0sSUFBSSxLQUFLLENBQUMsK0JBQStCLENBQUMsQ0FBQztRQUNuRCxDQUFDO1FBQ0QsSUFBSSxDQUFDLGFBQWEsR0FBRyxVQUFVLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBQSx3QkFBVyxFQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDO1FBQ2xGLElBQUksSUFBSSxDQUFDLGFBQWEsS0FBSyxTQUFTLEVBQUUsQ0FBQztZQUNyQyxNQUFNLElBQUksS0FBSyxDQUFDLGlDQUFpQyxDQUFDLENBQUM7UUFDckQsQ0FBQztRQUVELElBQUksQ0FBQyxVQUFVLEdBQUcsVUFBZSxDQUFDO1FBRWxDLElBQUksSUFBQSx3QkFBVyxFQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsRUFBRSxDQUFDO1lBQ2xDLE1BQU0sSUFBSSxLQUFLLENBQUMsZ0NBQWdDLENBQUMsQ0FBQztRQUNwRCxDQUFDO1FBQ0QsSUFBSSxNQUFNLENBQUMsVUFBVSxFQUFFLEVBQUUsQ0FBQztZQUN4QixNQUFNLElBQUksS0FBSyxDQUFDLDhCQUE4QixDQUFDLENBQUM7UUFDbEQsQ0FBQztJQUNILENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsc0JBQXNCLENBQUMsS0FBYSxFQUFFLEtBQWE7UUFDakQsSUFBSSxJQUFJLENBQUMsVUFBVSxZQUFZLDhCQUFpQixFQUFFLENBQUM7WUFDakQsTUFBTSxJQUFJLEtBQUssQ0FBQyw0Q0FBNEMsQ0FBQyxDQUFDO1FBQ2hFLENBQUM7UUFFRCxJQUFJLElBQUksQ0FBQyxVQUFVLFlBQVksMkJBQWMsRUFBRSxDQUFDO1lBQzlDLE9BQU8sSUFBSSxtQkFBbUIsQ0FDNUIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxzQkFBc0IsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLEVBQ3BELElBQUksQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUMsRUFDcEYsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUN6RixDQUFDO1FBQ0osQ0FBQztRQUVELE1BQU0sSUFBSSxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUM7SUFDbkMsQ0FBQztDQUNGO0FBN0RELGtEQTZEQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJJUDMySW50ZXJmYWNlIH0gZnJvbSAnYmlwMzInO1xuXG5pbXBvcnQgeyBEZXJpdmVkV2FsbGV0S2V5cywgZXFQdWJsaWNLZXksIFJvb3RXYWxsZXRLZXlzLCBXYWxsZXRLZXlzIH0gZnJvbSAnLi9XYWxsZXRLZXlzJztcbmltcG9ydCB7IFRyaXBsZSB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIFdhbGxldFVuc3BlbnRTaWduZXI8VCBleHRlbmRzIFdhbGxldEtleXM+IHtcbiAgcHVibGljIHJlYWRvbmx5IHdhbGxldEtleXM6IFQ7XG5cbiAgc3RhdGljIGZyb20oXG4gICAgd2FsbGV0S2V5czogUm9vdFdhbGxldEtleXMsXG4gICAgc2lnbmVyOiBCSVAzMkludGVyZmFjZSxcbiAgICBjb3NpZ25lcjogQklQMzJJbnRlcmZhY2VcbiAgKTogV2FsbGV0VW5zcGVudFNpZ25lcjxSb290V2FsbGV0S2V5cz4ge1xuICAgIHJldHVybiBuZXcgV2FsbGV0VW5zcGVudFNpZ25lcjxSb290V2FsbGV0S2V5cz4od2FsbGV0S2V5cywgc2lnbmVyLCBjb3NpZ25lcik7XG4gIH1cblxuICByZWFkb25seSBzaWduZXJJbmRleDtcbiAgcmVhZG9ubHkgY29zaWduZXJJbmRleDtcblxuICBjb25zdHJ1Y3RvcihcbiAgICB3YWxsZXRLZXlzOiBXYWxsZXRLZXlzIHwgVHJpcGxlPEJJUDMySW50ZXJmYWNlPixcbiAgICBwdWJsaWMgc2lnbmVyOiBCSVAzMkludGVyZmFjZSxcbiAgICBwdWJsaWMgY29zaWduZXI6IEJJUDMySW50ZXJmYWNlXG4gICkge1xuICAgIGlmIChBcnJheS5pc0FycmF5KHdhbGxldEtleXMpKSB7XG4gICAgICB3YWxsZXRLZXlzID0gbmV3IFJvb3RXYWxsZXRLZXlzKHdhbGxldEtleXMpO1xuICAgIH1cbiAgICB0aGlzLnNpZ25lckluZGV4ID0gd2FsbGV0S2V5cy50cmlwbGUuZmluZEluZGV4KChrKSA9PiBlcVB1YmxpY0tleShrLCBzaWduZXIpKTtcbiAgICBpZiAodGhpcy5zaWduZXJJbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYHNpZ25lciBub3QgcGFydCBvZiB3YWxsZXRLZXlzYCk7XG4gICAgfVxuICAgIHRoaXMuY29zaWduZXJJbmRleCA9IHdhbGxldEtleXMudHJpcGxlLmZpbmRJbmRleCgoaykgPT4gZXFQdWJsaWNLZXkoaywgY29zaWduZXIpKTtcbiAgICBpZiAodGhpcy5jb3NpZ25lckluZGV4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgY29zaWduZXIgbm90IHBhcnQgb2Ygd2FsbGV0S2V5c2ApO1xuICAgIH1cblxuICAgIHRoaXMud2FsbGV0S2V5cyA9IHdhbGxldEtleXMgYXMgVDtcblxuICAgIGlmIChlcVB1YmxpY0tleShzaWduZXIsIGNvc2lnbmVyKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBzaWduZXIgbXVzdCBub3QgZXF1YWwgY29zaWduZXJgKTtcbiAgICB9XG4gICAgaWYgKHNpZ25lci5pc05ldXRlcmVkKCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgc2lnbmVyIG11c3QgaGF2ZSBwcml2YXRlIGtleWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gY2hhaW5cbiAgICogQHBhcmFtIGluZGV4XG4gICAqIEByZXR1cm4gV2FsbGV0VW5zcGVudFNpZ25lciB0aGF0IGNvbnRhaW5zIGtleXMgZm9yIGdlbmVyYXRpbmcgb3V0cHV0IHNjcmlwdHMgYW5kIHNpZ25hdHVyZXMuXG4gICAqL1xuICBkZXJpdmVGb3JDaGFpbkFuZEluZGV4KGNoYWluOiBudW1iZXIsIGluZGV4OiBudW1iZXIpOiBXYWxsZXRVbnNwZW50U2lnbmVyPERlcml2ZWRXYWxsZXRLZXlzPiB7XG4gICAgaWYgKHRoaXMud2FsbGV0S2V5cyBpbnN0YW5jZW9mIERlcml2ZWRXYWxsZXRLZXlzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYGNhbm5vdCBkZXJpdmUgYWdhaW4gZnJvbSBEZXJpdmVkV2FsbGV0S2V5c2ApO1xuICAgIH1cblxuICAgIGlmICh0aGlzLndhbGxldEtleXMgaW5zdGFuY2VvZiBSb290V2FsbGV0S2V5cykge1xuICAgICAgcmV0dXJuIG5ldyBXYWxsZXRVbnNwZW50U2lnbmVyKFxuICAgICAgICB0aGlzLndhbGxldEtleXMuZGVyaXZlRm9yQ2hhaW5BbmRJbmRleChjaGFpbiwgaW5kZXgpLFxuICAgICAgICB0aGlzLnNpZ25lci5kZXJpdmVQYXRoKHRoaXMud2FsbGV0S2V5cy5nZXREZXJpdmF0aW9uUGF0aCh0aGlzLnNpZ25lciwgY2hhaW4sIGluZGV4KSksXG4gICAgICAgIHRoaXMuY29zaWduZXIuZGVyaXZlUGF0aCh0aGlzLndhbGxldEtleXMuZ2V0RGVyaXZhdGlvblBhdGgodGhpcy5jb3NpZ25lciwgY2hhaW4sIGluZGV4KSlcbiAgICAgICk7XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIHN0YXRlYCk7XG4gIH1cbn1cbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMXZuaG53YjVxNyIsImFjdHVhbENvdmVyYWdlIiwicyIsIldhbGxldEtleXNfMSIsInJlcXVpcmUiLCJXYWxsZXRVbnNwZW50U2lnbmVyIiwiZnJvbSIsIndhbGxldEtleXMiLCJzaWduZXIiLCJjb3NpZ25lciIsImYiLCJjb25zdHJ1Y3RvciIsIkFycmF5IiwiaXNBcnJheSIsImIiLCJSb290V2FsbGV0S2V5cyIsInNpZ25lckluZGV4IiwidHJpcGxlIiwiZmluZEluZGV4IiwiayIsImVxUHVibGljS2V5IiwidW5kZWZpbmVkIiwiRXJyb3IiLCJjb3NpZ25lckluZGV4IiwiaXNOZXV0ZXJlZCIsImRlcml2ZUZvckNoYWluQW5kSW5kZXgiLCJjaGFpbiIsImluZGV4IiwiRGVyaXZlZFdhbGxldEtleXMiLCJkZXJpdmVQYXRoIiwiZ2V0RGVyaXZhdGlvblBhdGgiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiL1VzZXJzL3Fyb2MvQ29kZS9oYXBpL2NoYWluZGVmdXNlci91dHhvLWxpYi9zcmMvYml0Z28vd2FsbGV0L1dhbGxldFVuc3BlbnRTaWduZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQklQMzJJbnRlcmZhY2UgfSBmcm9tICdiaXAzMic7XG5cbmltcG9ydCB7IERlcml2ZWRXYWxsZXRLZXlzLCBlcVB1YmxpY0tleSwgUm9vdFdhbGxldEtleXMsIFdhbGxldEtleXMgfSBmcm9tICcuL1dhbGxldEtleXMnO1xuaW1wb3J0IHsgVHJpcGxlIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgV2FsbGV0VW5zcGVudFNpZ25lcjxUIGV4dGVuZHMgV2FsbGV0S2V5cz4ge1xuICBwdWJsaWMgcmVhZG9ubHkgd2FsbGV0S2V5czogVDtcblxuICBzdGF0aWMgZnJvbShcbiAgICB3YWxsZXRLZXlzOiBSb290V2FsbGV0S2V5cyxcbiAgICBzaWduZXI6IEJJUDMySW50ZXJmYWNlLFxuICAgIGNvc2lnbmVyOiBCSVAzMkludGVyZmFjZVxuICApOiBXYWxsZXRVbnNwZW50U2lnbmVyPFJvb3RXYWxsZXRLZXlzPiB7XG4gICAgcmV0dXJuIG5ldyBXYWxsZXRVbnNwZW50U2lnbmVyPFJvb3RXYWxsZXRLZXlzPih3YWxsZXRLZXlzLCBzaWduZXIsIGNvc2lnbmVyKTtcbiAgfVxuXG4gIHJlYWRvbmx5IHNpZ25lckluZGV4O1xuICByZWFkb25seSBjb3NpZ25lckluZGV4O1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHdhbGxldEtleXM6IFdhbGxldEtleXMgfCBUcmlwbGU8QklQMzJJbnRlcmZhY2U+LFxuICAgIHB1YmxpYyBzaWduZXI6IEJJUDMySW50ZXJmYWNlLFxuICAgIHB1YmxpYyBjb3NpZ25lcjogQklQMzJJbnRlcmZhY2VcbiAgKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkod2FsbGV0S2V5cykpIHtcbiAgICAgIHdhbGxldEtleXMgPSBuZXcgUm9vdFdhbGxldEtleXMod2FsbGV0S2V5cyk7XG4gICAgfVxuICAgIHRoaXMuc2lnbmVySW5kZXggPSB3YWxsZXRLZXlzLnRyaXBsZS5maW5kSW5kZXgoKGspID0+IGVxUHVibGljS2V5KGssIHNpZ25lcikpO1xuICAgIGlmICh0aGlzLnNpZ25lckluZGV4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgc2lnbmVyIG5vdCBwYXJ0IG9mIHdhbGxldEtleXNgKTtcbiAgICB9XG4gICAgdGhpcy5jb3NpZ25lckluZGV4ID0gd2FsbGV0S2V5cy50cmlwbGUuZmluZEluZGV4KChrKSA9PiBlcVB1YmxpY0tleShrLCBjb3NpZ25lcikpO1xuICAgIGlmICh0aGlzLmNvc2lnbmVySW5kZXggPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBjb3NpZ25lciBub3QgcGFydCBvZiB3YWxsZXRLZXlzYCk7XG4gICAgfVxuXG4gICAgdGhpcy53YWxsZXRLZXlzID0gd2FsbGV0S2V5cyBhcyBUO1xuXG4gICAgaWYgKGVxUHVibGljS2V5KHNpZ25lciwgY29zaWduZXIpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYHNpZ25lciBtdXN0IG5vdCBlcXVhbCBjb3NpZ25lcmApO1xuICAgIH1cbiAgICBpZiAoc2lnbmVyLmlzTmV1dGVyZWQoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBzaWduZXIgbXVzdCBoYXZlIHByaXZhdGUga2V5YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSBjaGFpblxuICAgKiBAcGFyYW0gaW5kZXhcbiAgICogQHJldHVybiBXYWxsZXRVbnNwZW50U2lnbmVyIHRoYXQgY29udGFpbnMga2V5cyBmb3IgZ2VuZXJhdGluZyBvdXRwdXQgc2NyaXB0cyBhbmQgc2lnbmF0dXJlcy5cbiAgICovXG4gIGRlcml2ZUZvckNoYWluQW5kSW5kZXgoY2hhaW46IG51bWJlciwgaW5kZXg6IG51bWJlcik6IFdhbGxldFVuc3BlbnRTaWduZXI8RGVyaXZlZFdhbGxldEtleXM+IHtcbiAgICBpZiAodGhpcy53YWxsZXRLZXlzIGluc3RhbmNlb2YgRGVyaXZlZFdhbGxldEtleXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgY2Fubm90IGRlcml2ZSBhZ2FpbiBmcm9tIERlcml2ZWRXYWxsZXRLZXlzYCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMud2FsbGV0S2V5cyBpbnN0YW5jZW9mIFJvb3RXYWxsZXRLZXlzKSB7XG4gICAgICByZXR1cm4gbmV3IFdhbGxldFVuc3BlbnRTaWduZXIoXG4gICAgICAgIHRoaXMud2FsbGV0S2V5cy5kZXJpdmVGb3JDaGFpbkFuZEluZGV4KGNoYWluLCBpbmRleCksXG4gICAgICAgIHRoaXMuc2lnbmVyLmRlcml2ZVBhdGgodGhpcy53YWxsZXRLZXlzLmdldERlcml2YXRpb25QYXRoKHRoaXMuc2lnbmVyLCBjaGFpbiwgaW5kZXgpKSxcbiAgICAgICAgdGhpcy5jb3NpZ25lci5kZXJpdmVQYXRoKHRoaXMud2FsbGV0S2V5cy5nZXREZXJpdmF0aW9uUGF0aCh0aGlzLmNvc2lnbmVyLCBjaGFpbiwgaW5kZXgpKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgc3RhdGVgKTtcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiODlRQTRCUTtBQUFBQSxjQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGNBQUEsR0FBQUEsY0FBQSxHQUFBRSxDQUFBLE0sb0hBMUJSLE1BQUFDLFlBQUEsRUFBQUgsY0FBQSxHQUFBRSxDQUFBLE1BQUFFLE9BQUEsa0JBR0EsS0FBYSxDQUFBQyxtQkFBbUIsQ0FHOUIsTUFBTyxDQUFBQyxJQUFJQSxDQUNUQyxVQUEwQixDQUMxQkMsTUFBc0IsQ0FDdEJDLFFBQXdCLEVBQUFULGNBQUEsR0FBQVUsQ0FBQSxNQUFBVixjQUFBLEdBQUFFLENBQUEsTUFFeEIsTUFBTyxJQUFJLENBQUFHLG1CQUFtQixDQUFpQkUsVUFBVSxDQUFFQyxNQUFNLENBQUVDLFFBQVEsQ0FBQyxDQUM5RSxDQUtBRSxZQUNFSixVQUErQyxDQUN4Q0MsTUFBc0IsQ0FDdEJDLFFBQXdCLEVBQUFULGNBQUEsR0FBQVUsQ0FBQSxNQUFBVixjQUFBLEdBQUFFLENBQUEsTUFEeEIsS0FBQU0sTUFBTSxDQUFOQSxNQUFNLENBQWdCUixjQUFBLEdBQUFFLENBQUEsTUFDdEIsS0FBQU8sUUFBUSxDQUFSQSxRQUFRLENBQWdCVCxjQUFBLEdBQUFFLENBQUEsTUFFL0IsR0FBSVUsS0FBSyxDQUFDQyxPQUFPLENBQUNOLFVBQVUsQ0FBQyxDQUFFLENBQUFQLGNBQUEsR0FBQWMsQ0FBQSxTQUFBZCxjQUFBLEdBQUFFLENBQUEsTUFDN0JLLFVBQVUsQ0FBRyxHQUFJLENBQUFKLFlBQUEsQ0FBQVksY0FBYyxDQUFDUixVQUFVLENBQUMsQ0FDN0MsQ0FBQyxLQUFBUCxjQUFBLEdBQUFjLENBQUEsVUFBQWQsY0FBQSxHQUFBRSxDQUFBLE1BQ0QsSUFBSSxDQUFDYyxXQUFXLENBQUdULFVBQVUsQ0FBQ1UsTUFBTSxDQUFDQyxTQUFTLENBQUVDLENBQUMs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