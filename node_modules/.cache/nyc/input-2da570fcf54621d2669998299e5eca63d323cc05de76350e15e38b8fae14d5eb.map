{"version":3,"file":"/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/templates/witnessscripthash/input.ts","sources":["/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/templates/witnessscripthash/input.ts"],"names":[],"mappings":";AAAA,+CAA+C;;AAS/C,sBAsBC;AA7BD,8BAA2C;AAC3C,MAAM,SAAS,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AAEvC,oCAAoC;AACpC,kCAAkC;AAClC,uCAAuC;AAEvC,SAAgB,KAAK,CAAC,MAAgB,EAAE,eAAyB;IAC/D,SAAS,CAAC,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;IACnC,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC;QAAE,OAAO,KAAK,CAAC;IAEpC,MAAM,aAAa,GAAG,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IAChD,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC;QAAE,OAAO,KAAK,CAAC;IAElD,MAAM,mBAAmB,GAAG,UAAO,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;IAE7D,mCAAmC;IACnC,IAAI,CAAC,mBAAmB,IAAI,mBAAmB,CAAC,MAAM,KAAK,CAAC;QAAE,OAAO,KAAK,CAAC;IAE3E,MAAM,mBAAmB,GAAG,UAAO,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IAEjE,cAAc;IACd,IAAI,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,mBAAmB,CAAC,IAAI,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,mBAAmB,CAAC;QAAE,OAAO,IAAI,CAAC;IAEnG,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,mBAAmB,EAAE,eAAe,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,mBAAmB,CAAC;QAAE,OAAO,IAAI,CAAC;IAElH,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,mBAAmB,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,mBAAmB,CAAC;QAAE,OAAO,IAAI,CAAC;IAEjG,OAAO,KAAK,CAAC;AACf,CAAC;AACD,KAAK,CAAC,MAAM,GAAG,GAAW,EAAE;IAC1B,OAAO,yBAAyB,CAAC;AACnC,CAAC,CAAC","sourcesContent":["// <scriptSig> {serialized scriptPubKey script}\n\nimport { script as bscript } from '../../';\nconst typeforce = require('typeforce');\n\nimport * as p2ms from '../multisig';\nimport * as p2pk from '../pubkey';\nimport * as p2pkh from '../pubkeyhash';\n\nexport function check(chunks: Buffer[], allowIncomplete?: boolean): boolean {\n  typeforce(typeforce.Array, chunks);\n  if (chunks.length < 1) return false;\n\n  const witnessScript = chunks[chunks.length - 1];\n  if (!Buffer.isBuffer(witnessScript)) return false;\n\n  const witnessScriptChunks = bscript.decompile(witnessScript);\n\n  // is witnessScript a valid script?\n  if (!witnessScriptChunks || witnessScriptChunks.length === 0) return false;\n\n  const witnessRawScriptSig = bscript.compile(chunks.slice(0, -1));\n\n  // match types\n  if (p2pkh.input.check(witnessRawScriptSig) && p2pkh.output.check(witnessScriptChunks)) return true;\n\n  if (p2ms.input.check(witnessRawScriptSig, allowIncomplete) && p2ms.output.check(witnessScriptChunks)) return true;\n\n  if (p2pk.input.check(witnessRawScriptSig) && p2pk.output.check(witnessScriptChunks)) return true;\n\n  return false;\n}\ncheck.toJSON = (): string => {\n  return 'witnessScriptHash input';\n};\n"]}