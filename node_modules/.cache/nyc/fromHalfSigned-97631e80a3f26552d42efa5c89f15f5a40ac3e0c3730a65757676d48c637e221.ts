"use strict";function cov_10p4j2k9pn(){var path="/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/psbt/fromHalfSigned.ts";var hash="201078831300f8ff3c549bca81050b4df2787102";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/psbt/fromHalfSigned.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:0},end:{line:3,column:40}},"2":{start:{line:4,column:0},end:{line:4,column:24}},"3":{start:{line:5,column:15},end:{line:5,column:32}},"4":{start:{line:6,column:12},end:{line:6,column:28}},"5":{start:{line:7,column:21},end:{line:7,column:45}},"6":{start:{line:8,column:20},end:{line:8,column:43}},"7":{start:{line:9,column:24},end:{line:9,column:51}},"8":{start:{line:11,column:4},end:{line:11,column:85}},"9":{start:{line:11,column:67},end:{line:11,column:82}},"10":{start:{line:14,column:27},end:{line:14,column:47}},"11":{start:{line:15,column:32},end:{line:15,column:43}},"12":{start:{line:16,column:4},end:{line:18,column:5}},"13":{start:{line:17,column:8},end:{line:17,column:56}},"14":{start:{line:19,column:24},end:{line:19,column:75}},"15":{start:{line:20,column:4},end:{line:20,column:64}},"16":{start:{line:22,column:8},end:{line:22,column:68}},"17":{start:{line:23,column:8},end:{line:30,column:18}},"18":{start:{line:23,column:129},end:{line:30,column:16}},"19":{start:{line:35,column:4},end:{line:40,column:5}},"20":{start:{line:39,column:8},end:{line:39,column:87}},"21":{start:{line:41,column:4},end:{line:68,column:5}},"22":{start:{line:43,column:12},end:{line:46,column:14}},"23":{start:{line:50,column:12},end:{line:55,column:15}},"24":{start:{line:57,column:29},end:{line:57,column:113}},"25":{start:{line:58,column:12},end:{line:67,column:14}},"26":{start:{line:66,column:61},end:{line:66,column:81}},"27":{start:{line:86,column:4},end:{line:91,column:7}},"28":{start:{line:87,column:23},end:{line:87,column:56}},"29":{start:{line:88,column:8},end:{line:88,column:27}},"30":{start:{line:89,column:8},end:{line:89,column:39}},"31":{start:{line:90,column:8},end:{line:90,column:22}}},fnMap:{"0":{name:"omitUndefined",decl:{start:{line:10,column:9},end:{line:10,column:22}},loc:{start:{line:10,column:26},end:{line:12,column:1}},line:10},"1":{name:"(anonymous_1)",decl:{start:{line:11,column:55},end:{line:11,column:56}},loc:{start:{line:11,column:67},end:{line:11,column:82}},line:11},"2":{name:"getInputUpdate",decl:{start:{line:13,column:9},end:{line:13,column:23}},loc:{start:{line:13,column:43},end:{line:69,column:1}},line:13},"3":{name:"getPartialSigs",decl:{start:{line:21,column:13},end:{line:21,column:27}},loc:{start:{line:21,column:30},end:{line:31,column:5}},line:21},"4":{name:"(anonymous_4)",decl:{start:{line:23,column:111},end:{line:23,column:112}},loc:{start:{line:23,column:129},end:{line:30,column:16}},line:23},"5":{name:"(anonymous_5)",decl:{start:{line:66,column:51},end:{line:66,column:52}},loc:{start:{line:66,column:61},end:{line:66,column:81}},line:66},"6":{name:"unsign",decl:{start:{line:85,column:9},end:{line:85,column:15}},loc:{start:{line:85,column:30},end:{line:92,column:1}},line:85},"7":{name:"(anonymous_7)",decl:{start:{line:86,column:22},end:{line:86,column:23}},loc:{start:{line:86,column:38},end:{line:91,column:5}},line:86}},branchMap:{"0":{loc:{start:{line:16,column:4},end:{line:18,column:5}},type:"if",locations:[{start:{line:16,column:4},end:{line:18,column:5}},{start:{line:16,column:4},end:{line:18,column:5}}],line:16},"1":{loc:{start:{line:16,column:8},end:{line:16,column:51}},type:"binary-expr",locations:[{start:{line:16,column:8},end:{line:16,column:27}},{start:{line:16,column:31},end:{line:16,column:51}}],line:16},"2":{loc:{start:{line:17,column:15},end:{line:17,column:55}},type:"cond-expr",locations:[{start:{line:17,column:32},end:{line:17,column:50}},{start:{line:17,column:53},end:{line:17,column:55}}],line:17},"3":{loc:{start:{line:23,column:129},end:{line:30,column:16}},type:"cond-expr",locations:[{start:{line:24,column:14},end:{line:29,column:13}},{start:{line:30,column:14},end:{line:30,column:16}}],line:23},"4":{loc:{start:{line:35,column:4},end:{line:40,column:5}},type:"if",locations:[{start:{line:35,column:4},end:{line:40,column:5}},{start:{line:35,column:4},end:{line:40,column:5}}],line:35},"5":{loc:{start:{line:35,column:8},end:{line:38,column:62}},type:"binary-expr",locations:[{start:{line:35,column:8},end:{line:35,column:59}},{start:{line:36,column:8},end:{line:36,column:68}},{start:{line:37,column:8},end:{line:37,column:23}},{start:{line:38,column:8},end:{line:38,column:62}}],line:35},"6":{loc:{start:{line:41,column:4},end:{line:68,column:5}},type:"switch",locations:[{start:{line:42,column:8},end:{line:46,column:14}},{start:{line:47,column:8},end:{line:47,column:20}},{start:{line:48,column:8},end:{line:48,column:21}},{start:{line:49,column:8},end:{line:55,column:15}},{start:{line:56,column:8},end:{line:67,column:14}}],line:41}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0,0],"6":[0,0,0,0,0]},inputSourceMap:{version:3,file:"/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/psbt/fromHalfSigned.ts",sources:["/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/bitgo/psbt/fromHalfSigned.ts"],names:[],mappings:"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",sourcesContent:["import * as assert from 'assert';\nimport { PsbtInputUpdate, PartialSig } from 'bip174/src/lib/interfaces';\nimport { ecc as eccLib, TxOutput, taproot, getMainnet, networks } from '../..';\nimport { UtxoTransaction } from '../UtxoTransaction';\nimport { parseSignatureScript } from '../parseInput';\nimport { getSignaturesWithPublicKeys } from '../signature';\nimport { hasWitnessData } from '../outputScripts';\n\nfunction omitUndefined<T extends Record<string, unknown>>(v: Record<string, unknown>): T {\n  return Object.fromEntries(Object.entries(v).filter(([k, v]) => v !== undefined)) as T;\n}\n\nexport function getInputUpdate(\n  tx: UtxoTransaction<bigint>,\n  vin: number,\n  prevOuts: (TxOutput<bigint> & { prevTx?: Buffer })[]\n): PsbtInputUpdate {\n  const nonWitnessUtxo = prevOuts[vin].prevTx;\n  const { script, witness } = tx.ins[vin];\n  if (script.length === 0 && witness.length === 0) {\n    return nonWitnessUtxo ? { nonWitnessUtxo } : {};\n  }\n\n  const parsedInput = parseSignatureScript(tx.ins[vin]);\n  assert.ok(parsedInput.scriptType !== 'taprootKeyPathSpend');\n\n  function getPartialSigs(): PartialSig[] {\n    assert.ok(parsedInput.scriptType !== 'taprootKeyPathSpend');\n    return getSignaturesWithPublicKeys(tx, vin, prevOuts, parsedInput.publicKeys).flatMap((signature, i) =>\n      signature\n        ? [\n            {\n              pubkey: parsedInput.publicKeys[i],\n              signature,\n            },\n          ]\n        : []\n    );\n  }\n  // Because Zcash directly hashes the value for non-segwit transactions, we do not need to check indirectly\n  // with the previous transaction. Therefore, we can treat Zcash non-segwit transactions as Bitcoin\n  // segwit transactions\n  if (\n    parsedInput.scriptType !== 'taprootScriptPathSpend' &&\n    !hasWitnessData(parsedInput.scriptType) &&\n    !nonWitnessUtxo &&\n    getMainnet(tx.network) !== networks.zcash\n  ) {\n    throw new Error(`scriptType ${parsedInput.scriptType} requires prevTx Buffer`);\n  }\n\n  switch (parsedInput.scriptType) {\n    case 'p2shP2pk':\n      return {\n        nonWitnessUtxo,\n        partialSig: [{ pubkey: parsedInput.publicKeys[0], signature: parsedInput.signatures[0] }],\n      };\n    case 'p2sh':\n    case 'p2wsh':\n    case 'p2shP2wsh':\n      return omitUndefined({\n        nonWitnessUtxo,\n        partialSig: getPartialSigs(),\n        redeemScript: parsedInput.redeemScript,\n        witnessScript: parsedInput.witnessScript,\n      });\n    case 'taprootScriptPathSpend':\n      const leafHash = taproot.getTapleafHash(eccLib, parsedInput.controlBlock, parsedInput.pubScript);\n      return {\n        tapLeafScript: [\n          {\n            controlBlock: parsedInput.controlBlock,\n            script: parsedInput.pubScript,\n            leafVersion: parsedInput.leafVersion,\n          },\n        ],\n        tapScriptSig: getPartialSigs().map((obj) => ({ ...obj, leafHash })),\n      };\n  }\n}\n\n/**\n * Takes a partially signed transaction and removes the scripts and signatures.\n *\n * Inputs must be one of:\n *  - p2shP2pk\n *  - p2sh 2-of-3\n *  - p2shP2wsh 2-of-3\n *  - p2wsh 2-of-3\n *  - p2tr script path 2-of-2\n *\n * @param tx the partially signed transaction\n * @param prevOuts\n *\n * @return the removed scripts and signatures, ready to be added to a PSBT\n */\nexport function unsign(tx: UtxoTransaction<bigint>, prevOuts: TxOutput<bigint>[]): PsbtInputUpdate[] {\n  return tx.ins.map((input, vin) => {\n    const update = getInputUpdate(tx, vin, prevOuts);\n    input.witness = [];\n    input.script = Buffer.alloc(0);\n    return update;\n  });\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"201078831300f8ff3c549bca81050b4df2787102"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_10p4j2k9pn=function(){return actualCoverage;};}return actualCoverage;}cov_10p4j2k9pn();cov_10p4j2k9pn().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_10p4j2k9pn().s[1]++;exports.getInputUpdate=getInputUpdate;cov_10p4j2k9pn().s[2]++;exports.unsign=unsign;const assert=(cov_10p4j2k9pn().s[3]++,require("assert"));const __1=(cov_10p4j2k9pn().s[4]++,require("../.."));const parseInput_1=(cov_10p4j2k9pn().s[5]++,require("../parseInput"));const signature_1=(cov_10p4j2k9pn().s[6]++,require("../signature"));const outputScripts_1=(cov_10p4j2k9pn().s[7]++,require("../outputScripts"));function omitUndefined(v){cov_10p4j2k9pn().f[0]++;cov_10p4j2k9pn().s[8]++;return Object.fromEntries(Object.entries(v).filter(([k,v])=>{cov_10p4j2k9pn().f[1]++;cov_10p4j2k9pn().s[9]++;return v!==undefined;}));}function getInputUpdate(tx,vin,prevOuts){cov_10p4j2k9pn().f[2]++;const nonWitnessUtxo=(cov_10p4j2k9pn().s[10]++,prevOuts[vin].prevTx);const{script,witness}=(cov_10p4j2k9pn().s[11]++,tx.ins[vin]);cov_10p4j2k9pn().s[12]++;if((cov_10p4j2k9pn().b[1][0]++,script.length===0)&&(cov_10p4j2k9pn().b[1][1]++,witness.length===0)){cov_10p4j2k9pn().b[0][0]++;cov_10p4j2k9pn().s[13]++;return nonWitnessUtxo?(cov_10p4j2k9pn().b[2][0]++,{nonWitnessUtxo}):(cov_10p4j2k9pn().b[2][1]++,{});}else{cov_10p4j2k9pn().b[0][1]++;}const parsedInput=(cov_10p4j2k9pn().s[14]++,(0,parseInput_1.parseSignatureScript)(tx.ins[vin]));cov_10p4j2k9pn().s[15]++;assert.ok(parsedInput.scriptType!=='taprootKeyPathSpend');function getPartialSigs(){cov_10p4j2k9pn().f[3]++;cov_10p4j2k9pn().s[16]++;assert.ok(parsedInput.scriptType!=='taprootKeyPathSpend');cov_10p4j2k9pn().s[17]++;return(0,signature_1.getSignaturesWithPublicKeys)(tx,vin,prevOuts,parsedInput.publicKeys).flatMap((signature,i)=>{cov_10p4j2k9pn().f[4]++;cov_10p4j2k9pn().s[18]++;return signature?(cov_10p4j2k9pn().b[3][0]++,[{pubkey:parsedInput.publicKeys[i],signature}]):(cov_10p4j2k9pn().b[3][1]++,[]);});}// Because Zcash directly hashes the value for non-segwit transactions, we do not need to check indirectly
// with the previous transaction. Therefore, we can treat Zcash non-segwit transactions as Bitcoin
// segwit transactions
cov_10p4j2k9pn().s[19]++;if((cov_10p4j2k9pn().b[5][0]++,parsedInput.scriptType!=='taprootScriptPathSpend')&&(cov_10p4j2k9pn().b[5][1]++,!(0,outputScripts_1.hasWitnessData)(parsedInput.scriptType))&&(cov_10p4j2k9pn().b[5][2]++,!nonWitnessUtxo)&&(cov_10p4j2k9pn().b[5][3]++,(0,__1.getMainnet)(tx.network)!==__1.networks.zcash)){cov_10p4j2k9pn().b[4][0]++;cov_10p4j2k9pn().s[20]++;throw new Error(`scriptType ${parsedInput.scriptType} requires prevTx Buffer`);}else{cov_10p4j2k9pn().b[4][1]++;}cov_10p4j2k9pn().s[21]++;switch(parsedInput.scriptType){case'p2shP2pk':cov_10p4j2k9pn().b[6][0]++;cov_10p4j2k9pn().s[22]++;return{nonWitnessUtxo,partialSig:[{pubkey:parsedInput.publicKeys[0],signature:parsedInput.signatures[0]}]};case'p2sh':cov_10p4j2k9pn().b[6][1]++;case'p2wsh':cov_10p4j2k9pn().b[6][2]++;case'p2shP2wsh':cov_10p4j2k9pn().b[6][3]++;cov_10p4j2k9pn().s[23]++;return omitUndefined({nonWitnessUtxo,partialSig:getPartialSigs(),redeemScript:parsedInput.redeemScript,witnessScript:parsedInput.witnessScript});case'taprootScriptPathSpend':cov_10p4j2k9pn().b[6][4]++;const leafHash=(cov_10p4j2k9pn().s[24]++,__1.taproot.getTapleafHash(__1.ecc,parsedInput.controlBlock,parsedInput.pubScript));cov_10p4j2k9pn().s[25]++;return{tapLeafScript:[{controlBlock:parsedInput.controlBlock,script:parsedInput.pubScript,leafVersion:parsedInput.leafVersion}],tapScriptSig:getPartialSigs().map(obj=>{cov_10p4j2k9pn().f[5]++;cov_10p4j2k9pn().s[26]++;return{...obj,leafHash};})};}}/**
 * Takes a partially signed transaction and removes the scripts and signatures.
 *
 * Inputs must be one of:
 *  - p2shP2pk
 *  - p2sh 2-of-3
 *  - p2shP2wsh 2-of-3
 *  - p2wsh 2-of-3
 *  - p2tr script path 2-of-2
 *
 * @param tx the partially signed transaction
 * @param prevOuts
 *
 * @return the removed scripts and signatures, ready to be added to a PSBT
 */function unsign(tx,prevOuts){cov_10p4j2k9pn().f[6]++;cov_10p4j2k9pn().s[27]++;return tx.ins.map((input,vin)=>{cov_10p4j2k9pn().f[7]++;const update=(cov_10p4j2k9pn().s[28]++,getInputUpdate(tx,vin,prevOuts));cov_10p4j2k9pn().s[29]++;input.witness=[];cov_10p4j2k9pn().s[30]++;input.script=Buffer.alloc(0);cov_10p4j2k9pn().s[31]++;return update;});}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3Fyb2MvQ29kZS9oYXBpL2NoYWluZGVmdXNlci91dHhvLWxpYi9zcmMvYml0Z28vcHNidC9mcm9tSGFsZlNpZ25lZC50cyIsInNvdXJjZXMiOlsiL1VzZXJzL3Fyb2MvQ29kZS9oYXBpL2NoYWluZGVmdXNlci91dHhvLWxpYi9zcmMvYml0Z28vcHNidC9mcm9tSGFsZlNpZ25lZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQVlBLHdDQW1FQztBQWlCRCx3QkFPQztBQXZHRCxpQ0FBaUM7QUFFakMsNkJBQStFO0FBRS9FLDhDQUFxRDtBQUNyRCw0Q0FBMkQ7QUFDM0Qsb0RBQWtEO0FBRWxELFNBQVMsYUFBYSxDQUFvQyxDQUEwQjtJQUNsRixPQUFPLE1BQU0sQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxLQUFLLFNBQVMsQ0FBQyxDQUFNLENBQUM7QUFDeEYsQ0FBQztBQUVELFNBQWdCLGNBQWMsQ0FDNUIsRUFBMkIsRUFDM0IsR0FBVyxFQUNYLFFBQW9EO0lBRXBELE1BQU0sY0FBYyxHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUM7SUFDNUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3hDLElBQUksTUFBTSxDQUFDLE1BQU0sS0FBSyxDQUFDLElBQUksT0FBTyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUUsQ0FBQztRQUNoRCxPQUFPLGNBQWMsQ0FBQyxDQUFDLENBQUMsRUFBRSxjQUFjLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO0lBQ2xELENBQUM7SUFFRCxNQUFNLFdBQVcsR0FBRyxJQUFBLGlDQUFvQixFQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFD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QUFNLENBQUM7SUFDaEIsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgYXNzZXJ0IGZyb20gJ2Fzc2VydCc7XG5pbXBvcnQgeyBQc2J0SW5wdXRVcGRhdGUsIFBhcnRpYWxTaWcgfSBmcm9tICdiaXAxNzQvc3JjL2xpYi9pbnRlcmZhY2VzJztcbmltcG9ydCB7IGVjYyBhcyBlY2NMaWIsIFR4T3V0cHV0LCB0YXByb290LCBnZXRNYWlubmV0LCBuZXR3b3JrcyB9IGZyb20gJy4uLy4uJztcbmltcG9ydCB7IFV0eG9UcmFuc2FjdGlvbiB9IGZyb20gJy4uL1V0eG9UcmFuc2FjdGlvbic7XG5pbXBvcnQgeyBwYXJzZVNpZ25hdHVyZVNjcmlwdCB9IGZyb20gJy4uL3BhcnNlSW5wdXQnO1xuaW1wb3J0IHsgZ2V0U2lnbmF0dXJlc1dpdGhQdWJsaWNLZXlzIH0gZnJvbSAnLi4vc2lnbmF0dXJlJztcbmltcG9ydCB7IGhhc1dpdG5lc3NEYXRhIH0gZnJvbSAnLi4vb3V0cHV0U2NyaXB0cyc7XG5cbmZ1bmN0aW9uIG9taXRVbmRlZmluZWQ8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIHVua25vd24+Pih2OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik6IFQge1xuICByZXR1cm4gT2JqZWN0LmZyb21FbnRyaWVzKE9iamVjdC5lbnRyaWVzKHYpLmZpbHRlcigoW2ssIHZdKSA9PiB2ICE9PSB1bmRlZmluZWQpKSBhcyBUO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0SW5wdXRVcGRhdGUoXG4gIHR4OiBVdHhvVHJhbnNhY3Rpb248YmlnaW50PixcbiAgdmluOiBudW1iZXIsXG4gIHByZXZPdXRzOiAoVHhPdXRwdXQ8YmlnaW50PiAmIHsgcHJldlR4PzogQnVmZmVyIH0pW11cbik6IFBzYnRJbnB1dFVwZGF0ZSB7XG4gIGNvbnN0IG5vbldpdG5lc3NVdHhvID0gcHJldk91dHNbdmluXS5wcmV2VHg7XG4gIGNvbnN0IHsgc2NyaXB0LCB3aXRuZXNzIH0gPSB0eC5pbnNbdmluXTtcbiAgaWYgKHNjcmlwdC5sZW5ndGggPT09IDAgJiYgd2l0bmVzcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gbm9uV2l0bmVzc1V0eG8gPyB7IG5vbldpdG5lc3NVdHhvIH0gOiB7fTtcbiAgfVxuXG4gIGNvbnN0IHBhcnNlZElucHV0ID0gcGFyc2VTaWduYXR1cmVTY3JpcHQodHguaW5zW3Zpbl0pO1xuICBhc3NlcnQub2socGFyc2VkSW5wdXQuc2NyaXB0VHlwZSAhPT0gJ3RhcHJvb3RLZXlQYXRoU3BlbmQnKTtcblxuICBmdW5jdGlvbiBnZXRQYXJ0aWFsU2lncygpOiBQYXJ0aWFsU2lnW10ge1xuICAgIGFzc2VydC5vayhwYXJzZWRJbnB1dC5zY3JpcHRUeXBlICE9PSAndGFwcm9vdEtleVBhdGhTcGVuZCcpO1xuICAgIHJldHVybiBnZXRTaWduYXR1cmVzV2l0aFB1YmxpY0tleXModHgsIHZpbiwgcHJldk91dHMsIHBhcnNlZElucHV0LnB1YmxpY0tleXMpLmZsYXRNYXAoKHNpZ25hdHVyZSwgaSkgPT5cbiAgICAgIHNpZ25hdHVyZVxuICAgICAgICA/IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcHVia2V5OiBwYXJzZWRJbnB1dC5wdWJsaWNLZXlzW2ldLFxuICAgICAgICAgICAgICBzaWduYXR1cmUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIF1cbiAgICAgICAgOiBbXVxuICAgICk7XG4gIH1cbiAgLy8gQmVjYXVzZSBaY2FzaCBkaXJlY3RseSBoYXNoZXMgdGhlIHZhbHVlIGZvciBub24tc2Vnd2l0IHRyYW5zYWN0aW9ucywgd2UgZG8gbm90IG5lZWQgdG8gY2hlY2sgaW5kaXJlY3RseVxuICAvLyB3aXRoIHRoZSBwcmV2aW91cyB0cmFuc2FjdGlvbi4gVGhlcmVmb3JlLCB3ZSBjYW4gdHJlYXQgWmNhc2ggbm9uLXNlZ3dpdCB0cmFuc2FjdGlvbnMgYXMgQml0Y29pblxuICAvLyBzZWd3aXQgdHJhbnNhY3Rpb25zXG4gIGlmIChcbiAgICBwYXJzZWRJbnB1dC5zY3JpcHRUeXBlICE9PSAndGFwcm9vdFNjcmlwdFBhdGhTcGVuZCcgJiZcbiAgICAhaGFzV2l0bmVzc0RhdGEocGFyc2VkSW5wdXQuc2NyaXB0VHlwZSkgJiZcbiAgICAhbm9uV2l0bmVzc1V0eG8gJiZcbiAgICBnZXRNYWlubmV0KHR4Lm5ldHdvcmspICE9PSBuZXR3b3Jrcy56Y2FzaFxuICApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYHNjcmlwdFR5cGUgJHtwYXJzZWRJbnB1dC5zY3JpcHRUeXBlfSByZXF1aXJlcyBwcmV2VHggQnVmZmVyYCk7XG4gIH1cblxuICBzd2l0Y2ggKHBhcnNlZElucHV0LnNjcmlwdFR5cGUpIHtcbiAgICBjYXNlICdwMnNoUDJwayc6XG4gICAgICByZXR1cm4ge1xuICAgICAgICBub25XaXRuZXNzVXR4byxcbiAgICAgICAgcGFydGlhbFNpZzogW3sgcHVia2V5OiBwYXJzZWRJbnB1dC5wdWJsaWNLZXlzWzBdLCBzaWduYXR1cmU6IHBhcnNlZElucHV0LnNpZ25hdHVyZXNbMF0gfV0sXG4gICAgICB9O1xuICAgIGNhc2UgJ3Ayc2gnOlxuICAgIGNhc2UgJ3Ayd3NoJzpcbiAgICBjYXNlICdwMnNoUDJ3c2gnOlxuICAgICAgcmV0dXJuIG9taXRVbmRlZmluZWQoe1xuICAgICAgICBub25XaXRuZXNzVXR4byxcbiAgICAgICAgcGFydGlhbFNpZzogZ2V0UGFydGlhbFNpZ3MoKSxcbiAgICAgICAgcmVkZWVtU2NyaXB0OiBwYXJzZWRJbnB1dC5yZWRlZW1TY3JpcHQsXG4gICAgICAgIHdpdG5lc3NTY3JpcHQ6IHBhcnNlZElucHV0LndpdG5lc3NTY3JpcHQsXG4gICAgICB9KTtcbiAgICBjYXNlICd0YXByb290U2NyaXB0UGF0aFNwZW5kJzpcbiAgICAgIGNvbnN0IGxlYWZIYXNoID0gdGFwcm9vdC5nZXRUYXBsZWFmSGFzaChlY2NMaWIsIHBhcnNlZElucHV0LmNvbnRyb2xCbG9jaywgcGFyc2VkSW5wdXQucHViU2NyaXB0KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRhcExlYWZTY3JpcHQ6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBjb250cm9sQmxvY2s6IHBhcnNlZElucHV0LmNvbnRyb2xCbG9jayxcbiAgICAgICAgICAgIHNjcmlwdDogcGFyc2VkSW5wdXQucHViU2NyaXB0LFxuICAgICAgICAgICAgbGVhZlZlcnNpb246IHBhcnNlZElucHV0LmxlYWZWZXJzaW9uLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICAgIHRhcFNjcmlwdFNpZzogZ2V0UGFydGlhbFNpZ3MoKS5tYXAoKG9iaikgPT4gKHsgLi4ub2JqLCBsZWFmSGFzaCB9KSksXG4gICAgICB9O1xuICB9XG59XG5cbi8qKlxuICogVGFrZXMgYSBwYXJ0aWFsbHkgc2lnbmVkIHRyYW5zYWN0aW9uIGFuZCByZW1vdmVzIHRoZSBzY3JpcHRzIGFuZCBzaWduYXR1cmVzLlxuICpcbiAqIElucHV0cyBtdXN0IGJlIG9uZSBvZjpcbiAqICAtIHAyc2hQMnBrXG4gKiAgLSBwMnNoIDItb2YtM1xuICogIC0gcDJzaFAyd3NoIDItb2YtM1xuICogIC0gcDJ3c2ggMi1vZi0zXG4gKiAgLSBwMnRyIHNjcmlwdCBwYXRoIDItb2YtMlxuICpcbiAqIEBwYXJhbSB0eCB0aGUgcGFydGlhbGx5IHNpZ25lZCB0cmFuc2FjdGlvblxuICogQHBhcmFtIHByZXZPdXRzXG4gKlxuICogQHJldHVybiB0aGUgcmVtb3ZlZCBzY3JpcHRzIGFuZCBzaWduYXR1cmVzLCByZWFkeSB0byBiZSBhZGRlZCB0byBhIFBTQlRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVuc2lnbih0eDogVXR4b1RyYW5zYWN0aW9uPGJpZ2ludD4sIHByZXZPdXRzOiBUeE91dHB1dDxiaWdpbnQ+W10pOiBQc2J0SW5wdXRVcGRhdGVbXSB7XG4gIHJldHVybiB0eC5pbnMubWFwKChpbnB1dCwgdmluKSA9PiB7XG4gICAgY29uc3QgdXBkYXRlID0gZ2V0SW5wdXRVcGRhdGUodHgsIHZpbiwgcHJldk91dHMpO1xuICAgIGlucHV0LndpdG5lc3MgPSBbXTtcbiAgICBpbnB1dC5zY3JpcHQgPSBCdWZmZXIuYWxsb2MoMCk7XG4gICAgcmV0dXJuIHVwZGF0ZTtcbiAgfSk7XG59XG4iXX0=
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMTBwNGoyazlwbiIsImFjdHVhbENvdmVyYWdlIiwicyIsImV4cG9ydHMiLCJnZXRJbnB1dFVwZGF0ZSIsInVuc2lnbiIsImFzc2VydCIsInJlcXVpcmUiLCJfXzEiLCJwYXJzZUlucHV0XzEiLCJzaWduYXR1cmVfMSIsIm91dHB1dFNjcmlwdHNfMSIsIm9taXRVbmRlZmluZWQiLCJ2IiwiZiIsIk9iamVjdCIsImZyb21FbnRyaWVzIiwiZW50cmllcyIsImZpbHRlciIsImsiLCJ1bmRlZmluZWQiLCJ0eCIsInZpbiIsInByZXZPdXRzIiwibm9uV2l0bmVzc1V0eG8iLCJwcmV2VHgiLCJzY3JpcHQiLCJ3aXRuZXNzIiwiaW5zIiwiYiIsImxlbmd0aCIsInBhcnNlZElucHV0IiwicGFyc2VTaWduYXR1cmVTY3JpcHQiLCJvayIsInNjcmlwdFR5cGUiLCJnZXRQYXJ0aWFsU2lncyIsImdldFNpZ25hdHVyZXNXaXRoUHVibGljS2V5cyIsInB1YmxpY0tleXMiLCJmbGF0TWFwIiwic2lnbmF0dXJlIiwiaSIsInB1YmtleSIsImhhc1dpdG5lc3NEYXRhIiwiZ2V0TWFpbm5ldCIsIm5ldHdvcmsiLCJuZXR3b3JrcyIsInpjYXNoIiwiRXJyb3IiLCJwYXJ0aWFsU2lnIiwic2lnbmF0dXJlcyIsInJlZGVlbVNjcmlwdCIsIndpdG5lc3NTY3JpcHQiLCJsZWFmSGFzaCIsInRhcHJvb3QiLCJnZXRUYXBsZWFmSGFzaCIsImVjYyIsImNvbnRyb2xCbG9jayIsInB1YlNjcmlwdCIsInRhcExlYWZTY3JpcHQiLCJsZWFmVmVyc2lvbiIsInRhcFNjcmlwdFNpZyIsIm1hcCIsIm9iaiIsImlucHV0IiwidXBkYXRlIiwiQnVmZmVyIiwiYWxsb2MiXSwic291cmNlcyI6WyIvVXNlcnMvcXJvYy9Db2RlL2hhcGkvY2hhaW5kZWZ1c2VyL3V0eG8tbGliL3NyYy9iaXRnby9wc2J0L2Zyb21IYWxmU2lnbmVkLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGFzc2VydCBmcm9tICdhc3NlcnQnO1xuaW1wb3J0IHsgUHNidElucHV0VXBkYXRlLCBQYXJ0aWFsU2lnIH0gZnJvbSAnYmlwMTc0L3NyYy9saWIvaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBlY2MgYXMgZWNjTGliLCBUeE91dHB1dCwgdGFwcm9vdCwgZ2V0TWFpbm5ldCwgbmV0d29ya3MgfSBmcm9tICcuLi8uLic7XG5pbXBvcnQgeyBVdHhvVHJhbnNhY3Rpb24gfSBmcm9tICcuLi9VdHhvVHJhbnNhY3Rpb24nO1xuaW1wb3J0IHsgcGFyc2VTaWduYXR1cmVTY3JpcHQgfSBmcm9tICcuLi9wYXJzZUlucHV0JztcbmltcG9ydCB7IGdldFNpZ25hdHVyZXNXaXRoUHVibGljS2V5cyB9IGZyb20gJy4uL3NpZ25hdHVyZSc7XG5pbXBvcnQgeyBoYXNXaXRuZXNzRGF0YSB9IGZyb20gJy4uL291dHB1dFNjcmlwdHMnO1xuXG5mdW5jdGlvbiBvbWl0VW5kZWZpbmVkPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPj4odjogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pOiBUIHtcbiAgcmV0dXJuIE9iamVjdC5mcm9tRW50cmllcyhPYmplY3QuZW50cmllcyh2KS5maWx0ZXIoKFtrLCB2XSkgPT4gdiAhPT0gdW5kZWZpbmVkKSkgYXMgVDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldElucHV0VXBkYXRlKFxuICB0eDogVXR4b1RyYW5zYWN0aW9uPGJpZ2ludD4sXG4gIHZpbjogbnVtYmVyLFxuICBwcmV2T3V0czogKFR4T3V0cHV0PGJpZ2ludD4gJiB7IHByZXZUeD86IEJ1ZmZlciB9KVtdXG4pOiBQc2J0SW5wdXRVcGRhdGUge1xuICBjb25zdCBub25XaXRuZXNzVXR4byA9IHByZXZPdXRzW3Zpbl0ucHJldlR4O1xuICBjb25zdCB7IHNjcmlwdCwgd2l0bmVzcyB9ID0gdHguaW5zW3Zpbl07XG4gIGlmIChzY3JpcHQubGVuZ3RoID09PSAwICYmIHdpdG5lc3MubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIG5vbldpdG5lc3NVdHhvID8geyBub25XaXRuZXNzVXR4byB9IDoge307XG4gIH1cblxuICBjb25zdCBwYXJzZWRJbnB1dCA9IHBhcnNlU2lnbmF0dXJlU2NyaXB0KHR4Lmluc1t2aW5dKTtcbiAgYXNzZXJ0Lm9rKHBhcnNlZElucHV0LnNjcmlwdFR5cGUgIT09ICd0YXByb290S2V5UGF0aFNwZW5kJyk7XG5cbiAgZnVuY3Rpb24gZ2V0UGFydGlhbFNpZ3MoKTogUGFydGlhbFNpZ1tdIHtcbiAgICBhc3NlcnQub2socGFyc2VkSW5wdXQuc2NyaXB0VHlwZSAhPT0gJ3RhcHJvb3RLZXlQYXRoU3BlbmQnKTtcbiAgICByZXR1cm4gZ2V0U2lnbmF0dXJlc1dpdGhQdWJsaWNLZXlzKHR4LCB2aW4sIHByZXZPdXRzLCBwYXJzZWRJbnB1dC5wdWJsaWNLZXlzKS5mbGF0TWFwKChzaWduYXR1cmUsIGkpID0+XG4gICAgICBzaWduYXR1cmVcbiAgICAgICAgPyBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHB1YmtleTogcGFyc2VkSW5wdXQucHVibGljS2V5c1tpXSxcbiAgICAgICAgICAgICAgc2lnbmF0dXJlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdXG4gICAgICAgIDogW11cbiAgICApO1xuICB9XG4gIC8vIEJlY2F1c2UgWmNhc2ggZGlyZWN0bHkgaGFzaGVzIHRoZSB2YWx1ZSBmb3Igbm9uLXNlZ3dpdCB0cmFuc2FjdGlvbnMsIHdlIGRvIG5vdCBuZWVkIHRvIGNoZWNrIGluZGlyZWN0bHlcbiAgLy8gd2l0aCB0aGUgcHJldmlvdXMgdHJhbnNhY3Rpb24uIFRoZXJlZm9yZSwgd2UgY2FuIHRyZWF0IFpjYXNoIG5vbi1zZWd3aXQgdHJhbnNhY3Rpb25zIGFzIEJpdGNvaW5cbiAgLy8gc2Vnd2l0IHRyYW5zYWN0aW9uc1xuICBpZiAoXG4gICAgcGFyc2VkSW5wdXQuc2NyaXB0VHlwZSAhPT0gJ3RhcHJvb3RTY3JpcHRQYXRoU3BlbmQnICYmXG4gICAgIWhhc1dpdG5lc3NEYXRhKHBhcnNlZElucHV0LnNjcmlwdFR5cGUpICYmXG4gICAgIW5vbldpdG5lc3NVdHhvICYmXG4gICAgZ2V0TWFpbm5ldCh0eC5uZXR3b3JrKSAhPT0gbmV0d29ya3MuemNhc2hcbiAgKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBzY3JpcHRUeXBlICR7cGFyc2VkSW5wdXQuc2NyaXB0VHlwZX0gcmVxdWlyZXMgcHJldlR4IEJ1ZmZlcmApO1xuICB9XG5cbiAgc3dpdGNoIChwYXJzZWRJbnB1dC5zY3JpcHRUeXBlKSB7XG4gICAgY2FzZSAncDJzaFAycGsnOlxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbm9uV2l0bmVzc1V0eG8sXG4gICAgICAgIHBhcnRpYWxTaWc6IFt7IHB1YmtleTogcGFyc2VkSW5wdXQucHVibGljS2V5c1swXSwgc2lnbmF0dXJlOiBwYXJzZWRJbnB1dC5zaWduYXR1cmVzWzBdIH1dLFxuICAgICAgfTtcbiAgICBjYXNlICdwMnNoJzpcbiAgICBjYXNlICdwMndzaCc6XG4gICAgY2FzZSAncDJzaFAyd3NoJzpcbiAgICAgIHJldHVybiBvbWl0VW5kZWZpbmVkKHtcbiAgICAgICAgbm9uV2l0bmVzc1V0eG8sXG4gICAgICAgIHBhcnRpYWxTaWc6IGdldFBhcnRpYWxTaWdzKCksXG4gICAgICAgIHJlZGVlbVNjcmlwdDogcGFyc2VkSW5wdXQucmVkZWVtU2NyaXB0LFxuICAgICAgICB3aXRuZXNzU2NyaXB0OiBwYXJzZWRJbnB1dC53aXRuZXNzU2NyaXB0LFxuICAgICAgfSk7XG4gICAgY2FzZSAndGFwcm9vdFNjcmlwdFBhdGhTcGVuZCc6XG4gICAgICBjb25zdCBsZWFmSGFzaCA9IHRhcHJvb3QuZ2V0VGFwbGVhZkhhc2goZWNjTGliLCBwYXJzZWRJbnB1dC5jb250cm9sQmxvY2ssIHBhcnNlZElucHV0LnB1YlNjcmlwdCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0YXBMZWFmU2NyaXB0OiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgY29udHJvbEJsb2NrOiBwYXJzZWRJbnB1dC5jb250cm9sQmxvY2ssXG4gICAgICAgICAgICBzY3JpcHQ6IHBhcnNlZElucHV0LnB1YlNjcmlwdCxcbiAgICAgICAgICAgIGxlYWZWZXJzaW9uOiBwYXJzZWRJbnB1dC5sZWFmVmVyc2lvbixcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICB0YXBTY3JpcHRTaWc6IGdldFBhcnRpYWxTaWdzKCkubWFwKChvYmopID0+ICh7IC4uLm9iaiwgbGVhZkhhc2ggfSkpLFxuICAgICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIFRha2VzIGEgcGFydGlhbGx5IHNpZ25lZCB0cmFuc2FjdGlvbiBhbmQgcmVtb3ZlcyB0aGUgc2NyaXB0cyBhbmQgc2lnbmF0dXJlcy5cbiAqXG4gKiBJbnB1dHMgbXVzdCBiZSBvbmUgb2Y6XG4gKiAgLSBwMnNoUDJwa1xuICogIC0gcDJzaCAyLW9mLTNcbiAqICAtIHAyc2hQMndzaCAyLW9mLTNcbiAqICAtIHAyd3NoIDItb2YtM1xuICogIC0gcDJ0ciBzY3JpcHQgcGF0aCAyLW9mLTJcbiAqXG4gKiBAcGFyYW0gdHggdGhlIHBhcnRpYWxseSBzaWduZWQgdHJhbnNhY3Rpb25cbiAqIEBwYXJhbSBwcmV2T3V0c1xuICpcbiAqIEByZXR1cm4gdGhlIHJlbW92ZWQgc2NyaXB0cyBhbmQgc2lnbmF0dXJlcywgcmVhZHkgdG8gYmUgYWRkZWQgdG8gYSBQU0JUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1bnNpZ24odHg6IFV0eG9UcmFuc2FjdGlvbjxiaWdpbnQ+LCBwcmV2T3V0czogVHhPdXRwdXQ8YmlnaW50PltdKTogUHNidElucHV0VXBkYXRlW10ge1xuICByZXR1cm4gdHguaW5zLm1hcCgoaW5wdXQsIHZpbikgPT4ge1xuICAgIGNvbnN0IHVwZGF0ZSA9IGdldElucHV0VXBkYXRlKHR4LCB2aW4sIHByZXZPdXRzKTtcbiAgICBpbnB1dC53aXRuZXNzID0gW107XG4gICAgaW5wdXQuc2NyaXB0ID0gQnVmZmVyLmFsbG9jKDApO1xuICAgIHJldHVybiB1cGRhdGU7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