{"version":3,"file":"/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/templates/multisig/output.ts","sources":["/Users/qroc/Code/hapi/chaindefuser/utxo-lib/src/templates/multisig/output.ts"],"names":[],"mappings":";AAAA,qCAAqC;;AAQrC,sBAkBC;AAvBD,8BAA2C;AAC3C,8BAAiC;AACjC,iDAAiD;AACjD,MAAM,WAAW,GAAG,WAAO,CAAC,WAAW,CAAC,CAAC,WAAW;AAEpD,SAAgB,KAAK,CAAC,MAAsB,EAAE,eAAyB;IACrE,MAAM,MAAM,GAAG,UAAO,CAAC,SAAS,CAAC,MAAM,CAAU,CAAC;IAElD,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC;QAAE,OAAO,KAAK,CAAC;IACpC,IAAI,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,KAAK,WAAO,CAAC,gBAAgB;QAAE,OAAO,KAAK,CAAC;IACzE,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QAAE,OAAO,KAAK,CAAC;IAC3C,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAAE,OAAO,KAAK,CAAC;IAC3D,MAAM,CAAC,GAAI,MAAM,CAAC,CAAC,CAAY,GAAG,WAAW,CAAC;IAC9C,MAAM,CAAC,GAAI,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAY,GAAG,WAAW,CAAC;IAE9D,IAAI,CAAC,IAAI,CAAC;QAAE,OAAO,KAAK,CAAC;IACzB,IAAI,CAAC,GAAG,EAAE;QAAE,OAAO,KAAK,CAAC;IACzB,IAAI,CAAC,GAAG,CAAC;QAAE,OAAO,KAAK,CAAC;IACxB,IAAI,CAAC,KAAK,MAAM,CAAC,MAAM,GAAG,CAAC;QAAE,OAAO,KAAK,CAAC;IAC1C,IAAI,eAAe;QAAE,OAAO,IAAI,CAAC;IAEjC,MAAM,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAa,CAAC;IAC7C,OAAO,IAAI,CAAC,KAAK,CAAC,UAAO,CAAC,iBAAiB,CAAC,CAAC;AAC/C,CAAC;AACD,KAAK,CAAC,MAAM,GAAG,GAAW,EAAE;IAC1B,OAAO,kBAAkB,CAAC;AAC5B,CAAC,CAAC","sourcesContent":["// m [pubKeys ...] n OP_CHECKMULTISIG\n\nimport { Stack } from '../../';\nimport { script as bscript } from '../../';\nimport { opcodes } from '../../';\nimport * as types from 'bitcoinjs-lib/src/types';\nconst OP_INT_BASE = opcodes.OP_RESERVED; // OP_1 - 1\n\nexport function check(script: Buffer | Stack, allowIncomplete?: boolean): boolean {\n  const chunks = bscript.decompile(script) as Stack;\n\n  if (chunks.length < 4) return false;\n  if (chunks[chunks.length - 1] !== opcodes.OP_CHECKMULTISIG) return false;\n  if (!types.Number(chunks[0])) return false;\n  if (!types.Number(chunks[chunks.length - 2])) return false;\n  const m = (chunks[0] as number) - OP_INT_BASE;\n  const n = (chunks[chunks.length - 2] as number) - OP_INT_BASE;\n\n  if (m <= 0) return false;\n  if (n > 16) return false;\n  if (m > n) return false;\n  if (n !== chunks.length - 3) return false;\n  if (allowIncomplete) return true;\n\n  const keys = chunks.slice(1, -2) as Buffer[];\n  return keys.every(bscript.isCanonicalPubKey);\n}\ncheck.toJSON = (): string => {\n  return 'multi-sig output';\n};\n"]}